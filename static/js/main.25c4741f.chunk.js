(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){"use strict";n.r(t);var r=n(143),a=n(0),i=n.n(a),o=n(17),c=n(2),s=n(3),u=n(5),l=n(4),m=n(6),p=n(10),d=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={crashMsg:void 0},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(e,t){this.crash(["Component Stack:",t.componentStack,"",e&&e.stack].join("\n")),p.b(function(n){Object.keys(t).forEach(function(e){n.setExtra(e,t[e])}),p.a(e)})}},{key:"crash",value:function(e){this.setState({crashMsg:e})}},{key:"render",value:function(){return"undefined"!==typeof this.state.crashMsg?a.createElement("div",{className:"crashed"},a.createElement("h1",null,"Crashed!"),a.createElement("pre",null,this.state.crashMsg)):this.props.children}}]),t}(a.Component),h=n(11),f=n(39),v=n.n(f),b=n(66),y=n(74);function g(e,t){if(!e)throw new Error(t||"Assertion failed")}function O(e,t){var n={};for(var r in e)n[r]=t(e[r]);return n}function w(e){var t=[];for(var n in e)t.push(e[n]);return t}function E(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}function j(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function k(e,t){return g(Number.isSafeInteger(e)),g(Number.isSafeInteger(t)),{quotient:Math.floor(e/t),remainder:e%t}}var N=function(){function e(t,n){Object(c.a)(this,e),this.p=void 0,this.q=void 0,this.toString=void 0,g(Number.isSafeInteger(t),"Numerator must be an integer"),g(Number.isSafeInteger(n),"Denominator must be an integer"),g(0!==n,"Denominator must not be zero"),n<0&&(t=-t,n=-n),0===t&&(n=1);var r=function e(t,n){return n?e(n,t%n):t}(t,n);r>1&&(t/=r,n/=r),this.p=t,this.q=n}return Object(s.a)(e,[{key:"floor",value:function(){var t=k(this.p,this.q),n=new e(t.quotient,1);return n.less(e.zero)&&0!==t.remainder&&(n=n.sub(e.one)),n}},{key:"negate",value:function(){return new e(-this.p,this.q)}},{key:"invert",value:function(){return new e(this.q,this.p)}},{key:"add",value:function(t){return new e(this.p*t.q+this.q*t.p,this.q*t.q)}},{key:"sub",value:function(t){return new e(this.p*t.q-this.q*t.p,this.q*t.q)}},{key:"mul",value:function(t){return"number"==typeof t&&(t=e.fromFloat(t)),new e(this.p*t.p,this.q*t.q)}},{key:"div",value:function(t){return new e(this.p*t.q,this.q*t.p)}},{key:"clamp",value:function(t,n){return"number"==typeof t&&(t=e.fromFloat(t)),"number"==typeof n&&(n=e.fromFloat(n)),this.less(t)?t:n.less(this)?n:this}},{key:"divmod",value:function(e){var t=this.div(e).floor();return{quotient:t,remainder:this.sub(e.mul(t))}}},{key:"equal",value:function(e){return this.p===e.p&&this.q===e.q}},{key:"isNegative",value:function(){return this.p<0}},{key:"isPositive",value:function(){return this.p>0}},{key:"isOne",value:function(){return 1===this.p}},{key:"isZero",value:function(){return 0===this.p}},{key:"less",value:function(e){return this.p*e.q<this.q*e.p}},{key:"toFloat",value:function(){return this.p/this.q}},{key:"toFraction",value:function(){return 1===this.q?this.p.toString():this.p.toString()+"/"+this.q.toString()}},{key:"toDecimal",value:function(t,n){null==t&&(t=3),null==n&&(n=new e(5,Math.pow(10,t+1)));var r="",a=this;a.isNegative()&&(r="-",a=a.negate());for(var i=k((a=a.add(n)).p,a.q),o=i.quotient.toString(),c="",s=new e(i.remainder,a.q),u=new e(10,1);t>0&&!s.equal(n);){s=s.mul(u),n=n.mul(u);var l=k(s.p,s.q);c+=l.quotient.toString(),s=new e(l.remainder,s.q),t--}if(s.equal(n))for(;"0"===c[c.length-1];)c=c.slice(0,c.length-1);return""!==c?r+o+"."+c:r+o}}],[{key:"fromFloat",value:function(t){if(Number.isInteger(t))return new this(t,1);var n=new e(Math.round(1e4*t),1e4),r=n.divmod(e.one),a=!0,i=!1,o=void 0;try{for(var c,s=C[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var u=c.value,l=Object(h.a)(u,2),m=l[0],p=l[1];if(r.remainder.equal(m))return r.quotient.add(p)}}catch(d){i=!0,o=d}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"fromInts",value:function(e,t){return new this(e,t)}},{key:"fromString",value:function(t){var n=t.indexOf("/");if(-1===n)return e.fromFloat(Number(t));var r=Number(t.slice(0,n)),a=Number(t.slice(n+1));return e.fromInts(r,a)}}]),e}();N.zero=new N(0,1),N.one=new N(1,1),N.oneThird=new N(1,3),N.twoThirds=new N(2,3);for(var C=[],S=2;S<100;S++)for(var M=1;M<S;M++){var x=M/S;if(!(x.toString().length<10)){var I=new N(Math.round(1e4*x),1e4);C.push([I,N.fromInts(M,S)]);var _=new N(Math.floor(1e4*x),1e4);C.push([_,N.fromInts(M,S)])}}var R=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.localised_name=void 0,this.icon_col=void 0,this.icon_row=void 0,this.name=t.name,this.localised_name=t.localised_name,this.icon_col=t.icon_col,this.icon_row=t.icon_row}return Object(s.a)(e,[{key:"niceName",value:function(){return this.localised_name.en}}]),e}(),D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).raw=void 0,n.usedBy=[],n.madeBy=[],n.raw=e,n.name=e.name,n.localised_name=e.localised_name,n.icon_col=e.icon_col,n.icon_row=e.icon_row,n}return Object(m.a)(t,e),t}(R),P=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).type=void 0,n.limitedTo=void 0,n.effects=void 0,n.type=e.type,n.limitedTo=new Set(e.limitation),n.effects={speed:N.fromFloat((e.effect.speed||{bonus:0}).bonus),productivity:N.fromFloat((e.effect.productivity||{bonus:0}).bonus),consumption:N.fromFloat((e.effect.consumption||{bonus:0}).bonus),pollution:N.fromFloat((e.effect.pollution||{bonus:0}).bonus)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canUseWith",value:function(e){return 0===this.limitedTo.size||this.limitedTo.has(e.name)}}]),t}(D),q=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).type="generic",n}return Object(m.a)(t,e),t}(D),B=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).default_temperature=void 0,n.type="fluid",n.default_temperature=e.default_temperature,n}return Object(m.a)(t,e),t}(D),F=function e(t){Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,this.amount=N.fromFloat(t.amount)},T=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",r.item=void 0,r.item=n.itemMap[e.name],r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}}]),t}(F),G=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",r.item=void 0,r.minimum_temperature=void 0,r.maximum_temperature=void 0,r.item=n.fluidMap[e.name],r.minimum_temperature=e.minimum_temperature||-1/0,r.maximum_temperature=e.maximum_temperature||1/0,r.maximum_temperature>=1.797e308&&(r.maximum_temperature=1/0),r.minimum_temperature<=-1.797e308&&(r.minimum_temperature=-1/0),r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e=this.minimum_temperature,t=this.maximum_temperature,n="";return e!==-1/0&&t!==1/0?n=" (".concat(e,"\xb0 \u2013 ").concat(t,"\xb0)"):t!==1/0?n=" (\u2264 ".concat(t,"\xb0)"):e!==-1/0&&(n=" (\u2265 ".concat(t,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(n)}}]),t}(F),A=function e(t){var n;Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,n="amount"in t?N.fromFloat(t.amount):N.fromInts(t.amount_min+t.amount_max,2),"number"==typeof t.probability&&(0===t.probability?n=N.zero:1!==t.probability&&(g(t.probability>0),g(t.probability<1),n=n.mul(N.fromFloat(t.probability)))),this.amount=n},L=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",r.item=void 0,r.item=n.itemMap[e.name],r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}},{key:"satisfies",value:function(e){return"item"===e.type&&e.item===this.item}}]),t}(A),W=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",r.item=void 0,r.temperature=void 0,r.item=n.fluidMap[e.name],r.item||console.error("could not find item",e),r.temperature=e.temperature||r.item.default_temperature,r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e="";return this.temperature!==this.item.default_temperature&&(e=" (".concat(this.temperature,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(e)}},{key:"satisfies",value:function(e){return"fluid"===e.type&&e.item===this.item&&e.maximum_temperature>=this.temperature&&e.minimum_temperature<=this.temperature}}]),t}(A),U=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).category=void 0,r.ingredients=void 0,r.products=void 0,r.crafting_time=void 0,r.madeIn=[],r.name=e.name,r.category=e.category,r.crafting_time=N.fromFloat(e.energy_required),r.ingredients=e.ingredients.map(function(e){return"fluid"===e.type?new G(e,n):new T(e,n)}),r.products=e.results.map(function(e){return"fluid"===e.type?new W(e,n):new L(e,n)}),r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return this.products.length>1?Object(y.a)(Object(l.a)(t.prototype),"niceName",this).call(this):this.products[0].amount.equal(N.one)?this.products[0].item.niceName():this.products[0].niceName()}}]),t}(R),H=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canBuildRecipe",value:function(e){return-1!==this.data.crafting_categories.indexOf(e.category)}}]),t}(function(){function e(t){Object(c.a)(this,e),this.data=void 0,this.data=t}return Object(s.a)(e,[{key:"niceName",value:function(){return this.data.localised_name.en}}]),e}()),K=function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=c.data.crafting_categories[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;t.hasOwnProperty(d)||(t[d]=[]),t[d].push(c)}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){r=!0,a=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t},z=function(){function e(t){var n=this;Object(c.a)(this,e),this.raw=void 0,this.items=[],this.itemMap={},this.fluids=[],this.fluidMap={},this.modules=[],this.moduleMap={},this.recipes=[],this.recipeMap={},this.entities=[],this.entityMap={},this.categoryMap=void 0,console.groupCollapsed("Game data processing"),this.raw=t;var r=function(e,t){var r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value,u=new t(s);n.entityMap[s.name]=u,n.entities.push(u)}}catch(l){a=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}};for(var a in r(w(t["assembling-machine"]),H),r(w(t.furnace),H),r(w(t["rocket-silo"]),H),t.items){var i=t.items[a];if("type"in i&&"fluid"===i.type){var o=new B(i);this.fluids.push(o),this.fluidMap[o.name]=o}else if("type"in i&&"module"===i.type){var s=new P(i);this.items.push(s),this.itemMap[s.name]=s,this.modules.push(s),this.moduleMap[s.name]=s}else{var u=new q(i);this.items.push(u),this.itemMap[u.name]=u}}for(var l in t.recipes){var m=new U(t.recipes[l],this);for(var p in this.entityMap){var d=this.entityMap[p];"canBuildRecipe"in d&&d.canBuildRecipe(m)&&m.madeIn.push(d)}if(m.madeIn.length)if(m.products.some(function(e){return e.amount.isPositive()})){this.recipeMap[m.name]=m,this.recipes.push(m);var h=!0,f=!1,v=void 0;try{for(var b,y=m.ingredients[Symbol.iterator]();!(h=(b=y.next()).done);h=!0){b.value.item.usedBy.push(m)}}catch(N){f=!0,v=N}finally{try{h||null==y.return||y.return()}finally{if(f)throw v}}var g=!0,O=!1,E=void 0;try{for(var j,k=m.products[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){j.value.item.madeBy.push(m)}}catch(N){O=!0,E=N}finally{try{g||null==k.return||k.return()}finally{if(O)throw E}}}else console.debug("Ignoring void recipe",m.name,m);else console.warn("Ignoring uncraftable recipe",m.name,m)}this.categoryMap=K(this.entities),console.log("Processed ".concat(this.items.length," items")),console.log("Processed ".concat(this.fluids.length," fluids")),console.log("Processed ".concat(this.recipes.length," recipes")),console.log("Processed ".concat(this.entities.length," entities")),console.groupEnd()}return Object(s.a)(e,[{key:"getItemOrder",value:function(e){var t="",n="",r=this.raw.groups[e.raw.group];return r&&(t=r.order,n=r.subgroups[e.raw.subgroup]||""),[t,n,e.raw.order,e.raw.name]}},{key:"sortByItem",value:function(e,t){var n=this;e.sort(function(e,r){var a=n.getItemOrder(t(e)),i=n.getItemOrder(t(r));for(var o in a){var c=a[o],s=i[o];if(c>s)return 1;if(c<s)return-1}return 0})}}]),e}(),Q=n(22),J=n(44),V=n(9),Z=n(67);function Y(e,t){var n,r=e instanceof U?e.category:e;return n=r in t.settings.assemblerOverrides?t.settings.assemblerOverrides[r]:t.gameData.categoryMap[r][0],e instanceof U&&g(-1!==e.madeIn.indexOf(n)),n}var $={gameData:{fakeGameData:!0},groups:[{name:"Factory 1",rows:[]}],settings:{assemblerOverrides:{}},activeGroupIdx:0,recipeTarget:void 0};function X(e){return e.groups[e.activeGroupIdx]}function ee(e,t){var n=e.groups.map(function(n,r){return r===e.activeGroupIdx?Object(V.a)({},n,t):n});return Object(V.a)({},e,{groups:n})}var te=Object(Z.a)($)({replaceState:function(e){return function(t){return Object(V.a)({},t,e)}},addRow:function(e){return function(t){var n=X(t);if(!n.rows.some(function(t){return t.recipe.name===e.recipe.name}))return ee(t,{rows:[].concat(Object(J.a)(n.rows),[e])})}},updateRow:function(e,t){return function(n){var r=X(n),a=Array.from(r.rows);return a[e]=Object(V.a)({},r.rows[e],t),ee(n,{rows:a})}},removeRow:function(e){return function(t){var n=X(t),r=Array.from(n.rows);return r.splice(e,1),ee(t,{rows:r})}},moveRow:function(e,t){return function(n){var r=X(n),a=Array.from(r.rows),i=a.splice(e,1),o=Object(h.a)(i,1)[0];return a.splice(t,0,o),ee(n,{rows:a})}},updateDefaultMachine:function(e,t){return function(n){var r=Y(e,n),a=n.groups.map(function(n){var a=n.rows.map(function(n){return n.recipe.category!==e||n.machine!==r?n:Object(V.a)({},n,{machine:t})});return Object(V.a)({},n,{rows:a})});return Object(V.a)({},n,{groups:a,settings:Object(V.a)({},n.settings,{assemblerOverrides:Object(V.a)({},n.settings.assemblerOverrides,Object(Q.a)({},e,t))})})}},setActiveGroup:function(e){return function(t){return Object(V.a)({},t,{activeGroupIdx:e})}},addGroup:function(e){return function(t){var n=[].concat(Object(J.a)(t.groups),[{name:e,rows:[]}]);return Object(V.a)({},t,{groups:n,activeGroupIdx:t.groups.length})}},removeGroup:function(e){return function(t){var n=Array.from(t.groups);n.splice(e,1),n.length||n.push({name:"Factory 1",rows:[]});var r=n.length-1,a=Math.min(t.activeGroupIdx,r);return Object(V.a)({},t,{groups:n,activeGroupIdx:a})}},setRecipeTarget:function(e){return function(t){return Object(V.a)({},t,{recipeTarget:e})}}}),ne=Object(h.a)(te,2),re=ne[0],ae=ne[1],ie=function(e){return function(t){var n=ae(),r=Object(h.a)(n,2),a=r[0],o=r[1];return i.a.createElement(e,Object.assign({state:a,actions:o},t))}},oe=function(e){return function(t){var n=ae(),r=Object(h.a)(n,1)[0];return i.a.createElement(e,Object.assign({gameData:r.gameData},t))}},ce=n(40);function se(e){return{name:e.name,rows:e.rows.map(function(e){return[e[0],e[1],e[2].toString(),e[3],e[4],e[5]]})}}function ue(e){var t=localStorage.getItem("appstate");if(!t)return null;var n=JSON.parse(t);return 1===n.version&&(n.version=3),he(e,n)}function le(e){return{version:5,data:{groups:e.groups.map(function(t){return{name:t.name,rows:t.rows.map(function(t){var n=t.machine.data.name;return Y(t.recipe,e).data.name===n&&(n=null),[t.recipe.name,n,t.numMachines.toFraction(),t.modules.map(function(e){return e?e.name:null}),t.beaconModule?t.beaconModule.name:void 0,t.numBeacons]})}}),settings:{assemblerOverrides:O(e.settings.assemblerOverrides,function(e){return e.data.name})}}}}var me=/^#(\d+)?(?:-)?(.+)$/;function pe(e){var t=me.exec(document.location.hash);if(!t)return null;var n=Number(t[1]||1),r=decodeURIComponent(t[2]);return n>2&&(r=Object(ce.inflate)(atob(r),{to:"string"})),he(e,{version:n,data:JSON.parse(r)})}function de(e){switch(e.version){case 1:e=function(e){return{version:2,data:{rows:e.data,settings:{assemblerOverrides:{}}}}}(e);case 2:e=function(e){return{version:3,data:e.data}}(e);case 3:e=function(e){return{version:4,data:{settings:e.data.settings,groups:[{name:"Factory 1",rows:e.data.rows}]}}}(e);case 4:e=function(e){return{version:5,data:{settings:e.data.settings,groups:e.data.groups.map(se)}}}(e);case 5:break;default:throw new Error("unknown state: ".concat(e))}return e}function he(e,t){var n=de(t).data,r={gameData:e,settings:fe(e,n.settings),groups:[],activeGroupIdx:0,recipeTarget:void 0};return r.groups=n.groups.map(function(t){return{name:t.name,rows:t.rows.map(function(t){var n=Object(h.a)(t,6),a=n[0],i=n[1],o=n[2],c=n[3],s=n[4],u=n[5],l=e.recipeMap[a];return{recipe:l,machine:i?e.entityMap[i]:Y(l,r),numMachines:N.fromString(o),modules:c.map(function(t){return t?e.moduleMap[t]:null}),beaconModule:s?e.moduleMap[s]:null,numBeacons:u||0}})}}),r}function fe(e,t){return{assemblerOverrides:O(t.assemblerOverrides,function(t){return e.entityMap[t]})}}var ve=n(23),be=function(){function e(){var t=this;Object(c.a)(this,e),this.handlers=[],this.dispatch=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.handlers[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(e)}}catch(c){r=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}return Object(s.a)(e,[{key:"addHandler",value:function(e){-1===this.handlers.indexOf(e)&&this.handlers.push(e)}},{key:"removeHandler",value:function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}}]),e}(),ye=new be,ge=new be,Oe=new be,we=n(30),Ee=27,je=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).buttonRef=void 0,n.handleToggle=function(){n.setState({isOpen:!n.state.isOpen})},n.handleSelect=function(e){n.props.onSelect(e),n.state.isOpen&&n.setState({isOpen:!1})},n.handleWantClose=function(){n.state.isOpen&&n.setState({isOpen:!1})},n.state={isOpen:!1},n.buttonRef=a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.options.some(function(e){return"option"in e&&!e.disabled}),r=["btn","btn-secondary"];return n?r.push("dropdown-toggle"):r.push("disabled"),this.state.isOpen&&(e=a.createElement(ke,{parentRef:this.buttonRef,options:this.props.options,renderOption:this.props.renderOption,onSelect:this.handleSelect,onWantClose:this.handleWantClose})),a.createElement(a.Fragment,null,a.createElement("button",{ref:this.buttonRef,className:r.join(" "),type:"button",onClick:function(){n&&t.handleToggle()}},this.props.renderSelected(this.props.selected)),e)}}]),t}(a.Component),ke=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).popperInstance=null,n.menuRef=void 0,n.popperUpdate=function(e){return n.setState({style:e.styles}),e},n.handleBodyClick=function(e){if(!n.menuRef.current)throw new Error("Click event without menu rendered. This should not happen.");if(!e.target)throw new Error("Click event without click target. This should not happen.");var t=e.target;n.menuRef.current.contains(t)||n.props.onWantClose()},n.handleKeyEvent=function(e){e.keyCode===Ee&&n.props.onWantClose()},n.renderOptions=function(){return n.props.options.map(function(e,t){if("header"in e)return a.createElement("h6",{className:"dropdown-header",key:"ddkey"+t},e.header);if("divider"in e)return a.createElement("div",{className:"dropdown-divider",key:"ddkey"+t});var r=["dropdown-item"];return e.active&&r.push("active"),e.disabled&&r.push("disabled"),a.createElement("button",{key:e.key,className:r.join(" "),onClick:function(){return n.props.onSelect(e.option)},type:"button"},n.props.renderOption(e.option))})},n.menuRef=a.createRef(),n.state={style:{}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.popperInstance)throw new Error("Component mounted twice?");var e=this.props.parentRef.current;if(!e)throw new Error("Cannot mount DropdownMenu without parentRef");var t=this.menuRef.current;if(!t)throw new Error("Cannot mount DropdownMenu without menuRef");this.popperInstance=new we.a(e,t,{modifiers:{applyStyle:{enabled:!1},updateStateWithStyle:{enabled:!0,fn:this.popperUpdate}}}),document.body.addEventListener("click",this.handleBodyClick),document.body.addEventListener("keyup",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null),document.body.removeEventListener("click",this.handleBodyClick),document.body.removeEventListener("keyup",this.handleKeyEvent)}},{key:"render",value:function(){return a.createElement("div",{className:"dropdown-menu show",style:this.state.style,ref:this.menuRef},this.renderOptions())}}]),t}(a.Component),Ne=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).selfRef=void 0,n.popperInstance=void 0,n.handleMouseEnter=function(){n.setState({showSelf:!0})},n.handleMouseLeave=function(){n.setState({showSelf:!1})},n.selfRef=a.createRef(),n.popperInstance=null,n.state={showSelf:!1,style:{zIndex:1001}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"initPopper",value:function(){if(!this.popperInstance){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");var t=this.selfRef.current;if(!t)throw new Error("No self reference yet?");this.popperInstance=new we.a(e,t,{placement:"right",modifiers:{offset:{enabled:!0,offset:"0, 20"},preventOverflow:{enabled:!0,boundariesElement:"window"}}})}}},{key:"cleanupPopper",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null)}},{key:"componentDidUpdate",value:function(e,t){t.showSelf!==this.state.showSelf&&(this.state.showSelf?this.initPopper():this.cleanupPopper())}},{key:"componentDidMount",value:function(){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");e.addEventListener("mouseenter",this.handleMouseEnter),e.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"componentWillUnmount",value:function(){var e=this.props.relativeTo.current;e&&(e.removeEventListener("mouseenter",this.handleMouseEnter),e.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"render",value:function(){return this.state.showSelf?o.createPortal(a.createElement("div",{style:this.state.style,ref:this.selfRef},this.props.children),document.body):null}}]),t}(a.Component),Ce=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;if(n.setState({txtValue:t}),t.trim()){var r=Number(t);n.props.intOnly&&!Number.isInteger(r)||n.props.positiveOnly&&r<0||n.props.onChange(r)}},n.state={txtValue:e.value.toString()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.createElement("input",{className:"form-control",value:this.state.txtValue,onChange:this.handleChange,type:"number",min:"0",step:"1"})}}]),t}(a.PureComponent),Se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;if(n.setState({txtValue:t,error:void 0}),t.trim())if(t.indexOf("/")===t.lastIndexOf("/")){var r;try{r=N.fromString(t)}catch(a){return void n.setState({error:a.message})}n.props.positiveOnly&&r.isNegative()?n.setState({error:"Number must be positive"}):n.props.onChange(r)}else n.setState({error:"Too many slashes"})},n.state={txtValue:e.value.toDecimal()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e="form-control";return this.state.error&&(e+=" is-invalid"),a.createElement("input",{className:e,value:this.state.txtValue,onChange:this.handleChange,type:"text"})}}]),t}(a.PureComponent),Me=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).iconRef=void 0,n.iconRef=a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=32*-this.props.obj.icon_col,t=32*-this.props.obj.icon_row,n=Object(V.a)({display:"inline-block",backgroundPosition:"".concat(e,"px ").concat(t,"px"),width:"32px",height:"32px"},this.props.style),r=a.createElement("div",{ref:this.iconRef,onClick:this.props.onClick,title:this.props.title,className:"game-icon",style:n},"\xa0");return this.props.tooltip&&(r=a.createElement(a.Fragment,null,r,a.createElement(Ne,{children:this.props.tooltip,relativeTo:this.iconRef}))),this.props.text&&(r=a.createElement("div",{style:{lineHeight:"32px"}},r,a.createElement("span",{style:{marginLeft:"9px"}},this.props.text))),r}}]),t}(a.PureComponent),xe=function(e){return a.createElement("div",{className:"machine-card card"},a.createElement("div",{className:"card-body"},a.createElement("b",null,e.machine.niceName()),a.createElement("br",null),a.createElement("b",null,"Crafting Speed:")," ",e.machine.data.crafting_speed,a.createElement("br",null),a.createElement("b",null,"Module Slots:")," ",e.machine.data.module_slots))},Ie=oe(function(e){var t=e.recipe,n=t.ingredients.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,text:e.niceName()})}),r=t.products.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,text:e.niceName()})}),i=t.madeIn.map(function(e,t){return a.createElement(Me,{key:t,obj:e.data,tooltip:a.createElement(xe,{machine:e})})});return a.createElement("div",{className:"recipe-tooltip card",onClick:function(){e.onClick&&e.onClick(e.recipe)}},a.createElement("div",{className:"card-header"},a.createElement(Me,{obj:t,text:t.niceName()})),a.createElement("div",{className:"card-body"},a.createElement(Me,{obj:e.gameData.raw.sprites.extra.clock,text:t.crafting_time.toDecimal()}),a.createElement("div",{style:{float:"left"}},"Ingredients:",n),a.createElement("div",{style:{display:"inline-block"}},"Products:",r),a.createElement("div",{style:{clear:"both"}}),a.createElement("div",{style:{lineHeight:"32px"}},"Made In:",i)))}),_e=function(e){return a.createElement(Me,{obj:e.data,tooltip:a.createElement(xe,{machine:e})})},Re=function(e){return a.createElement(Me,{obj:e.data,tooltip:a.createElement(xe,{machine:e}),text:e.niceName()})},De=function(e){var t=e.machines.map(function(t){return{key:t.data.name,option:t,active:t===e.selected}});return a.createElement(je,{options:t,selected:e.selected,onSelect:e.onChange,renderOption:Re,renderSelected:_e})},Pe={consumption:"Energy Consumption",productivity:"Productivity",speed:"Speed",pollution:"Pollution"},qe=function(e){var t=e.module,n=[];for(var r in t.raw.effect){var i=t.raw.effect[r].bonus;n.push(a.createElement("div",{key:r},a.createElement("b",null,Pe[r],":"," ",j(100*i,2),"%")))}return a.createElement("div",{className:"module-card card"},a.createElement("div",{className:"card-header"},a.createElement("b",null,t.niceName())),a.createElement("div",{className:"card-body"},n))},Be=oe(function(e){var t=e.gameData.raw.sprites.extra.slot_icon_module,n=new P({type:"module",name:"no_module",localised_name:{en:"No Module"},category:"speed",effect:{},limitation:[],rocket_launch_products:[],icon_row:t.icon_row,icon_col:t.icon_col,group:"",subgroup:"",order:""}),r=e.gameData.modules.filter(function(t){return(!e.isBeacon||!t.effects.productivity.isPositive())&&t.canUseWith(e.recipe)}).map(function(t){return{key:t.name,option:t,active:t===e.selected}});return r.unshift({key:"no_module",option:null,active:!e.selected}),a.createElement(je,{options:r,selected:e.selected,onSelect:e.onChange,renderOption:function(e){return e?a.createElement(Me,{obj:e,tooltip:a.createElement(qe,{module:e}),text:e.niceName()}):a.createElement(Me,{obj:n,text:n.niceName()})},renderSelected:function(e){return e?a.createElement(Me,{obj:e,tooltip:a.createElement(qe,{module:e})}):a.createElement(Me,{obj:n})}})}),Fe=function(){function e(){var t=this;Object(c.a)(this,e),this.products=[],this.ingredients=[],this.addIngredient=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.ingredients[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.maximum_temperature===c.maximum_temperature&&e.minimum_temperature===c.minimum_temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){r=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}t.ingredients.push(e)},this.addProduct=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.products[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.temperature===c.temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){r=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}t.products.push(e)}}return Object(s.a)(e,[{key:"addRow",value:function(e){var t={consumption:N.one,pollution:N.one,productivity:N.one,speed:N.one},n=!0,r=!1,a=void 0;try{for(var i,o=e.modules[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;c&&(t.consumption=t.consumption.add(c.effects.consumption),t.pollution=t.pollution.add(c.effects.pollution),t.productivity=t.productivity.add(c.effects.productivity),t.speed=t.speed.add(c.effects.speed))}}catch(p){r=!0,a=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(e.beaconModule&&e.numBeacons>0){var s=e.beaconModule.effects,u=N.fromInts(e.numBeacons,2);t.consumption=t.consumption.add(s.consumption.mul(u)),t.pollution=t.pollution.add(s.pollution.mul(u)),t.productivity=t.productivity.add(s.productivity.mul(u)),t.speed=t.speed.add(s.speed.mul(u))}t.consumption=t.consumption.clamp(.2,32767),t.pollution=t.pollution.clamp(.2,32767),t.speed=t.speed.clamp(.2,32767),t.productivity=t.productivity.clamp(1,32767);var l=N.one.mul(e.recipe.crafting_time.invert()).mul(e.numMachines).mul(e.machine.data.crafting_speed).mul(t.speed),m=l.mul(t.productivity);e.recipe.ingredients.map(function(e){return(e=E(e)).amount=e.amount.mul(l),e}).forEach(this.addIngredient),e.recipe.products.map(function(e){return(e=E(e)).amount=e.amount.mul(m),e}).forEach(this.addProduct)}},{key:"reduce",value:function(){var e=this.ingredients.map(E),t=this.products.map(E),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=e[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;c.amount.isZero()||d.amount.isZero()||c.satisfies(d)&&(c.amount.less(d.amount)?(d.amount=d.amount.sub(c.amount),c.amount=N.zero):d.amount.less(c.amount)?(c.amount=c.amount.sub(d.amount),d.amount=N.zero):(d.amount=N.zero,c.amount=N.zero))}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){r=!0,a=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return{ingredients:e=e.filter(function(e){return!e.amount.isZero()}),products:t=t.filter(function(e){return!e.amount.isZero()})}}}]),e}(),Te=function(e){return a.createElement("div",{className:"card"},a.createElement("div",{className:"card-header"},e.obj.item.niceName()," (",e.obj.name,")"))},Ge=ie(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleRemoveClick=function(){n.props.actions.removeRow(n.props.index)},n.handleMachineChange=function(e){n.applyChange({machine:e,modules:n.props.modules.filter(function(e){return null!==e}).slice(0,e.data.module_slots)})},n.handleNumMachinesChange=function(e){n.applyChange({numMachines:e})},n.handleNumBeaconsChange=function(e){n.applyChange({numBeacons:e})},n.handleSetAllModules=function(){n.applyChange({modules:new Array(n.props.machine.data.module_slots).fill(n.props.modules[0])})},n.handleSetModule=function(e,t){var r=n.props.modules.slice();r[e]=t,n.applyChange({modules:r})},n.handleSetBeaconModule=function(e){n.applyChange({beaconModule:e})},n.handleIngredientClick=function(e,t){if(t.shiftKey)return t.preventDefault(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.madeBy.length?Oe.dispatch(e.item.madeBy[0]):ye.dispatch(e)},n.handleProductClick=function(e,t){if(t.shiftKey)return t.preventDefault(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.usedBy.length?Oe.dispatch(e.item.usedBy[0]):ge.dispatch(e)},n.handleInputGroupClick=function(e){var t=n.props.state.recipeTarget;if(e.shiftKey&&t){e.preventDefault();var r,a=n.getOutput();if(r=(r=a.ingredients.find(function(e){return e.item.name===t.item.name}))||a.products.find(function(e){return e.item.name===t.item.name})){var i=t.amount.div(r.amount).mul(n.props.numMachines);n.applyChange({numMachines:i})}else console.error("Could not find ".concat(t.item.name," in totals"),a)}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"applyChange",value:function(e){this.props.actions.updateRow(this.props.index,e)}},{key:"getOutput",value:function(){var e=new Fe;return e.addRow(this.props),{ingredients:e.ingredients,products:e.products}}},{key:"renderModules",value:function(){for(var e=this,t=this.props.machine.data.module_slots,n=[],r=function(t){var r=e.props.modules[t];n.push(a.createElement(Be,{key:t,recipe:e.props.recipe,selected:r,onChange:function(n){return e.handleSetModule(t,n)}}))},i=0;i<t;i++)r(i);return t>1&&n.splice(1,0,a.createElement("button",{onClick:this.handleSetAllModules,key:"applicator",className:"btn"},"\u2192")),n}},{key:"renderBeacons",value:function(){return a.createElement("div",{className:"btn-toolbar mb-3"},a.createElement("div",{className:"input-group"},a.createElement("div",{className:"input-group-prepend"},a.createElement("div",{className:"input-group-text"},"Beacon Modules")),a.createElement(Ce,{value:this.props.numBeacons,onChange:this.handleNumBeaconsChange,positiveOnly:!0,intOnly:!0}),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(Be,{isBeacon:!0,recipe:this.props.recipe,selected:this.props.beaconModule,onChange:this.handleSetBeaconModule}))))}},{key:"renderMachines",value:function(){return a.createElement("div",{className:"btn-toolbar mb-3"},a.createElement("div",{className:"input-group",onClick:this.handleInputGroupClick},a.createElement(Se,{key:this.props.numMachines.toFraction(),value:this.props.numMachines,onChange:this.handleNumMachinesChange,positiveOnly:!0}),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(De,{machines:this.props.recipe.madeIn,selected:this.props.machine,onChange:this.handleMachineChange}))))}},{key:"render",value:function(){var e=this,t=this.props.recipe,n=this.getOutput(),r=n.ingredients.map(function(t,n){return a.createElement("div",{className:"mb-1",key:n},a.createElement(Me,{onClick:e.handleIngredientClick.bind(null,t),tooltip:a.createElement(Te,{obj:t}),obj:t.item,text:"".concat(t.amount.toDecimal()," / sec")}))}),i=n.products.map(function(t,n){return a.createElement("div",{className:"mb-1",key:n},a.createElement(Me,{onClick:e.handleProductClick.bind(null,t),tooltip:a.createElement(Te,{obj:t}),obj:t.item,text:"".concat(t.amount.toDecimal()," / sec")}))});return a.createElement(ve.b,{draggableId:t.name,index:this.props.index},function(n){return a.createElement("div",Object.assign({className:"recipe-row card mb-3",ref:n.innerRef},n.draggableProps),a.createElement("div",Object.assign({className:"card-header"},n.dragHandleProps),a.createElement("div",{style:{float:"left"}},a.createElement(Me,{obj:t,text:t.niceName(),tooltip:a.createElement(Ie,{recipe:t})})),a.createElement("div",{style:{float:"right"}},a.createElement("button",{type:"button",className:"btn btn-danger",onClick:e.handleRemoveClick},"Remove")),a.createElement("div",{style:{clear:"both"}})),a.createElement("div",{className:"card-body"},a.createElement("div",{style:{float:"left"}},e.renderMachines(),a.createElement("div",{className:"mb-3 btn-group btn-icon-wrapper"},e.renderModules()),e.renderBeacons()),a.createElement("div",{style:{float:"right"}},a.createElement("div",{className:"mr-3",style:{display:"inline-block",float:"left",minWidth:"150px"}},a.createElement("b",null,"Ingredients:"),r),a.createElement("div",{className:"mr-2",style:{display:"inline-block",minWidth:"150px"}},a.createElement("b",null,"Products:"),i)),a.createElement("div",{style:{clear:"both"}})))})}}]),t}(a.Component)),Ae=n(29),Le=n(72),We=n.n(Le),Ue=n(73),He=n.n(Ue);function Ke(e,t){switch(t){case"niceName":return e.niceName();case"name":return e.name}}var ze=/((?:produces)|(?:consumes)):([a-z0-9-]+)/g,Qe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleIngredientClick=function(e){var t="produces:".concat(e.name);n.state.query.includes(t)||n.setQuery("".concat(n.state.query," ").concat(t),function(){n.calculateMatches()})},n.handleProductClick=function(e){var t="consumes:".concat(e.name);n.state.query.includes(t)||n.setQuery("".concat(n.state.query," ").concat(t),function(){n.calculateMatches()})},n.handleQueryInput=function(e){var t=e.target;n.setQuery(t.value)},n.handleRecipeClick=function(e){n.props.onPickRecipe(e),n.setQuery("")},n.setQuery=function(e,t){e.trim()?(n.setState({query:e},t),n.debCalculateMatches()):(n.debCalculateMatches.cancel(),n.setState({query:"",matches:[]},t))},n.debCalculateMatches=He()(n.calculateMatches.bind(Object(Ae.a)(n)),200),n.state={query:"",matches:[]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){ye.addHandler(this.handleIngredientClick),ge.addHandler(this.handleProductClick)}},{key:"componentWillUnmount",value:function(){this.debCalculateMatches.cancel(),ye.removeHandler(this.handleIngredientClick),ge.removeHandler(this.handleProductClick)}},{key:"calculateMatches",value:function(){var e=this.state.query.trim().toLowerCase();if(e){var t={consumes:[],produces:[]};e=e.replace(ze,function(e,n,r){return t[n].push(r),""}).trim();var n=this.props.recipes;if((t.consumes.length||t.produces.length)&&(n=n.filter(function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=function(){var t=i.value;if(!e.ingredients.some(function(e){return e.name===t}))return{v:!1}},c=t.consumes[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var s=o();if("object"===typeof s)return s.v}}catch(v){r=!0,a=v}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}var u=!0,l=!1,m=void 0;try{for(var p,d=function(){var t=p.value;if(!e.products.some(function(e){return e.name===t}))return{v:!1}},h=t.produces[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var f=d();if("object"===typeof f)return f.v}}catch(v){l=!0,m=v}finally{try{u||null==h.return||h.return()}finally{if(l)throw m}}return!0})),e)n=new We.a(n,{shouldSort:!0,getFn:Ke,keys:[{name:"niceName",weight:.7},{name:"name",weight:.2}]}).search(e);this.setState({matches:n})}else this.setState({matches:[]})}},{key:"renderMatches",value:function(){var e=this;if(!this.state.matches.length)return"";var t=this.state.matches;return t.length>100&&(t=t.slice(0,100)),a.createElement("table",{className:"table table-hover"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Recipe"),a.createElement("th",null,"Time"),a.createElement("th",null,"Ingredients"),a.createElement("th",null,"Products"))),a.createElement("tbody",null,t.map(function(t){return a.createElement(Ve,{recipe:t,key:t.name,onClick:e.handleRecipeClick})})))}},{key:"render",value:function(){return a.createElement("div",{className:"recipe-picker"},a.createElement("div",null,a.createElement("input",{className:"editable-display form-control",placeholder:"Search for a recipe",value:this.state.query,onChange:this.handleQueryInput})),this.renderMatches())}}]),t}(a.PureComponent);function Je(e){return a.createElement("div",{className:"card"},a.createElement("div",{className:"card-body"},e))}var Ve=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleClickAdd=function(){n.props.onClick(n.props.recipe)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.recipe,t=e.ingredients.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,tooltip:Je(e.niceName())})}),n=e.products.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,tooltip:Je(e.niceName())})});return a.createElement("tr",{onClick:this.handleClickAdd},a.createElement("td",{className:"result-name"},a.createElement(Me,{obj:e,text:e.niceName()})),a.createElement("td",null,e.crafting_time.toDecimal()),a.createElement("td",null,t),a.createElement("td",null,n))}}]),t}(a.PureComponent);var Ze,Ye=oe(function(e){var t=new Fe,n=!0,r=!1,i=void 0;try{for(var o,c=e.rows[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;t.addRow(s)}}catch(p){r=!0,i=p}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}var u=t.reduce(),l=u.ingredients,m=u.products;return l.length||m.length?(e.gameData.sortByItem(m,function(e){return e.item}),a.createElement("div",{className:"card combined-totals"},a.createElement("div",{className:"card-header"},"Combined Totals"),a.createElement("div",{className:"card-body"},a.createElement("div",{className:"container"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col"},"Ingredients:",l.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,text:e.niceName()})})),a.createElement("div",{className:"col"},"Products:",m.map(function(e,t){return a.createElement(Me,{key:t,obj:e.item,text:e.niceName()})}))))))):a.createElement("div",null)}),$e=ie(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).handlePickRecipe=function(e){n.props.actions.addRow({recipe:e,machine:Y(e,n.props.state),numMachines:N.one,modules:[],beaconModule:null,numBeacons:0})},n.handleDragEnd=function(e){e.destination&&n.props.actions.moveRow(e.source.index,e.destination.index)},n.renderRow=function(e,t){return a.createElement(Ge,Object.assign({key:e.recipe.name,index:t},e))},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Oe.addHandler(this.handlePickRecipe)}},{key:"componentWillUnmount",value:function(){Oe.removeHandler(this.handlePickRecipe)}},{key:"render",value:function(){var e=this,t=this.props.state.gameData.recipes.filter(function(t){return!e.props.rows.some(function(e){return e.recipe===t})});return a.createElement("div",{className:"recipe-group"},a.createElement(Qe,{recipes:t,onPickRecipe:this.handlePickRecipe}),a.createElement("hr",null),a.createElement(ve.a,{onDragEnd:this.handleDragEnd},a.createElement(ve.c,{droppableId:"eyy"},function(t){return a.createElement("div",Object.assign({ref:t.innerRef},t.droppableProps),e.props.rows.map(e.renderRow),t.placeholder)})),a.createElement("hr",null),a.createElement(Ye,{rows:this.props.rows}))}}]),t}(a.Component)),Xe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.entries(this.props.gameData.categoryMap).filter(function(e){return e[1].length>1}).map(function(e){return e[0]});return e.sort(function(e,t){return e.localeCompare(t)}),a.createElement("div",null,a.createElement("h3",null,"Default Assemblers"),e.map(function(e){return a.createElement(et,{key:e,category:e})}))}}]),t}(a.Component),et=ie(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleChange=function(e){n.props.actions.updateDefaultMachine(n.props.category,e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.state.gameData.categoryMap[this.props.category],t=Y(this.props.category,this.props.state);return a.createElement("div",{className:"btn-toolbar mb-3",key:this.props.category},a.createElement("div",{className:"input-group"},a.createElement("div",{className:"input-group-prepend"},a.createElement("span",{className:"input-group-text"},this.props.category)),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(De,{machines:e,selected:t,onChange:this.handleChange}))))}}]),t}(a.Component)),tt=oe(Xe);!function(e){e.Factory="FACTORY",e.Settings="SETTINGS"}(Ze||(Ze={}));var nt=ie(function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleKeyDown=function(e){"Shift"===e.key&&document.body.classList.add("shift-down")},n.handleKeyUp=function(e){"Shift"===e.key&&document.body.classList.remove("shift-down")},n.handleClickSettings=function(e){e.preventDefault(),n.setState({activePage:Ze.Settings})},n.handleClickGroup=function(e,t){t.preventDefault(),n.setState({activePage:Ze.Factory}),n.props.actions.setActiveGroup(e)},n.handleClickAddGroup=function(e){e.preventDefault();var t="Factory ".concat(n.props.state.groups.length+1),r=prompt("What do you want to name this group?",t);r&&r.trim()&&n.props.actions.addGroup(r)},n.handleClickRemoveGroup=function(e,t){t.preventDefault();var r=n.props.state.groups[n.props.state.activeGroupIdx];window.confirm("Are you sure you want to delete ".concat(r.name))&&n.props.actions.removeGroup(e)},n.renderNavbar=function(){var e=n.state.activePage===Ze.Settings,t=n.props.state.groups.map(function(t,r){var i=e||n.props.state.activeGroupIdx!==r?"btn btn-secondary":"btn btn-primary";return a.createElement("div",{className:"btn-group mr-2",role:"group",key:r},a.createElement("button",{type:"button",className:i,onClick:n.handleClickGroup.bind(null,r)},t.name),a.createElement("button",{type:"button",className:"btn btn-danger",title:"Remove this group",onClick:n.handleClickRemoveGroup.bind(null,r)},"\u2716"))}),r=e?"btn btn-primary":"btn btn-secondary";return a.createElement("nav",{className:"navbar"},a.createElement("div",{className:"btn-toolbar",role:"toolbar","aria-label":"Toolbar with button groups"},t,a.createElement("button",{type:"button",className:"btn btn-secondary mr-2",title:"Add a factory",onClick:n.handleClickAddGroup},"+"),a.createElement("button",{type:"button",className:r,onClick:n.handleClickSettings},"Settings")))},n.renderFactory=function(){var e=n.props.state.groups[n.props.state.activeGroupIdx];return a.createElement("div",{className:"container"},a.createElement($e,{rows:e.rows}))},n.renderSettings=function(){return a.createElement("div",{className:"container"},a.createElement(tt,null))},n.state={activePage:Ze.Factory},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}},{key:"render",value:function(){if(!this.props.state.gameData.raw)return null;var e;if(this.state.activePage===Ze.Factory)e=this.renderFactory();else{if(this.state.activePage!==Ze.Settings)return function(e){throw new Error("Unexpected object: "+e)}(this.state.activePage);e=this.renderSettings()}return a.createElement(a.Fragment,null,this.renderNavbar(),e)}}]),t}(a.Component)),rt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={gameData:null},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.load().catch(function(t){e.setState(function(){throw t})})}},{key:"load",value:function(){var e=Object(b.a)(v.a.mark(function e(){var t,n,r,a,i;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("assets/landblock.json");case 2:if(200===(t=e.sent).status){e.next=5;break}throw new Error("Could not load game data, got HTTP status ".concat(t.status));case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),new Error("Could not parse game data: ".concat(e.t0));case 14:r=new z(n),this.props.actions.replaceState({gameData:r}),(a=pe(r))?this.props.actions.replaceState(a):(i=ue(r))&&this.props.actions.replaceState(i),this.setState({gameData:r});case 19:case"end":return e.stop()}},e,this,[[5,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.state.gameData)return i.a.createElement("h1",null,"Loading...");var e="assets/sprite-sheet-".concat(this.state.gameData.raw.sprites.hash,".png"),t="\n        .game-icon {\n            background-image: url(".concat(e,");\n        }\n        ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(at,null),i.a.createElement(it,{href:e}),i.a.createElement("style",null,t),i.a.createElement(nt,null))}}]),t}(i.a.Component),at=function(){var e=ae(),t=Object(h.a)(e,1)[0];return Object(a.useEffect)(function(){!function(e){var t=le(e),n=t.version,r=JSON.stringify(t.data);r=btoa(Object(ce.deflate)(r,{to:"string"})),window.history.replaceState("","","#".concat(n,"-").concat(r))}(t),function(e){localStorage.setItem("appstate",JSON.stringify(le(e)))}(t)},[t]),null},it=function(e){return o.createPortal(i.a.createElement("link",{rel:"prefetch",href:e.href}),document.head)},ot=ie(rt);n(136);r.a({dsn:"https://2ab99c1e02a448cbaa06595164416044@sentry.io/1385727"}),o.render(a.createElement(a.StrictMode,null,a.createElement(d,null,a.createElement(re,null,a.createElement(ot,null)))),document.getElementById("root"))},76:function(e,t,n){e.exports=n(137)}},[[76,1,2]]]);
//# sourceMappingURL=main.25c4741f.chunk.js.map