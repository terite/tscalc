(this.webpackJsonptscalc=this.webpackJsonptscalc||[]).push([[0],{107:function(e,t,n){e.exports={TotalCard:"TotalCard_TotalCard__2ci0q"}},108:function(e,t,n){e.exports={RecipeGroup:"RecipeGroup_RecipeGroup__3MC_F"}},114:function(e,t,n){e.exports={Sidebar:"App_Sidebar__3POeR"}},118:function(e,t,n){e.exports=n(196)},195:function(e,t,n){},196:function(e,t,n){"use strict";n.r(t);var r=n(202),a=n(0),i=n.n(a),o=n(15),c=n(3),s=n(4),u=n(7),l=n(5),m=n(8),p=n(19),d=n(93),h=n.n(d),f=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={crashMsg:void 0},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(e,t){this.crash(["Component Stack:",t.componentStack,"",e&&e.stack].join("\n")),p.b((function(n){Object.keys(t).forEach((function(e){n.setExtra(e,t[e])})),p.a(e)}))}},{key:"crash",value:function(e){this.setState({crashMsg:e})}},{key:"render",value:function(){return"undefined"!==typeof this.state.crashMsg?a.createElement("div",{className:h.a.crashed},a.createElement("h1",null,"Crashed!"),a.createElement("pre",null,this.state.crashMsg)):this.props.children}}]),t}(a.Component),v=n(17),y=n(65),b=n.n(y),g=n(96),O=n(116);function E(e,t){if(!e)throw new Error(t||"Assertion failed")}function w(e,t){var n={};for(var r in e)n[r]=t(e[r]);return n}function j(e){var t=[];for(var n in e)t.push(e[n]);return t}function k(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}function C(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function N(e,t){return E(Number.isSafeInteger(e)),E(Number.isSafeInteger(t)),{quotient:Math.floor(e/t),remainder:e%t}}var S=function(){function e(t,n){Object(c.a)(this,e),this.p=void 0,this.q=void 0,this.toString=void 0,E(Number.isSafeInteger(t),"Numerator must be an integer"),E(Number.isSafeInteger(n),"Denominator must be an integer"),E(0!==n,"Denominator must not be zero"),n<0&&(t=-t,n=-n),0===t&&(n=1);var r=function e(t,n){return n?e(n,t%n):t}(t,n);r>1&&(t/=r,n/=r),this.p=t,this.q=n}return Object(s.a)(e,[{key:"floor",value:function(){var t=N(this.p,this.q),n=new e(t.quotient,1);return n.less(e.zero)&&0!==t.remainder&&(n=n.sub(e.one)),n}},{key:"negate",value:function(){return new e(-this.p,this.q)}},{key:"invert",value:function(){return new e(this.q,this.p)}},{key:"add",value:function(t){return new e(this.p*t.q+this.q*t.p,this.q*t.q)}},{key:"sub",value:function(t){return new e(this.p*t.q-this.q*t.p,this.q*t.q)}},{key:"mul",value:function(t){return"number"==typeof t&&(t=e.fromFloat(t)),new e(this.p*t.p,this.q*t.q)}},{key:"div",value:function(t){return new e(this.p*t.q,this.q*t.p)}},{key:"clamp",value:function(t,n){return"number"==typeof t&&(t=e.fromFloat(t)),"number"==typeof n&&(n=e.fromFloat(n)),this.less(t)?t:n.less(this)?n:this}},{key:"divmod",value:function(e){var t=this.div(e).floor();return{quotient:t,remainder:this.sub(e.mul(t))}}},{key:"equal",value:function(e){return this.p===e.p&&this.q===e.q}},{key:"isNegative",value:function(){return this.p<0}},{key:"isPositive",value:function(){return this.p>0}},{key:"isOne",value:function(){return 1===this.p}},{key:"isZero",value:function(){return 0===this.p}},{key:"less",value:function(e){return this.p*e.q<this.q*e.p}},{key:"toFloat",value:function(){return this.p/this.q}},{key:"toFraction",value:function(){return 1===this.q?this.p.toString():this.p.toString()+"/"+this.q.toString()}},{key:"toDecimal",value:function(t,n){null==t&&(t=3),null==n&&(n=new e(5,Math.pow(10,t+1)));var r="",a=this;a.isNegative()&&(r="-",a=a.negate());for(var i=N((a=a.add(n)).p,a.q),o=i.quotient.toString(),c="",s=new e(i.remainder,a.q),u=new e(10,1);t>0&&!s.equal(n);){s=s.mul(u),n=n.mul(u);var l=N(s.p,s.q);c+=l.quotient.toString(),s=new e(l.remainder,s.q),t--}if(s.equal(n))for(;"0"===c[c.length-1];)c=c.slice(0,c.length-1);return""!==c?r+o+"."+c:r+o}}],[{key:"fromFloat",value:function(t){if(Number.isInteger(t))return new this(t,1);var n=new e(Math.round(1e4*t),1e4),r=n.divmod(e.one),a=!0,i=!1,o=void 0;try{for(var c,s=x[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var u=c.value,l=Object(v.a)(u,2),m=l[0],p=l[1];if(r.remainder.equal(m))return r.quotient.add(p)}}catch(d){i=!0,o=d}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"fromInts",value:function(e,t){return new this(e,t)}},{key:"fromString",value:function(t){var n=t.indexOf("/");if(-1===n)return e.fromFloat(Number(t));var r=Number(t.slice(0,n)),a=Number(t.slice(n+1));return e.fromInts(r,a)}}]),e}();S.zero=new S(0,1),S.one=new S(1,1),S.oneThird=new S(1,3),S.twoThirds=new S(2,3);for(var x=[],M=2;M<100;M++)for(var _=1;_<M;_++){var I=_/M;if(!(I.toString().length<10)){var R=new S(Math.round(1e4*I),1e4);x.push([R,S.fromInts(_,M)]);var P=new S(Math.floor(1e4*I),1e4);x.push([P,S.fromInts(_,M)])}}var D=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.localised_name=void 0,this.icon_col=void 0,this.icon_row=void 0,this.name=t.name,this.localised_name=t.localised_name,this.icon_col=t.icon_col,this.icon_row=t.icon_row}return Object(s.a)(e,[{key:"niceName",value:function(){return this.localised_name.en}}]),e}(),q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).raw=void 0,n.usedBy=[],n.madeBy=[],n.raw=e,n.name=e.name,n.localised_name=e.localised_name,n.icon_col=e.icon_col,n.icon_row=e.icon_row,n}return Object(m.a)(t,e),t}(D),F=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).type=void 0,n.limitedTo=void 0,n.effects=void 0,n.type=e.type,n.limitedTo=new Set(e.limitation),n.effects={speed:S.fromFloat((e.effect.speed||{bonus:0}).bonus),productivity:S.fromFloat((e.effect.productivity||{bonus:0}).bonus),consumption:S.fromFloat((e.effect.consumption||{bonus:0}).bonus),pollution:S.fromFloat((e.effect.pollution||{bonus:0}).bonus)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canUseWith",value:function(e){return 0===this.limitedTo.size||this.limitedTo.has(e.name)}}]),t}(q),T=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).type="generic",n}return Object(m.a)(t,e),t}(q),G=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).default_temperature=void 0,n.type="fluid",n.default_temperature=e.default_temperature,n}return Object(m.a)(t,e),t}(q),B=function e(t){Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,this.amount=S.fromFloat(t.amount)},L=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",r.item=void 0,r.item=n.itemMap[e.name],r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}}]),t}(B),A=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",r.item=void 0,r.minimum_temperature=void 0,r.maximum_temperature=void 0,r.item=n.fluidMap[e.name],r.minimum_temperature=e.minimum_temperature||-1/0,r.maximum_temperature=e.maximum_temperature||1/0,r.maximum_temperature>=1797e305&&(r.maximum_temperature=1/0),r.minimum_temperature<=-1797e305&&(r.minimum_temperature=-1/0),r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e=this.minimum_temperature,t=this.maximum_temperature,n="";return e!==-1/0&&t!==1/0?n=" (".concat(e,"\xb0 \u2013 ").concat(t,"\xb0)"):t!==1/0?n=" (\u2264 ".concat(t,"\xb0)"):e!==-1/0&&(n=" (\u2265 ".concat(t,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(n)}}]),t}(B),W=function e(t){var n;Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,n="amount"in t?S.fromFloat(t.amount):S.fromInts(t.amount_min+t.amount_max,2),"number"==typeof t.probability&&(0===t.probability?n=S.zero:1!==t.probability&&(E(t.probability>0),E(t.probability<1),n=n.mul(S.fromFloat(t.probability)))),this.amount=n},U=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",r.item=void 0,r.item=n.itemMap[e.name],r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}},{key:"satisfies",value:function(e){return"item"===e.type&&e.item===this.item}}]),t}(W),z=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",r.item=void 0,r.temperature=void 0,r.item=n.fluidMap[e.name],r.item||console.error("could not find item",e),r.temperature=e.temperature||r.item.default_temperature,r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e="";return this.temperature!==this.item.default_temperature&&(e=" (".concat(this.temperature,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(e)}},{key:"satisfies",value:function(e){return"fluid"===e.type&&e.item===this.item&&e.maximum_temperature>=this.temperature&&e.minimum_temperature<=this.temperature}}]),t}(W),H=function(e){function t(e,n){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).category=void 0,r.ingredients=void 0,r.products=void 0,r.crafting_time=void 0,r.madeIn=[],r.name=e.name,r.category=e.category,r.crafting_time=S.fromFloat(e.energy_required),r.ingredients=e.ingredients.map((function(e){return"fluid"===e.type?new A(e,n):new L(e,n)})),r.products=e.results.map((function(e){return"fluid"===e.type?new z(e,n):new U(e,n)})),r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return this.products.length>1?Object(O.a)(Object(l.a)(t.prototype),"niceName",this).call(this):this.products[0].amount.equal(S.one)?this.products[0].item.niceName():this.products[0].niceName()}}]),t}(D),K=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canBuildRecipe",value:function(e){return-1!==this.data.crafting_categories.indexOf(e.category)}}]),t}(function(){function e(t){Object(c.a)(this,e),this.data=void 0,this.data=t}return Object(s.a)(e,[{key:"niceName",value:function(){return this.data.localised_name.en}}]),e}()),Q=function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=c.data.crafting_categories[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;t.hasOwnProperty(d)||(t[d]=[]),t[d].push(c)}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){r=!0,a=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t},V=function(){function e(t){var n=this;Object(c.a)(this,e),this.raw=void 0,this.items=[],this.itemMap={},this.fluids=[],this.fluidMap={},this.modules=[],this.moduleMap={},this.recipes=[],this.recipeMap={},this.entities=[],this.entityMap={},this.categoryMap=void 0,console.groupCollapsed("Game data processing"),this.raw=t;var r=function(e,t){var r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value,u=new t(s);n.entityMap[s.name]=u,n.entities.push(u)}}catch(l){a=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}};for(var a in r(j(t["assembling-machine"]),K),r(j(t.furnace),K),r(j(t["rocket-silo"]),K),t.items){var i=t.items[a];if("type"in i&&"fluid"===i.type){var o=new G(i);this.fluids.push(o),this.fluidMap[o.name]=o}else if("type"in i&&"module"===i.type){var s=new F(i);this.items.push(s),this.itemMap[s.name]=s,this.modules.push(s),this.moduleMap[s.name]=s}else{var u=new T(i);this.items.push(u),this.itemMap[u.name]=u}}for(var l in t.recipes){var m=new H(t.recipes[l],this);for(var p in this.entityMap){var d=this.entityMap[p];"canBuildRecipe"in d&&d.canBuildRecipe(m)&&m.madeIn.push(d)}if(m.madeIn.length)if(m.products.some((function(e){return e.amount.isPositive()}))){this.recipeMap[m.name]=m,this.recipes.push(m);var h=!0,f=!1,v=void 0;try{for(var y,b=m.ingredients[Symbol.iterator]();!(h=(y=b.next()).done);h=!0){y.value.item.usedBy.push(m)}}catch(C){f=!0,v=C}finally{try{h||null==b.return||b.return()}finally{if(f)throw v}}var g=!0,O=!1,E=void 0;try{for(var w,k=m.products[Symbol.iterator]();!(g=(w=k.next()).done);g=!0){w.value.item.madeBy.push(m)}}catch(C){O=!0,E=C}finally{try{g||null==k.return||k.return()}finally{if(O)throw E}}}else console.debug("Ignoring void recipe",m.name,m);else console.warn("Ignoring uncraftable recipe",m.name,m)}this.categoryMap=Q(this.entities),console.log("Processed ".concat(this.items.length," items")),console.log("Processed ".concat(this.fluids.length," fluids")),console.log("Processed ".concat(this.recipes.length," recipes")),console.log("Processed ".concat(this.entities.length," entities")),console.groupEnd()}return Object(s.a)(e,[{key:"getItemOrder",value:function(e){var t="",n="",r=this.raw.groups[e.raw.group];return r&&(t=r.order,n=r.subgroups[e.raw.subgroup]||""),[t,n,e.raw.order,e.raw.name]}},{key:"sortByItem",value:function(e,t){var n=this;e.sort((function(e,r){var a=n.getItemOrder(t(e)),i=n.getItemOrder(t(r));for(var o in a){var c=a[o],s=i[o];if(c>s)return 1;if(c<s)return-1}return 0}))}}]),e}(),J=n(43),Z=n(27),Y=n(97);function $(e,t){var n,r=e instanceof H?e.category:e;return n=r in t.settings.assemblerOverrides?t.settings.assemblerOverrides[r]:t.gameData.categoryMap[r][0],e instanceof H&&E(-1!==e.madeIn.indexOf(n)),n}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(n,!0).forEach((function(t){Object(Z.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te={gameData:{fakeGameData:!0},groups:[{name:"Factory 1",rows:[]}],settings:{assemblerOverrides:{}},activeGroupIdx:0,recipeTarget:void 0};function ne(e){return e.groups[e.activeGroupIdx]}function re(e,t){var n=e.groups.map((function(n,r){return r===e.activeGroupIdx?ee({},n,{},t):n}));return ee({},e,{groups:n})}var ae=Object(Y.a)(te)({replaceState:function(e){return function(t){return ee({},t,{},e)}},addRow:function(e){return function(t){var n=ne(t);if(!n.rows.some((function(t){return t.recipe.name===e.recipe.name})))return re(t,{rows:[].concat(Object(J.a)(n.rows),[e])})}},updateRow:function(e,t){return function(n){var r=ne(n),a=Array.from(r.rows);return a[e]=ee({},r.rows[e],{},t),re(n,{rows:a})}},removeRow:function(e){return function(t){var n=ne(t),r=Array.from(n.rows);return r.splice(e,1),re(t,{rows:r})}},moveRow:function(e,t){return function(n){var r=ne(n),a=Array.from(r.rows),i=a.splice(e,1),o=Object(v.a)(i,1)[0];return a.splice(t,0,o),re(n,{rows:a})}},updateDefaultMachine:function(e,t){return function(n){var r=$(e,n),a=n.groups.map((function(n){var a=n.rows.map((function(n){return n.recipe.category!==e||n.machine!==r?n:ee({},n,{machine:t})}));return ee({},n,{rows:a})}));return ee({},n,{groups:a,settings:ee({},n.settings,{assemblerOverrides:ee({},n.settings.assemblerOverrides,Object(Z.a)({},e,t))})})}},setActiveGroup:function(e){return function(t){return ee({},t,{activeGroupIdx:e})}},addGroup:function(e){return function(t){return ee({},t,{groups:[].concat(Object(J.a)(t.groups),[{name:e,rows:[]}]),activeGroupIdx:t.groups.length})}},renameGroup:function(e,t){return function(n){var r=Object(J.a)(n.groups);return r[e]=ee({},r[e],{name:t}),ee({},n,{groups:r})}},removeGroup:function(e){return function(t){var n=Object(J.a)(t.groups);n.splice(e,1),n.length||n.push({name:"Factory 1",rows:[]});var r=n.length-1;return ee({},t,{groups:n,activeGroupIdx:Math.min(t.activeGroupIdx,r)})}},setRecipeTarget:function(e){return function(t){return ee({},t,{recipeTarget:e})}}}),ie=Object(v.a)(ae,2),oe=ie[0],ce=ie[1],se=function(e){return function(t){var n=ce(),r=Object(v.a)(n,2),a=r[0],o=r[1];return i.a.createElement(e,Object.assign({state:a,actions:o},t))}},ue=function(e){return function(t){var n=ce(),r=Object(v.a)(n,1)[0];return i.a.createElement(e,Object.assign({gameData:r.gameData},t))}},le=n(66);function me(e){return{name:e.name,rows:e.rows.map((function(e){return[e[0],e[1],e[2].toString(),e[3],e[4],e[5]]}))}}function pe(e){var t=localStorage.getItem("appstate");if(!t)return null;var n=JSON.parse(t);return 1===n.version&&(n.version=3),ye(e,n)}function de(e){return{version:5,data:{groups:e.groups.map((function(t){return{name:t.name,rows:t.rows.map((function(t){var n=t.machine.data.name;return $(t.recipe,e).data.name===n&&(n=null),[t.recipe.name,n,t.numMachines.toFraction(),t.modules.map((function(e){return e?e.name:null})),t.beaconModule?t.beaconModule.name:void 0,t.numBeacons]}))}})),settings:{assemblerOverrides:w(e.settings.assemblerOverrides,(function(e){return e.data.name}))}}}}var he=/^#(\d+)?(?:-)?(.+)$/;function fe(e){var t=he.exec(document.location.hash);if(!t)return null;var n=Number(t[1]||1),r=decodeURIComponent(t[2]);return n>2&&(r=Object(le.inflate)(atob(r),{to:"string"})),ye(e,{version:n,data:JSON.parse(r)})}function ve(e){switch(e.version){case 1:e=function(e){return{version:2,data:{rows:e.data,settings:{assemblerOverrides:{}}}}}(e);case 2:e=function(e){return{version:3,data:e.data}}(e);case 3:e=function(e){return{version:4,data:{settings:e.data.settings,groups:[{name:"Factory 1",rows:e.data.rows}]}}}(e);case 4:e=function(e){return{version:5,data:{settings:e.data.settings,groups:e.data.groups.map(me)}}}(e);case 5:break;default:throw new Error("unknown state: ".concat(e))}return e}function ye(e,t){var n=ve(t).data,r={gameData:e,settings:be(e,n.settings),groups:[],activeGroupIdx:0,recipeTarget:void 0};return r.groups=n.groups.map((function(t){return{name:t.name,rows:t.rows.map((function(t){var n=Object(v.a)(t,6),a=n[0],i=n[1],o=n[2],c=n[3],s=n[4],u=n[5],l=e.recipeMap[a];return{recipe:l,machine:i?e.entityMap[i]:$(l,r),numMachines:S.fromString(o),modules:c.map((function(t){return t?e.moduleMap[t]:null})),beaconModule:s?e.moduleMap[s]:null,numBeacons:u||0}}))}})),r}function be(e,t){return{assemblerOverrides:w(t.assemblerOverrides,(function(t){return e.entityMap[t]}))}}var ge=n(9),Oe=n.n(ge),Ee=n(56),we=n(115),je=n(22),ke=n(71),Ce=n(33),Ne=n(113),Se=n(42),xe=n(41),Me=function(){function e(){var t=this;Object(c.a)(this,e),this.handlers=[],this.dispatch=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.handlers[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(e)}}catch(c){r=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}return Object(s.a)(e,[{key:"addHandler",value:function(e){-1===this.handlers.indexOf(e)&&this.handlers.push(e)}},{key:"removeHandler",value:function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}}]),e}(),_e=new Me,Ie=new Me,Re=new Me,Pe=n(28),De=27,qe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).buttonRef=void 0,n.handleToggle=function(){n.setState({isOpen:!n.state.isOpen})},n.handleSelect=function(e){n.props.onSelect(e),n.state.isOpen&&n.setState({isOpen:!1})},n.handleWantClose=function(){n.state.isOpen&&n.setState({isOpen:!1})},n.state={isOpen:!1},n.buttonRef=a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.options.some((function(e){return"option"in e&&!e.disabled})),r=["btn","btn-secondary"];return n?r.push("dropdown-toggle"):r.push("disabled"),this.state.isOpen&&(e=a.createElement(Fe,{parentRef:this.buttonRef,options:this.props.options,renderOption:this.props.renderOption,onSelect:this.handleSelect,onWantClose:this.handleWantClose})),a.createElement(a.Fragment,null,a.createElement("button",{ref:this.buttonRef,className:r.join(" "),type:"button",onClick:function(){n&&t.handleToggle()}},this.props.renderSelected(this.props.selected)),e)}}]),t}(a.Component),Fe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).popperInstance=null,n.menuRef=void 0,n.popperUpdate=function(e){return n.setState({style:e.styles}),e},n.handleBodyClick=function(e){if(!n.menuRef.current)throw new Error("Click event without menu rendered. This should not happen.");if(!e.target)throw new Error("Click event without click target. This should not happen.");var t=e.target;n.menuRef.current.contains(t)||n.props.onWantClose()},n.handleKeyEvent=function(e){e.keyCode===De&&n.props.onWantClose()},n.renderOptions=function(){return n.props.options.map((function(e,t){if("header"in e)return a.createElement("h6",{className:"dropdown-header",key:"ddkey"+t},e.header);if("divider"in e)return a.createElement("div",{className:"dropdown-divider",key:"ddkey"+t});var r=["dropdown-item"];return e.active&&r.push("active"),e.disabled&&r.push("disabled"),a.createElement("button",{key:e.key,className:r.join(" "),onClick:function(){return n.props.onSelect(e.option)},type:"button"},n.props.renderOption(e.option))}))},n.menuRef=a.createRef(),n.state={style:{}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.popperInstance)throw new Error("Component mounted twice?");var e=this.props.parentRef.current;if(!e)throw new Error("Cannot mount DropdownMenu without parentRef");var t=this.menuRef.current;if(!t)throw new Error("Cannot mount DropdownMenu without menuRef");this.popperInstance=new Pe.a(e,t,{modifiers:{applyStyle:{enabled:!1},updateStateWithStyle:{enabled:!0,fn:this.popperUpdate}}}),document.body.addEventListener("click",this.handleBodyClick),document.body.addEventListener("keyup",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null),document.body.removeEventListener("click",this.handleBodyClick),document.body.removeEventListener("keyup",this.handleKeyEvent)}},{key:"render",value:function(){return a.createElement("div",{className:"dropdown-menu show",style:this.state.style,ref:this.menuRef},this.renderOptions())}}]),t}(a.Component),Te=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).selfRef=void 0,n.popperInstance=void 0,n.handleMouseEnter=function(){n.setState({showSelf:!0})},n.handleMouseLeave=function(){n.setState({showSelf:!1})},n.selfRef=a.createRef(),n.popperInstance=null,n.state={showSelf:!1,style:{zIndex:1001}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"initPopper",value:function(){if(!this.popperInstance){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");var t=this.selfRef.current;if(!t)throw new Error("No self reference yet?");this.popperInstance=new Pe.a(e,t,{placement:"right",modifiers:{offset:{enabled:!0,offset:"0, 20"},preventOverflow:{enabled:!0,boundariesElement:"window"}}})}}},{key:"cleanupPopper",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null)}},{key:"componentDidUpdate",value:function(e,t){t.showSelf!==this.state.showSelf&&(this.state.showSelf?this.initPopper():this.cleanupPopper())}},{key:"componentDidMount",value:function(){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");e.addEventListener("mouseenter",this.handleMouseEnter),e.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"componentWillUnmount",value:function(){var e=this.props.relativeTo.current;e&&(e.removeEventListener("mouseenter",this.handleMouseEnter),e.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"render",value:function(){return this.state.showSelf?o.createPortal(a.createElement("div",{style:this.state.style,ref:this.selfRef},this.props.children),document.body):null}}]),t}(a.Component),Ge=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;if(n.setState({txtValue:t}),t.trim()){var r=Number(t);n.props.intOnly&&!Number.isInteger(r)||n.props.positiveOnly&&r<0||n.props.onChange(r)}},n.state={txtValue:e.value.toString()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.createElement("input",{className:"form-control",value:this.state.txtValue,onChange:this.handleChange,type:"number",min:"0",step:"1"})}}]),t}(a.PureComponent),Be=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;if(n.setState({txtValue:t,error:void 0}),t.trim())if(t.indexOf("/")===t.lastIndexOf("/")){var r;try{r=S.fromString(t)}catch(a){return void n.setState({error:a.message})}n.props.positiveOnly&&r.isNegative()?n.setState({error:"Number must be positive"}):n.props.onChange(r)}else n.setState({error:"Too many slashes"})},n.state={txtValue:e.value.toDecimal()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e="form-control";return this.state.error&&(e+=" is-invalid"),a.createElement("input",{className:e,value:this.state.txtValue,onChange:this.handleChange,type:"text"})}}]),t}(a.PureComponent),Le=n(98),Ae=n.n(Le);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ue=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).iconRef=void 0,n.iconRef=i.a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=32*-this.props.obj.icon_col,t=32*-this.props.obj.icon_row,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(n,!0).forEach((function(t){Object(Z.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:"inline-block",backgroundPosition:"".concat(e,"px ").concat(t,"px"),width:"32px",height:"32px"},this.props.style),r=i.a.createElement("div",{ref:this.iconRef,onClick:this.props.onClick,title:this.props.title,className:Oe()(Ae.a.Icon,"game-icon"),style:n},"\xa0");return this.props.tooltip&&(r=i.a.createElement(i.a.Fragment,null,r,i.a.createElement(Te,{children:this.props.tooltip,relativeTo:this.iconRef}))),this.props.text&&(r=i.a.createElement("div",{style:{lineHeight:"32px"}},r,i.a.createElement("span",{style:{marginLeft:"9px"}},this.props.text))),r}}]),t}(i.a.PureComponent),ze=function(e){return a.createElement("div",{className:"machine-card card"},a.createElement("div",{className:"card-body"},a.createElement("b",null,e.machine.niceName()),a.createElement("br",null),a.createElement("b",null,"Crafting Speed:")," ",e.machine.data.crafting_speed,a.createElement("br",null),a.createElement("b",null,"Module Slots:")," ",e.machine.data.module_slots))},He=ue((function(e){var t=e.recipe,n=t.ingredients.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,text:e.niceName()})})),r=t.products.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,text:e.niceName()})})),i=t.madeIn.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.data,tooltip:a.createElement(ze,{machine:e})})}));return a.createElement("div",{className:"recipe-tooltip card",onClick:function(){e.onClick&&e.onClick(e.recipe)}},a.createElement("div",{className:"card-header"},a.createElement(Ue,{obj:t,text:t.niceName()})),a.createElement("div",{className:"card-body"},a.createElement(Ue,{obj:e.gameData.raw.sprites.extra.clock,text:t.crafting_time.toDecimal()}),a.createElement("div",{style:{float:"left"}},"Ingredients:",n),a.createElement("div",{style:{display:"inline-block"}},"Products:",r),a.createElement("div",{style:{clear:"both"}}),a.createElement("div",{style:{lineHeight:"32px"}},"Made In:",i)))})),Ke=function(e){return a.createElement(Ue,{obj:e.data,tooltip:a.createElement(ze,{machine:e})})},Qe=function(e){return a.createElement(Ue,{obj:e.data,tooltip:a.createElement(ze,{machine:e}),text:e.niceName()})},Ve=function(e){var t=e.machines.map((function(t){return{key:t.data.name,option:t,active:t===e.selected}}));return a.createElement(qe,{options:t,selected:e.selected,onSelect:e.onChange,renderOption:Qe,renderSelected:Ke})},Je={consumption:"Energy Consumption",productivity:"Productivity",speed:"Speed",pollution:"Pollution"},Ze=function(e){var t=e.module,n=[];for(var r in t.raw.effect){var i=t.raw.effect[r].bonus;n.push(a.createElement("div",{key:r},a.createElement("b",null,Je[r],":"," ",C(100*i,2),"%")))}return a.createElement("div",{className:"module-card card"},a.createElement("div",{className:"card-header"},a.createElement("b",null,t.niceName())),a.createElement("div",{className:"card-body"},n))},Ye=ue((function(e){var t=e.gameData.raw.sprites.extra.slot_icon_module,n=new F({type:"module",name:"no_module",localised_name:{en:"No Module"},category:"speed",effect:{},limitation:[],rocket_launch_products:[],icon_row:t.icon_row,icon_col:t.icon_col,group:"",subgroup:"",order:""}),r=e.gameData.modules.filter((function(t){return(!e.isBeacon||!t.effects.productivity.isPositive())&&t.canUseWith(e.recipe)})).map((function(t){return{key:t.name,option:t,active:t===e.selected}}));return r.unshift({key:"no_module",option:null,active:!e.selected}),a.createElement(qe,{options:r,selected:e.selected,onSelect:e.onChange,renderOption:function(e){return e?a.createElement(Ue,{obj:e,tooltip:a.createElement(Ze,{module:e}),text:e.niceName()}):a.createElement(Ue,{obj:n,text:n.niceName()})},renderSelected:function(e){return e?a.createElement(Ue,{obj:e,tooltip:a.createElement(Ze,{module:e})}):a.createElement(Ue,{obj:n})}})})),$e=function(){function e(){var t=this;Object(c.a)(this,e),this.products=[],this.ingredients=[],this.addIngredient=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.ingredients[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.maximum_temperature===c.maximum_temperature&&e.minimum_temperature===c.minimum_temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){r=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}t.ingredients.push(e)},this.addProduct=function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=t.products[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.temperature===c.temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){r=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}t.products.push(e)}}return Object(s.a)(e,[{key:"addRow",value:function(e){var t={consumption:S.one,pollution:S.one,productivity:S.one,speed:S.one},n=!0,r=!1,a=void 0;try{for(var i,o=e.modules[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;c&&(t.consumption=t.consumption.add(c.effects.consumption),t.pollution=t.pollution.add(c.effects.pollution),t.productivity=t.productivity.add(c.effects.productivity),t.speed=t.speed.add(c.effects.speed))}}catch(p){r=!0,a=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(e.beaconModule&&e.numBeacons>0){var s=e.beaconModule.effects,u=S.fromInts(e.numBeacons,2);t.consumption=t.consumption.add(s.consumption.mul(u)),t.pollution=t.pollution.add(s.pollution.mul(u)),t.productivity=t.productivity.add(s.productivity.mul(u)),t.speed=t.speed.add(s.speed.mul(u))}t.consumption=t.consumption.clamp(.2,32767),t.pollution=t.pollution.clamp(.2,32767),t.speed=t.speed.clamp(.2,32767),t.productivity=t.productivity.clamp(1,32767);var l=S.one.mul(e.recipe.crafting_time.invert()).mul(e.numMachines).mul(e.machine.data.crafting_speed).mul(t.speed),m=l.mul(t.productivity);e.recipe.ingredients.map((function(e){return(e=k(e)).amount=e.amount.mul(l),e})).forEach(this.addIngredient),e.recipe.products.map((function(e){return(e=k(e)).amount=e.amount.mul(m),e})).forEach(this.addProduct)}},{key:"reduce",value:function(){var e=this.ingredients.map(k),t=this.products.map(k),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=e[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;c.amount.isZero()||d.amount.isZero()||c.satisfies(d)&&(c.amount.less(d.amount)?(d.amount=d.amount.sub(c.amount),c.amount=S.zero):d.amount.less(c.amount)?(c.amount=c.amount.sub(d.amount),d.amount=S.zero):(d.amount=S.zero,c.amount=S.zero))}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){r=!0,a=h}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return{ingredients:e=e.filter((function(e){return!e.amount.isZero()})),products:t=t.filter((function(e){return!e.amount.isZero()}))}}}]),e}(),Xe=function(e){return a.createElement("div",{className:"card"},a.createElement("div",{className:"card-header"},e.obj.item.niceName()," (",e.obj.name,")"))},et=se(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleRemoveClick=function(){n.props.actions.removeRow(n.props.index)},n.handleMachineChange=function(e){n.applyChange({machine:e,modules:n.props.modules.filter((function(e){return null!==e})).slice(0,e.data.module_slots)})},n.handleNumMachinesChange=function(e){n.applyChange({numMachines:e})},n.handleNumBeaconsChange=function(e){n.applyChange({numBeacons:e})},n.handleSetAllModules=function(){n.applyChange({modules:new Array(n.props.machine.data.module_slots).fill(n.props.modules[0])})},n.handleSetModule=function(e,t){var r=n.props.modules.slice();r[e]=t,n.applyChange({modules:r})},n.handleSetBeaconModule=function(e){n.applyChange({beaconModule:e})},n.handleIngredientClick=function(e,t){if(t.shiftKey)return t.preventDefault(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.madeBy.length?Re.dispatch(e.item.madeBy[0]):_e.dispatch(e)},n.handleProductClick=function(e,t){if(t.shiftKey)return t.preventDefault(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.usedBy.length?Re.dispatch(e.item.usedBy[0]):Ie.dispatch(e)},n.handleInputGroupClick=function(e){var t=n.props.state.recipeTarget;if(e.shiftKey&&t){e.preventDefault();var r,a=n.getOutput();if(r=(r=a.ingredients.find((function(e){return e.item.name===t.item.name})))||a.products.find((function(e){return e.item.name===t.item.name}))){var i=t.amount.div(r.amount).mul(n.props.numMachines);n.applyChange({numMachines:i})}else console.error("Could not find ".concat(t.item.name," in totals"),a)}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"applyChange",value:function(e){this.props.actions.updateRow(this.props.index,e)}},{key:"getOutput",value:function(){var e=new $e;return e.addRow(this.props),{ingredients:e.ingredients,products:e.products}}},{key:"renderModules",value:function(){for(var e=this,t=this.props.machine.data.module_slots,n=[],r=function(t){var r=e.props.modules[t];n.push(a.createElement(Ye,{key:t,recipe:e.props.recipe,selected:r,onChange:function(n){return e.handleSetModule(t,n)}}))},i=0;i<t;i++)r(i);return t>1&&n.splice(1,0,a.createElement("button",{onClick:this.handleSetAllModules,key:"applicator",className:"btn"},"\u2192")),n}},{key:"renderBeacons",value:function(){return a.createElement("div",{className:"btn-toolbar mb-3"},a.createElement("div",{className:"input-group"},a.createElement("div",{className:"input-group-prepend"},a.createElement("span",{className:"input-group-text"},"Beacon Modules")),a.createElement(Ge,{value:this.props.numBeacons,onChange:this.handleNumBeaconsChange,positiveOnly:!0,intOnly:!0}),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(Ye,{isBeacon:!0,recipe:this.props.recipe,selected:this.props.beaconModule,onChange:this.handleSetBeaconModule}))))}},{key:"renderMachines",value:function(){return a.createElement("div",{className:"btn-toolbar mb-3"},a.createElement("div",{className:"input-group",onClick:this.handleInputGroupClick},a.createElement(Be,{key:this.props.numMachines.toFraction(),value:this.props.numMachines,onChange:this.handleNumMachinesChange,positiveOnly:!0}),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(Ve,{machines:this.props.recipe.madeIn,selected:this.props.machine,onChange:this.handleMachineChange}))))}},{key:"render",value:function(){var e=this,t=this.props.recipe,n=this.getOutput(),r=n.ingredients.map((function(t,n){return a.createElement("div",{className:"mb-1",key:n},a.createElement(Ue,{onClick:e.handleIngredientClick.bind(null,t),tooltip:a.createElement(Xe,{obj:t}),obj:t.item,text:"".concat(t.amount.toDecimal()," / sec")}))})),i=n.products.map((function(t,n){return a.createElement("div",{className:"mb-1",key:n},a.createElement(Ue,{onClick:e.handleProductClick.bind(null,t),tooltip:a.createElement(Xe,{obj:t}),obj:t.item,text:"".concat(t.amount.toDecimal()," / sec")}))}));return a.createElement(xe.b,{draggableId:t.name,index:this.props.index},(function(n){return a.createElement("div",Object.assign({className:"recipe-row card mb-3",ref:n.innerRef},n.draggableProps),a.createElement("div",Object.assign({className:"card-header"},n.dragHandleProps),a.createElement("div",{style:{float:"left"}},a.createElement(Ue,{obj:t,text:t.niceName(),tooltip:a.createElement(He,{recipe:t})})),a.createElement("div",{style:{float:"right"}},a.createElement(Ce.a,{variant:"danger",onClick:e.handleRemoveClick,size:"sm"},"Remove")),a.createElement("div",{style:{clear:"both"}})),a.createElement("div",{className:"card-body"},a.createElement("div",{style:{float:"left"}},e.renderMachines(),a.createElement("div",{className:"mb-3 btn-group btn-icon-wrapper"},e.renderModules()),e.renderBeacons()),a.createElement("div",{style:{float:"right"}},a.createElement("div",{className:"mr-3",style:{display:"inline-block",float:"left",minWidth:"150px"}},a.createElement("b",null,"Ingredients:"),r),a.createElement("div",{className:"mr-2",style:{display:"inline-block",minWidth:"150px"}},a.createElement("b",null,"Products:"),i)),a.createElement("div",{style:{clear:"both"}})))}))}}]),t}(a.Component)),tt=n(50),nt=n(105),rt=n.n(nt),at=n(106),it=n.n(at),ot=n(70),ct=n.n(ot);function st(e,t){switch(t){case"niceName":return e.niceName();case"name":return e.name}}var ut=/((?:produces)|(?:consumes)):([a-z0-9-]+)/g,lt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleIngredientClick=function(e){var t="produces:".concat(e.name);n.state.query.includes(t)||n.setQuery("".concat(n.state.query," ").concat(t),(function(){n.calculateMatches()}))},n.handleProductClick=function(e){var t="consumes:".concat(e.name);n.state.query.includes(t)||n.setQuery("".concat(n.state.query," ").concat(t),(function(){n.calculateMatches()}))},n.handleQueryInput=function(e){var t=e.target;n.setQuery(t.value)},n.handleRecipeClick=function(e){n.props.onPickRecipe(e),n.setQuery("")},n.setQuery=function(e,t){e.trim()?(n.setState({query:e},t),n.debCalculateMatches()):(n.debCalculateMatches.cancel(),n.setState({query:"",matches:[]},t))},n.debCalculateMatches=it()(n.calculateMatches.bind(Object(tt.a)(n)),200),n.state={query:"",matches:[]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){_e.addHandler(this.handleIngredientClick),Ie.addHandler(this.handleProductClick)}},{key:"componentWillUnmount",value:function(){this.debCalculateMatches.cancel(),_e.removeHandler(this.handleIngredientClick),Ie.removeHandler(this.handleProductClick)}},{key:"calculateMatches",value:function(){var e=this.state.query.trim().toLowerCase();if(e){var t={consumes:[],produces:[]};e=e.replace(ut,(function(e,n,r){return t[n].push(r),""})).trim();var n=this.props.recipes;if((t.consumes.length||t.produces.length)&&(n=n.filter((function(e){var n=!0,r=!1,a=void 0;try{for(var i,o=function(){var t=i.value;if(!e.ingredients.some((function(e){return e.name===t})))return{v:!1}},c=t.consumes[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var s=o();if("object"===typeof s)return s.v}}catch(v){r=!0,a=v}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}var u=!0,l=!1,m=void 0;try{for(var p,d=function(){var t=p.value;if(!e.products.some((function(e){return e.name===t})))return{v:!1}},h=t.produces[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var f=d();if("object"===typeof f)return f.v}}catch(v){l=!0,m=v}finally{try{u||null==h.return||h.return()}finally{if(l)throw m}}return!0}))),e)n=new rt.a(n,{shouldSort:!0,getFn:st,keys:[{name:"niceName",weight:.7},{name:"name",weight:.2}]}).search(e);this.setState({matches:n})}else this.setState({matches:[]})}},{key:"renderMatches",value:function(){var e=this;if(!this.state.matches.length)return"";var t=this.state.matches;return t.length>100&&(t=t.slice(0,100)),a.createElement("table",{className:"table table-hover"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Recipe"),a.createElement("th",null,"Time"),a.createElement("th",null,"Ingredients"),a.createElement("th",null,"Products"))),a.createElement("tbody",null,t.map((function(t){return a.createElement(pt,{recipe:t,key:t.name,onClick:e.handleRecipeClick})}))))}},{key:"render",value:function(){return a.createElement("div",{className:ct.a.RecipePicker},a.createElement("div",null,a.createElement("input",{className:"editable-display form-control",placeholder:"What do you want to build?",value:this.state.query,onChange:this.handleQueryInput})),this.renderMatches())}}]),t}(a.PureComponent);function mt(e){return a.createElement("div",{className:"card"},a.createElement("div",{className:"card-body"},e))}var pt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleClickAdd=function(){n.props.onClick(n.props.recipe)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.recipe,t=e.ingredients.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,tooltip:mt(e.niceName())})})),n=e.products.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,tooltip:mt(e.niceName())})}));return a.createElement("tr",{onClick:this.handleClickAdd},a.createElement("td",{className:ct.a.ResultName},a.createElement(Ue,{obj:e,text:e.niceName()})),a.createElement("td",null,e.crafting_time.toDecimal()),a.createElement("td",null,t),a.createElement("td",null,n))}}]),t}(a.PureComponent),dt=n(107),ht=n.n(dt);var ft,vt=ue((function(e){var t=new $e,n=!0,r=!1,i=void 0;try{for(var o,c=e.rows[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;t.addRow(s)}}catch(p){r=!0,i=p}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}var u=t.reduce(),l=u.ingredients,m=u.products;return l.length||m.length?(e.gameData.sortByItem(m,(function(e){return e.item})),a.createElement("div",{className:"card ".concat(ht.a.TotalCard)},a.createElement("div",{className:"card-header"},"Combined Totals"),a.createElement("div",{className:"card-body"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col"},"Ingredients:",l.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,text:e.niceName()})}))),a.createElement("div",{className:"col"},"Products:",m.map((function(e,t){return a.createElement(Ue,{key:t,obj:e.item,text:e.niceName()})})))))))):a.createElement("div",null)})),yt=n(108),bt=n.n(yt),gt=se(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).handlePickRecipe=function(e){n.props.actions.addRow({recipe:e,machine:$(e,n.props.state),numMachines:S.one,modules:[],beaconModule:null,numBeacons:0})},n.handleDragEnd=function(e){e.destination&&n.props.actions.moveRow(e.source.index,e.destination.index)},n.renderRow=function(e,t){return a.createElement(et,Object.assign({key:e.recipe.name,index:t},e))},n.handleClickRename=function(){var e=n.props.state.activeGroupIdx,t=prompt("Whatcha wanna call it now?",n.props.state.groups[e].name);t&&n.props.actions.renameGroup(e,t)},n.handleClickDelete=function(){var e=n.props.state.activeGroupIdx,t=n.props.state.groups[e];window.confirm("Are you sure you want to delete ".concat(t.name))&&n.props.actions.removeGroup(e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){Re.addHandler(this.handlePickRecipe)}},{key:"componentWillUnmount",value:function(){Re.removeHandler(this.handlePickRecipe)}},{key:"render",value:function(){var e=this,t=this.props.state.gameData.recipes.filter((function(t){return!e.props.group.rows.some((function(e){return e.recipe===t}))}));return a.createElement("div",{className:bt.a.RecipeGroup},a.createElement("div",{className:"clearfix"},a.createElement("h3",{className:"float-left"},this.props.group.name),a.createElement("div",{className:"float-right"},a.createElement(Se.a,{as:Ne.a,size:"sm"},a.createElement(Ce.a,{variant:"info",onClick:this.handleClickRename},"Rename"),a.createElement(Se.a.Toggle,{split:!0,variant:"info",id:"button-split"}),a.createElement(Se.a.Menu,null,a.createElement(Se.a.Item,{onClick:this.handleClickDelete},"Delete"))))),a.createElement(lt,{recipes:t,onPickRecipe:this.handlePickRecipe}),a.createElement("hr",null),a.createElement(xe.a,{onDragEnd:this.handleDragEnd},a.createElement(xe.c,{droppableId:"eyy"},(function(t){return a.createElement("div",Object.assign({ref:t.innerRef},t.droppableProps),e.props.group.rows.map(e.renderRow),t.placeholder)}))),a.createElement("hr",null),a.createElement(vt,{rows:this.props.group.rows}))}}]),t}(a.Component)),Ot=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.entries(this.props.gameData.categoryMap).filter((function(e){return e[1].length>1})).map((function(e){return e[0]}));return e.sort((function(e,t){return e.localeCompare(t)})),a.createElement("div",null,a.createElement("h3",null,"Default Assemblers"),e.map((function(e){return a.createElement(Et,{key:e,category:e})})))}}]),t}(a.Component),Et=se(function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).handleChange=function(e){n.props.actions.updateDefaultMachine(n.props.category,e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.state.gameData.categoryMap[this.props.category],t=$(this.props.category,this.props.state);return a.createElement("div",{className:"btn-toolbar mb-3",key:this.props.category},a.createElement("div",{className:"input-group"},a.createElement("div",{className:"input-group-prepend"},a.createElement("span",{className:"input-group-text"},this.props.category)),a.createElement("div",{className:"input-group-append btn-icon-wrapper"},a.createElement(Ve,{machines:e,selected:t,onChange:this.handleChange}))))}}]),t}(a.Component)),wt=ue(Ot),jt=n(114),kt=n.n(jt);!function(e){e.Factory="FACTORY",e.Settings="SETTINGS"}(ft||(ft={}));var Ct=se(function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleKeyDown=function(e){"Shift"===e.key&&document.body.classList.add("shift-down")},n.handleKeyUp=function(e){"Shift"===e.key&&document.body.classList.remove("shift-down")},n.handleClickGroup=function(e){n.setState({activePage:ft.Factory}),n.props.actions.setActiveGroup(e)},n.handleClickAddGroup=function(e){e.preventDefault();var t="Factory ".concat(n.props.state.groups.length+1),r=prompt("What do you want to name this group?",t);r&&r.trim()&&n.props.actions.addGroup(r)},n.handleClickSettings=function(){n.setState({activePage:ft.Settings})},n.renderFactory=function(){var e=n.props.state.groups[n.props.state.activeGroupIdx];return i.a.createElement(Ee.a,{fluid:!0},i.a.createElement(gt,{group:e}))},n.renderSettings=function(){return i.a.createElement(Ee.a,{fluid:!0},i.a.createElement(wt,null))},n.state={activePage:ft.Factory},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}},{key:"renderNavbar",value:function(){var e=this,t=this.state.activePage===ft.Settings?"settings":this.props.state.activeGroupIdx,n=this.props.state.groups.map((function(n,r){var a=t===r;return i.a.createElement(je.a.Item,{onClick:function(){return e.handleClickGroup(r)},key:r},i.a.createElement(je.a.Link,{active:a},n.name))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(je.a,{className:"flex-column"},i.a.createElement(je.a.Item,null,i.a.createElement(je.a.Link,{disabled:!0},i.a.createElement("span",{role:"img","aria-label":"Factory icon"},"\ud83c\udfed")," ","Factories")),n,i.a.createElement(je.a.Item,null,i.a.createElement(je.a.Link,{onClick:this.handleClickAddGroup},"Add A Factory")),i.a.createElement(je.a.Item,null,i.a.createElement(je.a.Link,{active:"settings"===t,onClick:this.handleClickSettings},i.a.createElement("span",{role:"img","aria-label":"Gear icon"},"\u2699\ufe0f")," ","Settings"))))}},{key:"render",value:function(){if(!this.props.state.gameData.raw)return null;var e;if(this.state.activePage===ft.Factory)e=this.renderFactory();else{if(this.state.activePage!==ft.Settings)return function(e){throw new Error("Unexpected object: "+e)}(this.state.activePage);e=this.renderSettings()}return i.a.createElement(Ee.a,{fluid:!0},i.a.createElement(we.a,null,i.a.createElement(ke.a,{xs:"2",className:Oe()("bg-primary",kt.a.Sidebar)},this.renderNavbar()),i.a.createElement(ke.a,null,e)))}}]),t}(i.a.Component)),Nt=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={gameData:null},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.load().catch((function(t){e.setState((function(){throw t}))}))}},{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,n,r,a,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("assets/landblock.json");case 2:if(200===(t=e.sent).status){e.next=5;break}throw new Error("Could not load game data, got HTTP status ".concat(t.status));case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),new Error("Could not parse game data: ".concat(e.t0));case 14:r=new V(n),this.props.actions.replaceState({gameData:r}),(a=fe(r))?this.props.actions.replaceState(a):(i=pe(r))&&this.props.actions.replaceState(i),this.setState({gameData:r});case 19:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.state.gameData)return i.a.createElement("h1",null,"Loading...");var e="assets/sprite-sheet-".concat(this.state.gameData.raw.sprites.hash,".png"),t="\n        .game-icon {\n            background-image: url(".concat(e,");\n        }\n        ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(St,null),i.a.createElement(xt,{href:e}),i.a.createElement("style",null,t),i.a.createElement(Ct,null))}}]),t}(i.a.Component),St=function(){var e=ce(),t=Object(v.a)(e,1)[0];return Object(a.useEffect)((function(){!function(e){var t=de(e),n=t.version,r=JSON.stringify(t.data);r=btoa(Object(le.deflate)(r,{to:"string"})),window.history.replaceState("","","#".concat(n,"-").concat(r))}(t),function(e){localStorage.setItem("appstate",JSON.stringify(de(e)))}(t)}),[t]),null},xt=function(e){return o.createPortal(i.a.createElement("link",{rel:"prefetch",href:e.href}),document.head)},Mt=se(Nt);n(195);r.a({dsn:"https://2ab99c1e02a448cbaa06595164416044@sentry.io/1385727"}),o.render(a.createElement(f,null,a.createElement(oe,null,a.createElement(Mt,null))),document.getElementById("root"))},70:function(e,t,n){e.exports={RecipePicker:"RecipePicker_RecipePicker__3sU3V",ResultName:"RecipePicker_ResultName__jSE56"}},93:function(e,t,n){e.exports={crashed:"ErrorCatcher_crashed__3tour"}},98:function(e,t,n){e.exports={Icon:"Icon_Icon__377W-"}}},[[118,1,2]]]);
//# sourceMappingURL=main.9409db9a.chunk.js.map