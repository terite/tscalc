(this.webpackJsonptscalc=this.webpackJsonptscalc||[]).push([[0],{101:function(e,t,n){e.exports={Sidebar:"App_Sidebar__3POeR"}},105:function(e,t,n){e.exports=n(171)},170:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var a=n(175),r=n(0),i=n.n(r),o=n(25),c=n(2),s=n(4),u=n(6),l=n(5),m=n(7),p=n(20),d=n(85),h=n.n(d),f=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={crashMsg:void 0},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidCatch",value:function(e,t){this.crash(["Component Stack:",t.componentStack,"",e&&e.stack].join("\n")),p.b((function(n){Object.keys(t).forEach((function(e){n.setExtra(e,t[e])})),p.a(e)}))}},{key:"crash",value:function(e){this.setState({crashMsg:e})}},{key:"render",value:function(){return"undefined"!==typeof this.state.crashMsg?r.createElement("div",{className:h.a.crashed},r.createElement("h1",null,"Crashed!"),r.createElement("pre",null,this.state.crashMsg)):this.props.children}}]),t}(r.Component),v=n(18),y=n(52),b=n.n(y),g=n(103);function E(e,t){if(!e)throw new Error(t||"Assertion failed")}function O(e,t){var n={};for(var a in e)n[a]=t(e[a]);return n}function w(e){var t=[];for(var n in e)t.push(e[n]);return t}function j(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}function k(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function C(e,t){return E(Number.isSafeInteger(e)),E(Number.isSafeInteger(t)),{quotient:Math.floor(e/t),remainder:e%t}}var N=function(){function e(t,n){Object(c.a)(this,e),this.p=void 0,this.q=void 0,this.toString=void 0,E(Number.isSafeInteger(t),"Numerator must be an integer"),E(Number.isSafeInteger(n),"Denominator must be an integer"),E(0!==n,"Denominator must not be zero"),n<0&&(t=-t,n=-n),0===t&&(n=1);var a=function e(t,n){return n?e(n,t%n):t}(t,n);a>1&&(t/=a,n/=a),this.p=t,this.q=n}return Object(s.a)(e,[{key:"floor",value:function(){var t=C(this.p,this.q),n=new e(t.quotient,1);return n.less(e.zero)&&0!==t.remainder&&(n=n.sub(e.one)),n}},{key:"negate",value:function(){return new e(-this.p,this.q)}},{key:"invert",value:function(){return new e(this.q,this.p)}},{key:"add",value:function(t){return new e(this.p*t.q+this.q*t.p,this.q*t.q)}},{key:"sub",value:function(t){return new e(this.p*t.q-this.q*t.p,this.q*t.q)}},{key:"mul",value:function(t){return"number"==typeof t&&(t=e.fromFloat(t)),new e(this.p*t.p,this.q*t.q)}},{key:"div",value:function(t){return new e(this.p*t.q,this.q*t.p)}},{key:"clamp",value:function(t,n){return"number"==typeof t&&(t=e.fromFloat(t)),"number"==typeof n&&(n=e.fromFloat(n)),this.less(t)?t:n.less(this)?n:this}},{key:"divmod",value:function(e){var t=this.div(e).floor();return{quotient:t,remainder:this.sub(e.mul(t))}}},{key:"equal",value:function(e){return this.p===e.p&&this.q===e.q}},{key:"isNegative",value:function(){return this.p<0}},{key:"isPositive",value:function(){return this.p>0}},{key:"isOne",value:function(){return 1===this.p}},{key:"isZero",value:function(){return 0===this.p}},{key:"less",value:function(e){return this.p*e.q<this.q*e.p}},{key:"toFloat",value:function(){return this.p/this.q}},{key:"toFraction",value:function(){return 1===this.q?this.p.toString():this.p.toString()+"/"+this.q.toString()}},{key:"toDecimal",value:function(t,n){null==t&&(t=3),null==n&&(n=new e(5,Math.pow(10,t+1)));var a="",r=this;r.isNegative()&&(a="-",r=r.negate());for(var i=C((r=r.add(n)).p,r.q),o=i.quotient.toString(),c="",s=new e(i.remainder,r.q),u=new e(10,1);t>0&&!s.equal(n);){s=s.mul(u),n=n.mul(u);var l=C(s.p,s.q);c+=l.quotient.toString(),s=new e(l.remainder,s.q),t--}if(s.equal(n))for(;"0"===c[c.length-1];)c=c.slice(0,c.length-1);return""!==c?a+o+"."+c:a+o}}],[{key:"fromFloat",value:function(t){if(Number.isInteger(t))return new this(t,1);var n=new e(Math.round(1e4*t),1e4),a=n.divmod(e.one),r=!0,i=!1,o=void 0;try{for(var c,s=S[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value,l=Object(v.a)(u,2),m=l[0],p=l[1];if(a.remainder.equal(m))return a.quotient.add(p)}}catch(d){i=!0,o=d}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"fromInts",value:function(e,t){return new this(e,t)}},{key:"fromString",value:function(t){var n=t.indexOf("/");if(-1===n)return e.fromFloat(Number(t));var a=Number(t.slice(0,n)),r=Number(t.slice(n+1));return e.fromInts(a,r)}}]),e}();N.zero=new N(0,1),N.one=new N(1,1),N.oneThird=new N(1,3),N.twoThirds=new N(2,3);for(var S=[],x=2;x<100;x++)for(var M=1;M<x;M++){var _=M/x;if(!(_.toString().length<10)){var I=new N(Math.round(1e4*_),1e4);S.push([I,N.fromInts(M,x)]);var R=new N(Math.floor(1e4*_),1e4);S.push([R,N.fromInts(M,x)])}}var P=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.localised_name=void 0,this.icon_col=void 0,this.icon_row=void 0,this.name=t.name,this.localised_name=t.localised_name,this.icon_col=t.icon_col,this.icon_row=t.icon_row}return Object(s.a)(e,[{key:"niceName",value:function(){return this.localised_name.en}}]),e}(),D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).raw=void 0,n.usedBy=[],n.madeBy=[],n.raw=e,n.name=e.name,n.localised_name=e.localised_name,n.icon_col=e.icon_col,n.icon_row=e.icon_row,n}return Object(m.a)(t,e),t}(P),q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).type=void 0,n.limitedTo=void 0,n.effects=void 0,n.type=e.type,n.limitedTo=new Set(e.limitation),n.effects={speed:N.fromFloat((e.effect.speed||{bonus:0}).bonus),productivity:N.fromFloat((e.effect.productivity||{bonus:0}).bonus),consumption:N.fromFloat((e.effect.consumption||{bonus:0}).bonus),pollution:N.fromFloat((e.effect.pollution||{bonus:0}).bonus)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canUseWith",value:function(e){return 0===this.limitedTo.size||this.limitedTo.has(e.name)}}]),t}(D),F=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).type="generic",n}return Object(m.a)(t,e),t}(D),T=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).default_temperature=void 0,n.type="fluid",n.default_temperature=e.default_temperature,n}return Object(m.a)(t,e),t}(D),G=function e(t){Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,this.amount=N.fromFloat(t.amount)},B=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",a.item=void 0,a.item=n.itemMap[e.name],a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}}]),t}(G),L=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",a.item=void 0,a.minimum_temperature=void 0,a.maximum_temperature=void 0,a.item=n.fluidMap[e.name],a.minimum_temperature=e.minimum_temperature||-1/0,a.maximum_temperature=e.maximum_temperature||1/0,a.maximum_temperature>=1797e305&&(a.maximum_temperature=1/0),a.minimum_temperature<=-1797e305&&(a.minimum_temperature=-1/0),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e=this.minimum_temperature,t=this.maximum_temperature,n="";return e!==-1/0&&t!==1/0?n=" (".concat(e,"\xb0 \u2013 ").concat(t,"\xb0)"):t!==1/0?n=" (\u2264 ".concat(t,"\xb0)"):e!==-1/0&&(n=" (\u2265 ".concat(t,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(n)}}]),t}(G),A=function e(t){var n;Object(c.a)(this,e),this.name=void 0,this.amount=void 0,this.name=t.name,n="amount"in t?N.fromFloat(t.amount):N.fromInts(t.amount_min+t.amount_max,2),"number"==typeof t.probability&&(0===t.probability?n=N.zero:1!==t.probability&&(E(t.probability>0),E(t.probability<1),n=n.mul(N.fromFloat(t.probability)))),this.amount=n},W=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="item",a.item=void 0,a.item=n.itemMap[e.name],a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName())}},{key:"satisfies",value:function(e){return"item"===e.type&&e.item===this.item}}]),t}(A),U=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).type="fluid",a.item=void 0,a.temperature=void 0,a.item=n.fluidMap[e.name],a.item||console.error("could not find item",e),a.temperature=e.temperature||a.item.default_temperature,a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){var e="";return this.temperature!==this.item.default_temperature&&(e=" (".concat(this.temperature,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName()).concat(e)}},{key:"satisfies",value:function(e){return"fluid"===e.type&&e.item===this.item&&e.maximum_temperature>=this.temperature&&e.minimum_temperature<=this.temperature}}]),t}(A),z=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).category=void 0,a.ingredients=void 0,a.products=void 0,a.crafting_time=void 0,a.madeIn=[],a.name=e.name,a.category=e.category,a.crafting_time=N.fromFloat(e.energy_required),a.ingredients=e.ingredients.map((function(e){return"fluid"===e.type?new L(e,n):new B(e,n)})),a.products=e.results.map((function(e){return"fluid"===e.type?new U(e,n):new W(e,n)})),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"niceName",value:function(){return this.products.length>1?Object(g.a)(Object(l.a)(t.prototype),"niceName",this).call(this):this.products[0].amount.equal(N.one)?this.products[0].item.niceName():this.products[0].niceName()}}]),t}(P),H=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"canBuildRecipe",value:function(e){return-1!==this.data.crafting_categories.indexOf(e.category)}}]),t}(function(){function e(t){Object(c.a)(this,e),this.data=void 0,this.data=t}return Object(s.a)(e,[{key:"niceName",value:function(){return this.data.localised_name.en}}]),e}()),K=function(e){var t={},n=!0,a=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=c.data.crafting_categories[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;t.hasOwnProperty(d)||(t[d]=[]),t[d].push(c)}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){a=!0,r=h}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return t},V=function(){function e(t){var n=this;Object(c.a)(this,e),this.raw=void 0,this.items=[],this.itemMap={},this.fluids=[],this.fluidMap={},this.modules=[],this.moduleMap={},this.recipes=[],this.recipeMap={},this.entities=[],this.entityMap={},this.categoryMap=void 0,console.groupCollapsed("Game data processing"),this.raw=t;var a=function(e,t){var a=!0,r=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value,u=new t(s);n.entityMap[s.name]=u,n.entities.push(u)}}catch(l){r=!0,i=l}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}};for(var r in a(w(t["assembling-machine"]),H),a(w(t.furnace),H),a(w(t["rocket-silo"]),H),t.items){var i=t.items[r];if("type"in i&&"fluid"===i.type){var o=new T(i);this.fluids.push(o),this.fluidMap[o.name]=o}else if("type"in i&&"module"===i.type){var s=new q(i);this.items.push(s),this.itemMap[s.name]=s,this.modules.push(s),this.moduleMap[s.name]=s}else{var u=new F(i);this.items.push(u),this.itemMap[u.name]=u}}for(var l in t.recipes){var m=new z(t.recipes[l],this);for(var p in this.entityMap){var d=this.entityMap[p];"canBuildRecipe"in d&&d.canBuildRecipe(m)&&m.madeIn.push(d)}if(m.madeIn.length)if(m.products.some((function(e){return e.amount.isPositive()}))){this.recipeMap[m.name]=m,this.recipes.push(m);var h=!0,f=!1,v=void 0;try{for(var y,b=m.ingredients[Symbol.iterator]();!(h=(y=b.next()).done);h=!0){y.value.item.usedBy.push(m)}}catch(C){f=!0,v=C}finally{try{h||null==b.return||b.return()}finally{if(f)throw v}}var g=!0,E=!1,O=void 0;try{for(var j,k=m.products[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){j.value.item.madeBy.push(m)}}catch(C){E=!0,O=C}finally{try{g||null==k.return||k.return()}finally{if(E)throw O}}}else console.debug("Ignoring void recipe",m.name,m);else console.warn("Ignoring uncraftable recipe",m.name,m)}this.categoryMap=K(this.entities),console.log("Processed ".concat(this.items.length," items")),console.log("Processed ".concat(this.fluids.length," fluids")),console.log("Processed ".concat(this.recipes.length," recipes")),console.log("Processed ".concat(this.entities.length," entities")),console.groupEnd()}return Object(s.a)(e,[{key:"getItemOrder",value:function(e){var t="",n="",a=this.raw.groups[e.raw.group];return a&&(t=a.order,n=a.subgroups[e.raw.subgroup]||""),[t,n,e.raw.order,e.raw.name]}},{key:"sortByItem",value:function(e,t){var n=this;e.sort((function(e,a){var r=n.getItemOrder(t(e)),i=n.getItemOrder(t(a));for(var o in r){var c=r[o],s=i[o];if(c>s)return 1;if(c<s)return-1}return 0}))}}]),e}(),Q=n(30),J=n(41),Z=n(16),Y=n(87);function $(e,t){var n,a=e instanceof z?e.category:e;return n=a in t.settings.assemblerOverrides?t.settings.assemblerOverrides[a]:t.gameData.categoryMap[a][0],e instanceof z&&E(-1!==e.madeIn.indexOf(n)),n}var X={gameData:{fakeGameData:!0},groups:[{name:"Factory 1",rows:[]}],settings:{assemblerOverrides:{}},activeGroupIdx:0,recipeTarget:void 0};function ee(e){return e.groups[e.activeGroupIdx]}function te(e,t){var n=e.groups.map((function(n,a){return a===e.activeGroupIdx?Object(Z.a)({},n,{},t):n}));return Object(Z.a)({},e,{groups:n})}var ne=Object(Y.a)(X)({replaceState:function(e){return function(t){return Object(Z.a)({},t,{},e)}},addRow:function(e){return function(t){var n=ee(t);if(!n.rows.some((function(t){return t.recipe.name===e.recipe.name})))return te(t,{rows:[].concat(Object(J.a)(n.rows),[e])})}},updateRow:function(e,t){return function(n){var a=ee(n),r=Array.from(a.rows);return r[e]=Object(Z.a)({},a.rows[e],{},t),te(n,{rows:r})}},removeRow:function(e){return function(t){var n=ee(t),a=Array.from(n.rows);return a.splice(e,1),te(t,{rows:a})}},moveRow:function(e,t){return function(n){var a=ee(n),r=Array.from(a.rows),i=r.splice(e,1),o=Object(v.a)(i,1)[0];return r.splice(t,0,o),te(n,{rows:r})}},updateDefaultMachine:function(e,t){return function(n){var a=$(e,n),r=n.groups.map((function(n){var r=n.rows.map((function(n){return n.recipe.category!==e||n.machine!==a?n:Object(Z.a)({},n,{machine:t})}));return Object(Z.a)({},n,{rows:r})}));return Object(Z.a)({},n,{groups:r,settings:Object(Z.a)({},n.settings,{assemblerOverrides:Object(Z.a)({},n.settings.assemblerOverrides,Object(Q.a)({},e,t))})})}},setActiveGroup:function(e){return function(t){return Object(Z.a)({},t,{activeGroupIdx:e})}},addGroup:function(e){return function(t){var n=[].concat(Object(J.a)(t.groups),[{name:e,rows:[]}]);return Object(Z.a)({},t,{groups:n,activeGroupIdx:t.groups.length})}},renameGroup:function(e,t){return function(n){var a=Object(J.a)(n.groups);return a[e]=Object(Z.a)({},a[e],{name:t}),Object(Z.a)({},n,{groups:a})}},removeGroup:function(e){return function(t){var n=Object(J.a)(t.groups);n.splice(e,1),n.length||n.push({name:"Factory 1",rows:[]});var a=n.length-1,r=Math.min(t.activeGroupIdx,a);return Object(Z.a)({},t,{groups:n,activeGroupIdx:r})}},setRecipeTarget:function(e){return function(t){return Object(Z.a)({},t,{recipeTarget:e})}}}),ae=Object(v.a)(ne,2),re=ae[0],ie=ae[1],oe=function(e){return function(t){var n=ie(),a=Object(v.a)(n,2),r=a[0],o=a[1];return i.a.createElement(e,Object.assign({state:r,actions:o},t))}},ce=function(e){return function(t){var n=ie(),a=Object(v.a)(n,1)[0];return i.a.createElement(e,Object.assign({gameData:a.gameData},t))}},se=n(59);function ue(e){return{name:e.name,rows:e.rows.map((function(e){return[e[0],e[1],e[2].toString(),e[3],e[4],e[5]]}))}}function le(e){var t=localStorage.getItem("appstate");if(!t)return null;var n=JSON.parse(t);return 1===n.version&&(n.version=3),fe(e,n)}function me(e){return{version:5,data:{groups:e.groups.map((function(t){return{name:t.name,rows:t.rows.map((function(t){var n=t.machine.data.name;return $(t.recipe,e).data.name===n&&(n=null),[t.recipe.name,n,t.numMachines.toFraction(),t.modules.map((function(e){return e?e.name:null})),t.beaconModule?t.beaconModule.name:void 0,t.numBeacons]}))}})),settings:{assemblerOverrides:O(e.settings.assemblerOverrides,(function(e){return e.data.name}))}}}}var pe=/^#(\d+)?(?:-)?(.+)$/;function de(e){var t=pe.exec(document.location.hash);if(!t)return null;var n=Number(t[1]||1),a=decodeURIComponent(t[2]);return n>2&&(a=Object(se.inflate)(atob(a),{to:"string"})),fe(e,{version:n,data:JSON.parse(a)})}function he(e){switch(e.version){case 1:e=function(e){return{version:2,data:{rows:e.data,settings:{assemblerOverrides:{}}}}}(e);case 2:e=function(e){return{version:3,data:e.data}}(e);case 3:e=function(e){return{version:4,data:{settings:e.data.settings,groups:[{name:"Factory 1",rows:e.data.rows}]}}}(e);case 4:e=function(e){return{version:5,data:{settings:e.data.settings,groups:e.data.groups.map(ue)}}}(e);case 5:break;default:throw new Error("unknown state: ".concat(e))}return e}function fe(e,t){var n=he(t).data,a={gameData:e,settings:ve(e,n.settings),groups:[],activeGroupIdx:0,recipeTarget:void 0};return a.groups=n.groups.map((function(t){return{name:t.name,rows:t.rows.map((function(t){var n=Object(v.a)(t,6),r=n[0],i=n[1],o=n[2],c=n[3],s=n[4],u=n[5],l=e.recipeMap[r];return{recipe:l,machine:i?e.entityMap[i]:$(l,a),numMachines:N.fromString(o),modules:c.map((function(t){return t?e.moduleMap[t]:null})),beaconModule:s?e.moduleMap[s]:null,numBeacons:u||0}}))}})),a}function ve(e,t){return{assemblerOverrides:O(t.assemblerOverrides,(function(t){return e.entityMap[t]}))}}var ye=n(8),be=n.n(ye),ge=n(54),Ee=n(102),Oe=n(22),we=n(64),je=n(32),ke=n(100),Ce=n(40),Ne=n(38),Se=function(){function e(){var t=this;Object(c.a)(this,e),this.handlers=[],this.dispatch=function(e){var n=!0,a=!1,r=void 0;try{for(var i,o=t.handlers[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){(0,i.value)(e)}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}}return Object(s.a)(e,[{key:"addHandler",value:function(e){-1===this.handlers.indexOf(e)&&this.handlers.push(e)}},{key:"removeHandler",value:function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}}]),e}(),xe=new Se,Me=new Se,_e=new Se,Ie=n(31),Re=27,Pe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).buttonRef=void 0,n.handleToggle=function(){n.setState({isOpen:!n.state.isOpen})},n.handleSelect=function(e){n.props.onSelect(e),n.state.isOpen&&n.setState({isOpen:!1})},n.handleWantClose=function(){n.state.isOpen&&n.setState({isOpen:!1})},n.state={isOpen:!1},n.buttonRef=r.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props.options.some((function(e){return"option"in e&&!e.disabled})),a=["btn","btn-secondary"];return n?a.push("dropdown-toggle"):a.push("disabled"),this.state.isOpen&&(e=r.createElement(De,{parentRef:this.buttonRef,options:this.props.options,renderOption:this.props.renderOption,onSelect:this.handleSelect,onWantClose:this.handleWantClose})),r.createElement(r.Fragment,null,r.createElement("button",{ref:this.buttonRef,className:a.join(" "),type:"button",onClick:function(){n&&t.handleToggle()}},this.props.renderSelected(this.props.selected)),e)}}]),t}(r.Component),De=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).popperInstance=null,n.menuRef=void 0,n.popperUpdate=function(e){return n.setState({style:e.styles}),e},n.handleBodyClick=function(e){if(!n.menuRef.current)throw new Error("Click event without menu rendered. This should not happen.");if(!e.target)throw new Error("Click event without click target. This should not happen.");var t=e.target;n.menuRef.current.contains(t)||n.props.onWantClose()},n.handleKeyEvent=function(e){e.keyCode===Re&&n.props.onWantClose()},n.renderOptions=function(){return n.props.options.map((function(e,t){if("header"in e)return r.createElement("h6",{className:"dropdown-header",key:"ddkey"+t},e.header);if("divider"in e)return r.createElement("div",{className:"dropdown-divider",key:"ddkey"+t});var a=["dropdown-item"];return e.active&&a.push("active"),e.disabled&&a.push("disabled"),r.createElement("button",{key:e.key,className:a.join(" "),onClick:function(){return n.props.onSelect(e.option)},type:"button"},n.props.renderOption(e.option))}))},n.menuRef=r.createRef(),n.state={style:{}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){if(this.popperInstance)throw new Error("Component mounted twice?");var e=this.props.parentRef.current;if(!e)throw new Error("Cannot mount DropdownMenu without parentRef");var t=this.menuRef.current;if(!t)throw new Error("Cannot mount DropdownMenu without menuRef");this.popperInstance=new Ie.a(e,t,{modifiers:{applyStyle:{enabled:!1},updateStateWithStyle:{enabled:!0,fn:this.popperUpdate}}}),document.body.addEventListener("click",this.handleBodyClick),document.body.addEventListener("keyup",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null),document.body.removeEventListener("click",this.handleBodyClick),document.body.removeEventListener("keyup",this.handleKeyEvent)}},{key:"render",value:function(){return r.createElement("div",{className:"dropdown-menu show",style:this.state.style,ref:this.menuRef},this.renderOptions())}}]),t}(r.Component),qe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).selfRef=void 0,n.popperInstance=void 0,n.handleMouseEnter=function(){n.setState({showSelf:!0})},n.handleMouseLeave=function(){n.setState({showSelf:!1})},n.selfRef=r.createRef(),n.popperInstance=null,n.state={showSelf:!1,style:{zIndex:1001}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"initPopper",value:function(){if(!this.popperInstance){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");var t=this.selfRef.current;if(!t)throw new Error("No self reference yet?");this.popperInstance=new Ie.a(e,t,{placement:"right",modifiers:{offset:{enabled:!0,offset:"0, 20"},preventOverflow:{enabled:!0,boundariesElement:"window"}}})}}},{key:"cleanupPopper",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null)}},{key:"componentDidUpdate",value:function(e,t){t.showSelf!==this.state.showSelf&&(this.state.showSelf?this.initPopper():this.cleanupPopper())}},{key:"componentDidMount",value:function(){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");e.addEventListener("mouseenter",this.handleMouseEnter),e.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"componentWillUnmount",value:function(){var e=this.props.relativeTo.current;e&&(e.removeEventListener("mouseenter",this.handleMouseEnter),e.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"render",value:function(){return this.state.showSelf?o.createPortal(r.createElement("div",{style:this.state.style,ref:this.selfRef},this.props.children),document.body):null}}]),t}(r.Component),Fe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;if(n.setState({txtValue:t}),t.trim()){var a=Number(t);n.props.intOnly&&!Number.isInteger(a)||n.props.positiveOnly&&a<0||n.props.onChange(a)}},n.state={txtValue:e.value.toString()},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.createElement("input",{className:"form-control",value:this.state.txtValue,onChange:this.handleChange,type:"number",min:"0",step:"1"})}}]),t}(r.PureComponent),Te=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){var t,a=e.target.value;n.setState({txtValue:a,error:void 0});try{t=function(e){if(!e.trim())throw new Error("Empty!");var t=e.indexOf("/"),n=e.lastIndexOf("/");if(t!==n)throw new Error("Too many slashes");return N.fromString(e)}(a)}catch(r){return void n.setState({error:r.message})}n.props.positiveOnly&&t.isNegative()?n.setState({error:"Number must be positive"}):n.props.onChange(t)},n.state={error:"",txtValue:Ge(e.value)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){e.value.equal(this.props.value)||this.setState({error:void 0,txtValue:Ge(this.props.value)})}},{key:"render",value:function(){return r.createElement("input",{className:be()("form-control",{"is-invalid":!!this.state.error}),value:this.state.txtValue,onChange:this.handleChange,type:"text"})}}]),t}(r.PureComponent);function Ge(e){var t=e.toFloat().toString();return t.length<10?t:e.toFraction()}var Be=n(88),Le=n.n(Be),Ae=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).iconRef=void 0,n.iconRef=i.a.createRef(),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=32*-this.props.obj.icon_col,t=32*-this.props.obj.icon_row,n=Object(Z.a)({display:"inline-block",backgroundPosition:"".concat(e,"px ").concat(t,"px"),width:"32px",height:"32px"},this.props.style),a=i.a.createElement("div",{ref:this.iconRef,onClick:this.props.onClick,title:this.props.title,className:be()(Le.a.Icon,"game-icon"),style:n},"\xa0");return this.props.tooltip&&(a=i.a.createElement(i.a.Fragment,null,a,i.a.createElement(qe,{children:this.props.tooltip,relativeTo:this.iconRef}))),this.props.text&&(a=i.a.createElement("div",{style:{lineHeight:"32px"}},a,i.a.createElement("span",{style:{marginLeft:"9px"}},this.props.text))),a}}]),t}(i.a.PureComponent),We=function(e){return r.createElement("div",{className:"machine-card card"},r.createElement("div",{className:"card-body"},r.createElement("b",null,e.machine.niceName()),r.createElement("br",null),r.createElement("b",null,"Crafting Speed:")," ",e.machine.data.crafting_speed,r.createElement("br",null),r.createElement("b",null,"Module Slots:")," ",e.machine.data.module_slots))},Ue=ce((function(e){var t=e.recipe,n=t.ingredients.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,text:e.niceName()})})),a=t.products.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,text:e.niceName()})})),i=t.madeIn.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.data,tooltip:r.createElement(We,{machine:e})})}));return r.createElement("div",{className:"recipe-tooltip card",onClick:function(){e.onClick&&e.onClick(e.recipe)}},r.createElement("div",{className:"card-header"},r.createElement(Ae,{obj:t,text:t.niceName()})),r.createElement("div",{className:"card-body"},r.createElement(Ae,{obj:e.gameData.raw.sprites.extra.clock,text:t.crafting_time.toDecimal()}),r.createElement("div",{style:{float:"left"}},"Ingredients:",n),r.createElement("div",{style:{display:"inline-block"}},"Products:",a),r.createElement("div",{style:{clear:"both"}}),r.createElement("div",{style:{lineHeight:"32px"}},"Made In:",i)))})),ze=function(e){return r.createElement(Ae,{obj:e.data,tooltip:r.createElement(We,{machine:e})})},He=function(e){return r.createElement(Ae,{obj:e.data,tooltip:r.createElement(We,{machine:e}),text:e.niceName()})},Ke=function(e){var t=e.machines.map((function(t){return{key:t.data.name,option:t,active:t===e.selected}}));return r.createElement(Pe,{options:t,selected:e.selected,onSelect:e.onChange,renderOption:He,renderSelected:ze})},Ve={consumption:"Energy Consumption",productivity:"Productivity",speed:"Speed",pollution:"Pollution"},Qe=function(e){var t=e.module,n=[];for(var a in t.raw.effect){var i=t.raw.effect[a].bonus;n.push(r.createElement("div",{key:a},r.createElement("b",null,Ve[a],":"," ",k(100*i,2),"%")))}return r.createElement("div",{className:"module-card card"},r.createElement("div",{className:"card-header"},r.createElement("b",null,t.niceName())),r.createElement("div",{className:"card-body"},n))},Je=ce((function(e){var t=e.gameData.raw.sprites.extra.slot_icon_module,n=new q({type:"module",name:"no_module",localised_name:{en:"No Module"},category:"speed",effect:{},limitation:[],rocket_launch_products:[],icon_row:t.icon_row,icon_col:t.icon_col,group:"",subgroup:"",order:""}),a=e.gameData.modules.filter((function(t){return(!e.isBeacon||!t.effects.productivity.isPositive())&&t.canUseWith(e.recipe)})).map((function(t){return{key:t.name,option:t,active:t===e.selected}}));return a.unshift({key:"no_module",option:null,active:!e.selected}),r.createElement(Pe,{options:a,selected:e.selected,onSelect:e.onChange,renderOption:function(e){return e?r.createElement(Ae,{obj:e,tooltip:r.createElement(Qe,{module:e}),text:e.niceName()}):r.createElement(Ae,{obj:n,text:n.niceName()})},renderSelected:function(e){return e?r.createElement(Ae,{obj:e,tooltip:r.createElement(Qe,{module:e})}):r.createElement(Ae,{obj:n})}})})),Ze=function(){function e(){var t=this;Object(c.a)(this,e),this.products=[],this.ingredients=[],this.addIngredient=function(e){var n=!0,a=!1,r=void 0;try{for(var i,o=t.ingredients[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.maximum_temperature===c.maximum_temperature&&e.minimum_temperature===c.minimum_temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){a=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}t.ingredients.push(e)},this.addProduct=function(e){var n=!0,a=!1,r=void 0;try{for(var i,o=t.products[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=e.type===c.type&&e.item===c.item;if("fluid"===e.type&&"fluid"===c.type&&(s=s&&e.temperature===c.temperature),s)return void(c.amount=c.amount.add(e.amount))}}catch(u){a=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}t.products.push(e)}}return Object(s.a)(e,[{key:"addRow",value:function(e){var t={consumption:N.one,pollution:N.one,productivity:N.one,speed:N.one},n=!0,a=!1,r=void 0;try{for(var i,o=e.modules[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;c&&(t.consumption=t.consumption.add(c.effects.consumption),t.pollution=t.pollution.add(c.effects.pollution),t.productivity=t.productivity.add(c.effects.productivity),t.speed=t.speed.add(c.effects.speed))}}catch(p){a=!0,r=p}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}if(e.beaconModule&&e.numBeacons>0){var s=e.beaconModule.effects,u=N.fromInts(e.numBeacons,2);t.consumption=t.consumption.add(s.consumption.mul(u)),t.pollution=t.pollution.add(s.pollution.mul(u)),t.productivity=t.productivity.add(s.productivity.mul(u)),t.speed=t.speed.add(s.speed.mul(u))}t.consumption=t.consumption.clamp(.2,32767),t.pollution=t.pollution.clamp(.2,32767),t.speed=t.speed.clamp(.2,32767),t.productivity=t.productivity.clamp(1,32767);var l=N.one.mul(e.recipe.crafting_time.invert()).mul(e.numMachines).mul(e.machine.data.crafting_speed).mul(t.speed),m=l.mul(t.productivity);e.recipe.ingredients.map((function(e){return(e=j(e)).amount=e.amount.mul(l),e})).forEach(this.addIngredient),e.recipe.products.map((function(e){return(e=j(e)).amount=e.amount.mul(m),e})).forEach(this.addProduct)}},{key:"reduce",value:function(){var e=this.ingredients.map(j),t=this.products.map(j),n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,s=!0,u=!1,l=void 0;try{for(var m,p=e[Symbol.iterator]();!(s=(m=p.next()).done);s=!0){var d=m.value;c.amount.isZero()||d.amount.isZero()||c.satisfies(d)&&(c.amount.less(d.amount)?(d.amount=d.amount.sub(c.amount),c.amount=N.zero):d.amount.less(c.amount)?(c.amount=c.amount.sub(d.amount),d.amount=N.zero):(d.amount=N.zero,c.amount=N.zero))}}catch(h){u=!0,l=h}finally{try{s||null==p.return||p.return()}finally{if(u)throw l}}}}catch(h){a=!0,r=h}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return{ingredients:e=e.filter((function(e){return!e.amount.isZero()})),products:t=t.filter((function(e){return!e.amount.isZero()}))}}}]),e}(),Ye=function(e){return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-header"},e.obj.item.niceName()," (",e.obj.name,")"))};function $e(e){var t,n=e.toDecimal().toString();return t=n.includes(".")&&n.length>4?r.createElement("abbr",{title:e.toFraction()},e.toDecimal()):n,r.createElement(r.Fragment,null,t," / sec")}var Xe=oe(function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleRemoveClick=function(){n.props.actions.removeRow(n.props.index)},n.handleMachineChange=function(e){n.applyChange({machine:e,modules:n.props.modules.filter((function(e){return null!==e})).slice(0,e.data.module_slots)})},n.handleNumMachinesChange=function(e){n.applyChange({numMachines:e})},n.handleNumBeaconsChange=function(e){n.applyChange({numBeacons:e})},n.handleSetAllModules=function(){n.applyChange({modules:new Array(n.props.machine.data.module_slots).fill(n.props.modules[0])})},n.handleSetModule=function(e,t){var a=n.props.modules.slice();a[e]=t,n.applyChange({modules:a})},n.handleSetBeaconModule=function(e){n.applyChange({beaconModule:e})},n.handleIngredientClick=function(e,t){if(t.shiftKey)return t.preventDefault(),t.stopPropagation(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.madeBy.length?_e.dispatch(e.item.madeBy[0]):xe.dispatch(e)},n.handleProductClick=function(e,t){if(t.shiftKey)return t.preventDefault(),t.stopPropagation(),void n.props.actions.setRecipeTarget({item:e.item,amount:e.amount});1===e.item.usedBy.length?_e.dispatch(e.item.usedBy[0]):Me.dispatch(e)},n.handleInputGroupClick=function(e){var t=n.props.state.recipeTarget;if(e.shiftKey&&t){e.preventDefault(),e.stopPropagation();var a,r=n.getOutput();if(a=(a=r.ingredients.find((function(e){return e.item.name===t.item.name})))||r.products.find((function(e){return e.item.name===t.item.name}))){var i=t.amount.div(a.amount).mul(n.props.numMachines);n.applyChange({numMachines:i})}else console.error("Could not find ".concat(t.item.name," in totals"),r)}},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"applyChange",value:function(e){this.props.actions.updateRow(this.props.index,e)}},{key:"getOutput",value:function(){var e=new Ze;return e.addRow(this.props),{ingredients:e.ingredients,products:e.products}}},{key:"renderModules",value:function(){for(var e=this,t=this.props.machine.data.module_slots,n=[],a=function(t){var a=e.props.modules[t];n.push(r.createElement(Je,{key:t,recipe:e.props.recipe,selected:a,onChange:function(n){return e.handleSetModule(t,n)}}))},i=0;i<t;i++)a(i);return t>1&&n.splice(1,0,r.createElement("button",{onClick:this.handleSetAllModules,key:"applicator",className:"btn"},"\u2192")),n}},{key:"renderBeacons",value:function(){return r.createElement("div",{className:"btn-toolbar mb-3"},r.createElement("div",{className:"input-group"},r.createElement("div",{className:"input-group-prepend"},r.createElement("span",{className:"input-group-text"},"Beacon Modules")),r.createElement(Fe,{value:this.props.numBeacons,onChange:this.handleNumBeaconsChange,positiveOnly:!0,intOnly:!0}),r.createElement("div",{className:"input-group-append btn-icon-wrapper"},r.createElement(Je,{isBeacon:!0,recipe:this.props.recipe,selected:this.props.beaconModule,onChange:this.handleSetBeaconModule}))))}},{key:"renderMachines",value:function(){return r.createElement("div",{className:"btn-toolbar mb-3"},r.createElement("div",{className:"input-group",onClick:this.handleInputGroupClick},r.createElement(Te,{value:this.props.numMachines,onChange:this.handleNumMachinesChange,positiveOnly:!0}),r.createElement("div",{className:"input-group-append btn-icon-wrapper"},r.createElement(Ke,{machines:this.props.recipe.madeIn,selected:this.props.machine,onChange:this.handleMachineChange}))))}},{key:"render",value:function(){var e=this,t=this.props.recipe,n=this.getOutput(),a=n.ingredients.map((function(t,n){return r.createElement("div",{className:"mb-1",key:n},r.createElement(Ae,{onClick:e.handleIngredientClick.bind(null,t),tooltip:r.createElement(Ye,{obj:t}),obj:t.item,text:$e(t.amount)}))})),i=n.products.map((function(t,n){return r.createElement("div",{className:"mb-1",key:n},r.createElement(Ae,{onClick:e.handleProductClick.bind(null,t),tooltip:r.createElement(Ye,{obj:t}),obj:t.item,text:$e(t.amount)}))}));return r.createElement(Ne.b,{draggableId:t.name,index:this.props.index},(function(n){return r.createElement("div",Object.assign({className:"recipe-row card mb-3",ref:n.innerRef},n.draggableProps),r.createElement("div",Object.assign({className:"card-header"},n.dragHandleProps),r.createElement("div",{style:{float:"left"}},r.createElement(Ae,{obj:t,text:t.niceName(),tooltip:r.createElement(Ue,{recipe:t})})),r.createElement("div",{style:{float:"right"}},r.createElement(je.a,{variant:"danger",onClick:e.handleRemoveClick,size:"sm"},"Remove")),r.createElement("div",{style:{clear:"both"}})),r.createElement("div",{className:"card-body"},r.createElement("div",{style:{float:"left"}},e.renderMachines(),r.createElement("div",{className:"mb-3 btn-group btn-icon-wrapper"},e.renderModules()),e.renderBeacons()),r.createElement("div",{style:{float:"right"}},r.createElement("div",{className:"mr-3",style:{display:"inline-block",float:"left",minWidth:"150px"}},r.createElement("b",null,"Ingredients:"),a),r.createElement("div",{className:"mr-2",style:{display:"inline-block",minWidth:"150px"}},r.createElement("b",null,"Products:"),i)),r.createElement("div",{style:{clear:"both"}})))}))}}]),t}(r.Component)),et=n(47),tt=n(95),nt=n.n(tt),at=n(96),rt=n.n(at),it=n(63),ot=n.n(it);function ct(e,t){switch(t){case"niceName":return e.niceName();case"name":return e.name}}var st=/((?:produces)|(?:consumes)):([a-z0-9-]+)/g,ut=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).inputRef=r.createRef(),n.state={query:"",matches:[]},n.handleIngredientClick=function(e){var t,a="produces:".concat(e.name);n.state.query.includes(a)||(n.setQuery("".concat(n.state.query," ").concat(a),(function(){n.calculateMatches()})),null===(t=n.inputRef.current)||void 0===t||t.scrollIntoView())},n.handleProductClick=function(e){var t,a="consumes:".concat(e.name);n.state.query.includes(a)||(n.setQuery("".concat(n.state.query," ").concat(a),(function(){n.calculateMatches()})),null===(t=n.inputRef.current)||void 0===t||t.scrollIntoView())},n.handleQueryInput=function(e){var t=e.target;n.setQuery(t.value)},n.handleRecipeClick=function(e){n.props.onPickRecipe(e),n.setQuery("")},n.setQuery=function(e,t){e.trim()?(n.setState({query:e},t),n.debCalculateMatches()):(n.debCalculateMatches.cancel(),n.setState({query:"",matches:[]},t))},n.debCalculateMatches=rt()(n.calculateMatches.bind(Object(et.a)(n)),200),n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){xe.addHandler(this.handleIngredientClick),Me.addHandler(this.handleProductClick)}},{key:"componentWillUnmount",value:function(){this.debCalculateMatches.cancel(),xe.removeHandler(this.handleIngredientClick),Me.removeHandler(this.handleProductClick)}},{key:"calculateMatches",value:function(){var e=this.state.query.trim().toLowerCase();if(e){var t={consumes:[],produces:[]};e=e.replace(st,(function(e,n,a){return t[n].push(a),""})).trim();var n=this.props.recipes;if((t.consumes.length||t.produces.length)&&(n=n.filter((function(e){var n=!0,a=!1,r=void 0;try{for(var i,o=function(){var t=i.value;if(!e.ingredients.some((function(e){return e.name===t})))return{v:!1}},c=t.consumes[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var s=o();if("object"===typeof s)return s.v}}catch(v){a=!0,r=v}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}var u=!0,l=!1,m=void 0;try{for(var p,d=function(){var t=p.value;if(!e.products.some((function(e){return e.name===t})))return{v:!1}},h=t.produces[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var f=d();if("object"===typeof f)return f.v}}catch(v){l=!0,m=v}finally{try{u||null==h.return||h.return()}finally{if(l)throw m}}return!0}))),e)n=new nt.a(n,{shouldSort:!0,getFn:ct,keys:[{name:"niceName",weight:.7},{name:"name",weight:.2}]}).search(e);this.setState({matches:n})}else this.setState({matches:[]})}},{key:"renderMatches",value:function(){var e=this;if(!this.state.matches.length)return"";var t=this.state.matches;return t.length>100&&(t=t.slice(0,100)),r.createElement("table",{className:"table table-hover"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Recipe"),r.createElement("th",null,"Time"),r.createElement("th",null,"Ingredients"),r.createElement("th",null,"Products"))),r.createElement("tbody",null,t.map((function(t){return r.createElement(mt,{recipe:t,key:t.name,onClick:e.handleRecipeClick})}))))}},{key:"render",value:function(){return r.createElement("div",{className:ot.a.RecipePicker},r.createElement("div",null,r.createElement("input",{ref:this.inputRef,className:"editable-display form-control",placeholder:"What do you want to build?",value:this.state.query,onChange:this.handleQueryInput})),this.renderMatches())}}]),t}(r.PureComponent);function lt(e){return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},e))}var mt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleClickAdd=function(){n.props.onClick(n.props.recipe)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.recipe,t=e.ingredients.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,tooltip:lt(e.niceName())})})),n=e.products.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,tooltip:lt(e.niceName())})}));return r.createElement("tr",{onClick:this.handleClickAdd},r.createElement("td",{className:ot.a.ResultName},r.createElement(Ae,{obj:e,text:e.niceName()})),r.createElement("td",null,e.crafting_time.toDecimal()),r.createElement("td",null,t),r.createElement("td",null,n))}}]),t}(r.PureComponent),pt=n(97),dt=n.n(pt);var ht,ft=ce((function(e){var t=new Ze,n=!0,a=!1,i=void 0;try{for(var o,c=e.rows[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;t.addRow(s)}}catch(p){a=!0,i=p}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}var u=t.reduce(),l=u.ingredients,m=u.products;return l.length||m.length?(e.gameData.sortByItem(m,(function(e){return e.item})),r.createElement("div",{className:"card ".concat(dt.a.TotalCard)},r.createElement("div",{className:"card-header"},"Combined Totals"),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col"},"Ingredients:",l.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,text:e.niceName()})}))),r.createElement("div",{className:"col"},"Products:",m.map((function(e,t){return r.createElement(Ae,{key:t,obj:e.item,text:e.niceName()})})))))))):r.createElement("div",null)})),vt=n(98),yt=n.n(vt),bt=oe(function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).handlePickRecipe=function(e){n.props.actions.addRow({recipe:e,machine:$(e,n.props.state),numMachines:N.one,modules:[],beaconModule:null,numBeacons:0})},n.handleDragEnd=function(e){e.destination&&n.props.actions.moveRow(e.source.index,e.destination.index)},n.renderRow=function(e,t){return r.createElement(Xe,Object.assign({key:e.recipe.name,index:t},e))},n.handleClickRename=function(){var e=n.props.state.activeGroupIdx,t=prompt("Whatcha wanna call it now?",n.props.state.groups[e].name);t&&n.props.actions.renameGroup(e,t)},n.handleClickDelete=function(){var e=n.props.state.activeGroupIdx,t=n.props.state.groups[e];window.confirm("Are you sure you want to delete ".concat(t.name))&&n.props.actions.removeGroup(e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){_e.addHandler(this.handlePickRecipe)}},{key:"componentWillUnmount",value:function(){_e.removeHandler(this.handlePickRecipe)}},{key:"render",value:function(){var e=this,t=this.props.state.gameData.recipes.filter((function(t){return!e.props.group.rows.some((function(e){return e.recipe===t}))}));return r.createElement("div",{className:yt.a.RecipeGroup},r.createElement("div",{className:"clearfix"},r.createElement("h3",{className:"float-left"},this.props.group.name),r.createElement("div",{className:"float-right"},r.createElement(Ce.a,{as:ke.a,size:"sm"},r.createElement(je.a,{variant:"info",onClick:this.handleClickRename},"Rename"),r.createElement(Ce.a.Toggle,{split:!0,variant:"info",id:"button-split"}),r.createElement(Ce.a.Menu,null,r.createElement(Ce.a.Item,{onClick:this.handleClickDelete},"Delete"))))),r.createElement(ut,{recipes:t,onPickRecipe:this.handlePickRecipe}),r.createElement("hr",null),r.createElement(Ne.a,{onDragEnd:this.handleDragEnd},r.createElement(Ne.c,{droppableId:"eyy"},(function(t){return r.createElement("div",Object.assign({ref:t.innerRef},t.droppableProps),e.props.group.rows.map(e.renderRow),t.placeholder)}))),r.createElement("hr",null),r.createElement(ft,{rows:this.props.group.rows}))}}]),t}(r.Component)),gt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=Object.entries(this.props.gameData.categoryMap).filter((function(e){return e[1].length>1})).map((function(e){return e[0]}));return e.sort((function(e,t){return e.localeCompare(t)})),r.createElement("div",null,r.createElement("h3",null,"Default Assemblers"),e.map((function(e){return r.createElement(Et,{key:e,category:e})})))}}]),t}(r.Component),Et=oe(function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.actions.updateDefaultMachine(n.props.category,e)},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.state.gameData.categoryMap[this.props.category],t=$(this.props.category,this.props.state);return r.createElement("div",{className:"btn-toolbar mb-3",key:this.props.category},r.createElement("div",{className:"input-group"},r.createElement("div",{className:"input-group-prepend"},r.createElement("span",{className:"input-group-text"},this.props.category)),r.createElement("div",{className:"input-group-append btn-icon-wrapper"},r.createElement(Ke,{machines:e,selected:t,onChange:this.handleChange}))))}}]),t}(r.Component)),Ot=ce(gt),wt=n(101),jt=n.n(wt);!function(e){e.Factory="FACTORY",e.Settings="SETTINGS"}(ht||(ht={}));var kt=oe(function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleKeyDown=function(e){"Shift"===e.key&&document.body.classList.add("shift-down")},n.handleKeyUp=function(e){"Shift"===e.key&&document.body.classList.remove("shift-down")},n.handleClickGroup=function(e){n.setState({activePage:ht.Factory}),n.props.actions.setActiveGroup(e)},n.handleClickAddGroup=function(e){e.preventDefault();var t="Factory ".concat(n.props.state.groups.length+1),a=prompt("What do you want to name this group?",t);a&&a.trim()&&n.props.actions.addGroup(a)},n.handleClickSettings=function(){n.setState({activePage:ht.Settings})},n.renderFactory=function(){var e=n.props.state.groups[n.props.state.activeGroupIdx];return i.a.createElement(ge.a,{fluid:!0},i.a.createElement(bt,{group:e}))},n.renderSettings=function(){return i.a.createElement(ge.a,{fluid:!0},i.a.createElement(Ot,null))},n.state={activePage:ht.Factory},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}},{key:"renderNavbar",value:function(){var e=this,t=this.state.activePage===ht.Settings?"settings":this.props.state.activeGroupIdx,n=this.props.state.groups.map((function(n,a){var r=t===a;return i.a.createElement(Oe.a.Item,{onClick:function(){return e.handleClickGroup(a)},key:a},i.a.createElement(Oe.a.Link,{active:r},n.name))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(Oe.a,{className:"flex-column"},i.a.createElement(Oe.a.Item,null,i.a.createElement(Oe.a.Link,{disabled:!0},i.a.createElement("span",{role:"img","aria-label":"Factory icon"},"\ud83c\udfed")," ","Factories")),n,i.a.createElement(Oe.a.Item,null,i.a.createElement(Oe.a.Link,{onClick:this.handleClickAddGroup},"Add A Factory")),i.a.createElement(Oe.a.Item,null,i.a.createElement(Oe.a.Link,{active:"settings"===t,onClick:this.handleClickSettings},i.a.createElement("span",{role:"img","aria-label":"Gear icon"},"\u2699\ufe0f")," ","Settings"))))}},{key:"render",value:function(){if(!this.props.state.gameData.raw)return null;var e;if(this.state.activePage===ht.Factory)e=this.renderFactory();else{if(this.state.activePage!==ht.Settings)return function(e){throw new Error("Unexpected object: "+e)}(this.state.activePage);e=this.renderSettings()}return i.a.createElement(ge.a,{fluid:!0},i.a.createElement(Ee.a,null,i.a.createElement(we.a,{xs:"2",className:be()("bg-primary",jt.a.Sidebar)},this.renderNavbar()),i.a.createElement(we.a,null,e)))}}]),t}(i.a.Component)),Ct=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={gameData:null},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.load().catch((function(t){e.setState((function(){throw t}))}))}},{key:"load",value:function(){var e,t,n,a,r;return b.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,b.a.awrap(fetch("assets/seablock-17.json"));case 2:if(200===(e=i.sent).status){i.next=5;break}throw new Error("Could not load game data, got HTTP status ".concat(e.status));case 5:return i.prev=5,i.next=8,b.a.awrap(e.json());case 8:t=i.sent,i.next=14;break;case 11:throw i.prev=11,i.t0=i.catch(5),new Error("Could not parse game data: ".concat(i.t0));case 14:if(n=new V(t),this.props.actions.replaceState({gameData:n}),a=de(n))this.props.actions.replaceState(a);else try{(r=le(n))&&this.props.actions.replaceState(r)}catch(o){console.error("Failed to load local storage state",o)}this.setState({gameData:n});case 19:case"end":return i.stop()}}),null,this,[[5,11]])}},{key:"render",value:function(){if(!this.state.gameData)return i.a.createElement("h1",null,"Loading...");var e="assets/sprite-sheet-".concat(this.state.gameData.raw.sprites.hash,".png"),t="\n        .game-icon {\n            background-image: url(".concat(e,");\n        }\n        ");return i.a.createElement(i.a.Fragment,null,i.a.createElement(Nt,null),i.a.createElement(St,{href:e}),i.a.createElement("style",null,t),i.a.createElement(kt,null))}}]),t}(i.a.Component),Nt=function(){var e=ie(),t=Object(v.a)(e,1)[0];return Object(r.useEffect)((function(){!function(e){var t=me(e),n=t.version,a=JSON.stringify(t.data);a=btoa(Object(se.deflate)(a,{to:"string"})),window.history.replaceState("","","#".concat(n,"-").concat(a))}(t),function(e){localStorage.setItem("appstate",JSON.stringify(me(e)))}(t)}),[t]),null},St=function(e){return o.createPortal(i.a.createElement("link",{rel:"prefetch",href:e.href}),document.head)},xt=oe(Ct);n(170);a.a({dsn:"https://2ab99c1e02a448cbaa06595164416044@sentry.io/1385727"}),o.render(r.createElement(f,null,r.createElement(re,null,r.createElement(xt,null))),document.getElementById("root"))},63:function(e,t,n){e.exports={RecipePicker:"RecipePicker_RecipePicker__3sU3V",ResultName:"RecipePicker_ResultName__jSE56"}},85:function(e,t,n){e.exports={crashed:"ErrorCatcher_crashed__3tour"}},88:function(e,t,n){e.exports={Icon:"Icon_Icon__377W-"}},97:function(e,t,n){e.exports={TotalCard:"TotalCard_TotalCard__2ci0q"}},98:function(e,t,n){e.exports={RecipeGroup:"RecipeGroup_RecipeGroup__3MC_F"}}},[[105,1,2]]]);
//# sourceMappingURL=main.0ce8e9ed.chunk.js.map