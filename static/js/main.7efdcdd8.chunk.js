(this.webpackJsonptscalc=this.webpackJsonptscalc||[]).push([[0],{27:function(e,t,n){e.exports={Icon:"Icon_Icon__2keyP",IconTextWrapper:"Icon_IconTextWrapper__XAsrp",IconText:"Icon_IconText__2-yWw"}},32:function(e,t,n){e.exports={RecipePicker:"RecipePicker_RecipePicker__3n7VF",ResultName:"RecipePicker_ResultName__3hgOC"}},34:function(e,t,n){e.exports={crashed:"ErrorCatcher_crashed__1kSin"}},35:function(e,t,n){e.exports={RecipePart:"RecipePart_RecipePart__1LoD1"}},36:function(e,t,n){e.exports={RecipeRow:"RecipeRow_RecipeRow__2eZjL"}},40:function(e,t,n){e.exports={TotalCard:"TotalCard_TotalCard__Xlr9v"}},41:function(e,t,n){e.exports={RecipeGroup:"RecipeGroup_RecipeGroup__3-Kbc"}},42:function(e,t,n){e.exports={Sidebar:"App_Sidebar__qsXjW"}},43:function(e,t,n){e.exports={ToastPortal:"ToastPortal_ToastPortal__hJYFr"}},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(12),o=n(9),c=n(3),s=n(5),u=n(7),l=n(8),d=n(34),p=n.n(d),h=n(0),m=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={crashMsg:void 0},e}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return t.crashMsg!==this.state.crashMsg}},{key:"componentDidCatch",value:function(e,t){this.setState({crashMsg:["Component Stack:",t.componentStack,"",e&&e.stack].join("\n")})}},{key:"render",value:function(){return this.state.crashMsg?Object(h.jsxs)("div",{className:p.a.crashed,children:[Object(h.jsx)("h1",{children:"Crashed!"}),Object(h.jsx)("pre",{children:this.state.crashMsg})]}):this.props.children}}]),n}(a.a.Component),f=n(11),b=n.n(f),j=n(18),v=Object(o.b)({key:"gameData",default:null}),O=function(){var e=Object(o.e)(v);if(!e)throw new Error("useGameData called without gameData available");return e},g=Object(o.b)({key:"recipeTarget",default:void 0}),y=Object(o.b)({key:"groupAtoms",default:[]}),x=Object(o.c)({key:"groupsState",get:function(e){var t=e.get;return t(y).map((function(e){return[t(e),e]}))}}),w=Object(o.b)({key:"settings",default:{assemblerOverrides:{}}}),k=n(6),N=n(4);function C(e,t){if(!e)throw new Error(t||"Assertion failed")}function M(e,t){for(var n={},r=0,a=Object.entries(e);r<a.length;r++){var i=Object(k.a)(a[r],2),o=i[0],c=i[1];n[o]=t(c)}return n}function S(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}function R(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function I(e,t){for(var n=0;n<t.length&&e>=1e3;n++)e/=1e3;return"".concat(R(e,2)," ").concat(t[n])}function _(e){return I(e,["J","kJ","MJ","GJ","TJ","PJ"])}function P(e,t){var n;function r(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];void 0!==n&&clearTimeout(n),n=setTimeout((function(){n=void 0,e.apply(void 0,a)}),t)}return Object.defineProperty(r,"cancel",{value:function(){void 0!==n&&(clearTimeout(n),n=void 0)}}),r}function T(e){var t=function(e){var t=e.valueOf(),n=Date.now(),r=n>t?"ago":"from now",a=Math.floor(Math.abs(n-t)/1e3);if(a>=60){var i=Math.floor(a/60),o=1===i?"minute":"minutes",c=1e3*(60-a%60);return["".concat(i," ").concat(o," ").concat(r),c]}var s=1===a?"second":"seconds";return["".concat(a," ").concat(s," ").concat(r),1e3]}(e),n=Object(k.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)(0),c=Object(k.a)(o,2),s=(c[0],c[1]);return Object(r.useEffect)((function(){var e=setInterval((function(){s((function(e){return e+1}))}),i);return function(){clearInterval(e)}}),[i]),a}function D(e,t){return t?D(t,e%t):e}function E(e,t){return C(Number.isSafeInteger(e)),C(Number.isSafeInteger(t)),{quotient:Math.floor(e/t),remainder:e%t}}var q=1e4,A=function(){function e(t,n){Object(c.a)(this,e),this.p=void 0,this.q=void 0,C(Number.isSafeInteger(t),"Numerator must be a safe integer, got ".concat(t)),C(Number.isSafeInteger(n),"Denominator must be a safe integer, got ".concat(n)),C(0!==n,"Denominator must not be zero"),n<0&&(t=-t,n=-n),0===t&&(n=1);var r=D(t,n);r>1&&(t/=r,n/=r),this.p=t,this.q=n}return Object(s.a)(e,[{key:"floor",value:function(){var t=E(this.p,this.q),n=new e(t.quotient,1);return n.less(e.zero)&&0!==t.remainder&&(n=n.sub(e.one)),n}},{key:"negate",value:function(){return new e(-this.p,this.q)}},{key:"invert",value:function(){return new e(this.q,this.p)}},{key:"add",value:function(t){return new e(this.p*t.q+this.q*t.p,this.q*t.q)}},{key:"sub",value:function(t){return new e(this.p*t.q-this.q*t.p,this.q*t.q)}},{key:"mul",value:function(t){return"number"==typeof t&&(t=e.fromFloat(t)),new e(this.p*t.p,this.q*t.q)}},{key:"div",value:function(t){return new e(this.p*t.q,this.q*t.p)}},{key:"clamp",value:function(t,n){return"number"==typeof t&&(t=e.fromFloat(t)),"number"==typeof n&&(n=e.fromFloat(n)),this.less(t)?t:n.less(this)?n:this}},{key:"divmod",value:function(e){var t=this.div(e).floor();return{quotient:t,remainder:this.sub(e.mul(t))}}},{key:"equal",value:function(e){return this.p===e.p&&this.q===e.q}},{key:"isNegative",value:function(){return this.p<0}},{key:"isPositive",value:function(){return this.p>0}},{key:"isOne",value:function(){return 1===this.p}},{key:"isZero",value:function(){return 0===this.p}},{key:"less",value:function(e){return this.p*e.q<this.q*e.p}},{key:"toFloat",value:function(){return this.p/this.q}},{key:"toString",value:function(){return this.toFraction()}},{key:"toFraction",value:function(){return 1===this.q?this.p.toString():this.p.toString()+"/"+this.q.toString()}},{key:"toDecimal",value:function(t,n){null==t&&(t=3),null==n&&(n=new e(5,Math.pow(10,t+1)));var r="",a=this;a.isNegative()&&(r="-",a=a.negate());for(var i=E((a=a.add(n)).p,a.q),o=i.quotient.toString(),c="",s=new e(i.remainder,a.q),u=new e(10,1);t>0&&!s.equal(n);){s=s.mul(u),n=n.mul(u);var l=E(s.p,s.q);c+=l.quotient.toString(),s=new e(l.remainder,s.q),t--}if(s.equal(n))for(;"0"===c[c.length-1];)c=c.slice(0,c.length-1);return""!==c?r+o+"."+c:r+o}},{key:"toMixed",value:function(){if(this.isZero())return"0";var t=this.divmod(e.one),n=t.quotient,r=t.remainder,a=[];return n.isZero()||a.push(n.toFraction()),r.isZero()||a.push(r.toFraction()),a.join(" + ")}}],[{key:"fromFloat",value:function(t){if(Number.isInteger(t))return new this(t,1);var n,r=new e(Math.round(t*q),q),a=r.divmod(e.one),i=Object(N.a)(F);try{for(i.s();!(n=i.n()).done;){var o=Object(k.a)(n.value,2),c=o[0],s=o[1];if(a.remainder.equal(c))return a.quotient.add(s)}}catch(u){i.e(u)}finally{i.f()}return r}},{key:"fromInts",value:function(e,t){return new this(e,t)}},{key:"fromString",value:function(t){var n,r=e.zero,a=Object(N.a)(t.split("+"));try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i=i.trim()){var o=i.indexOf("/");if(-1===o)r=r.add(e.fromFloat(Number(i)));else{var c=Number(i.slice(0,o)),s=Number(i.slice(o+1));r=r.add(e.fromInts(c,s))}}}}catch(u){a.e(u)}finally{a.f()}return r}}]),e}();A.zero=new A(0,1),A.one=new A(1,1),A.oneThird=new A(1,3),A.twoThirds=new A(2,3);for(var F=[],B=2;B<100;B++)for(var U=1;U<B;U++){var W=U/B;if(!(W.toString().length<10)){var G=new A(Math.round(W*q),q);F.push([G,A.fromInts(U,B)]);var L=new A(Math.floor(W*q),q);F.push([L,A.fromInts(U,B)])}}var V=n(2),H=n(44),J=n(15),z=function(){function e(t){Object(c.a)(this,e),this.name=void 0,this.localisedName=void 0,this.iconCol=void 0,this.iconRow=void 0,this.name=t.name,this.localisedName=t.localised_name,this.iconCol=t.icon_col,this.iconRow=t.icon_row}return Object(s.a)(e,[{key:"niceName",get:function(){return this.localisedName.en}}]),e}(),K=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r,a;return Object(c.a)(this,n),(a=t.call(this,e)).group=void 0,a.subgroup=void 0,a.order=void 0,a.fuelValue=void 0,a.usedBy=[],a.madeBy=[],a.group=e.group,a.subgroup=e.subgroup,a.order=e.order,a.fuelValue=null!==(r=e.fuel_value)&&void 0!==r?r:null,a}return n}(z),Z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).type=void 0,r.limitedTo=void 0,r.effects=void 0,r.type=e.type,r.limitedTo=new Set(e.limitation),r.effects={speed:A.fromFloat((e.effect.speed||{bonus:0}).bonus),productivity:A.fromFloat((e.effect.productivity||{bonus:0}).bonus),consumption:A.fromFloat((e.effect.consumption||{bonus:0}).bonus),pollution:A.fromFloat((e.effect.pollution||{bonus:0}).bonus)},r}return Object(s.a)(n,[{key:"canUseWith",value:function(e){return 0===this.limitedTo.size||this.limitedTo.has(e.name)}}]),n}(K),Q=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).defaultTemperature=void 0,r.type="fluid",r.defaultTemperature=e.default_temperature,r}return n}(K),X=function(){function e(t,n){var r;Object(c.a)(this,e),this.type=void 0,this.name=void 0,this.amount=void 0,this.item=void 0,this.name=t.name,this.amount=A.fromFloat(t.amount),this.type=null!==(r=t.type)&&void 0!==r?r:"item",this.item=n.getItem(t.name)}return Object(s.a)(e,[{key:"niceName",get:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName)}}]),e}(),Y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e,r)).type="fluid",a.item=void 0,a.minimumTemperature=void 0,a.maximumTemperature=void 0,a.item=r.getFluid(e.name),a.minimumTemperature=e.minimum_temperature||-1/0,a.maximumTemperature=e.maximum_temperature||1/0,a.maximumTemperature>=1797e305&&(a.maximumTemperature=1/0),a.minimumTemperature<=-1797e305&&(a.minimumTemperature=-1/0),a}return Object(s.a)(n,[{key:"niceName",get:function(){var e=this.minimumTemperature,t=this.maximumTemperature,n="";return e!==-1/0&&t!==1/0?n=" (".concat(e,"\xb0 \u2013 ").concat(t,"\xb0)"):t!==1/0?n=" (\u2264 ".concat(t,"\xb0)"):e!==-1/0&&(n=" (\u2265 ".concat(t,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName).concat(n)}}]),n}(X),$=function(){function e(t,n){var r;Object(c.a)(this,e),this.name=void 0,this.item=void 0,this.amount=void 0,this.name=t.name,this.item=n.getItem(t.name),r="amount"in t?A.fromFloat(t.amount):A.fromInts(t.amount_min+t.amount_max,2),"number"==typeof t.probability&&(0===t.probability?r=A.zero:1!==t.probability&&(C(t.probability>0),C(t.probability<1),r=r.mul(A.fromFloat(t.probability)))),this.amount=r}return Object(s.a)(e,[{key:"niceName",get:function(){return"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName)}},{key:"satisfies",value:function(e){return e.item===this.item}}]),e}(),ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e,r)).item=void 0,a.temperature=void 0,a.item=r.getFluid(e.name),a.temperature=e.temperature||a.item.defaultTemperature,a}return Object(s.a)(n,[{key:"niceName",get:function(){var e="";return this.temperature!==this.item.defaultTemperature&&(e=" (".concat(this.temperature,"\xb0)")),"".concat(this.amount.toDecimal()," \xd7 ").concat(this.item.niceName).concat(e)}},{key:"satisfies",value:function(e){return e.item===this.item&&e instanceof Y&&e.maximumTemperature>=this.temperature&&e.minimumTemperature<=this.temperature}}]),n}($),te=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this,e)).category=void 0,a.ingredients=void 0,a.products=void 0,a.craftingTime=void 0,a.madeIn=[],a.category=e.category,a.craftingTime=A.fromFloat(e.energy_required),a.ingredients=e.ingredients.map((function(e){return"fluid"===e.type?new Y(e,r):new X(e,r)})),a.products=e.results.map((function(e){return"fluid"===e.type?new ee(e,r):new $(e,r)})),a}return Object(s.a)(n,[{key:"niceName",get:function(){if(1!==this.products.length)return Object(H.a)(Object(J.a)(n.prototype),"niceName",this);var e=this.products[0];return C(e,"recipe has no products"),e.amount.equal(A.one)?e.item.niceName:e.niceName}}]),n}(z),ne=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).craftingCategories=void 0,r.craftingSpeed=void 0,r.moduleSlots=void 0,r.craftingCategories=e.crafting_categories,r.craftingSpeed=e.crafting_speed,r.moduleSlots=e.module_slots,r}return Object(s.a)(n,[{key:"canBuildRecipe",value:function(e){return-1!==this.craftingCategories.indexOf(e.category)}}]),n}(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return n}(z)),re=function(){function e(t){Object(c.a)(this,e),this.itemMap=new Map,this.fluids=[],this.fluidMap=new Map,this.modules=[],this.moduleMap=new Map,this.recipes=[],this.recipeMap=new Map,this.entityMap=new Map,this.categoryMap=void 0,this.groups=void 0,this.clockSprite=void 0,this.noModuleModule=void 0,this.spriteHash=void 0,this.activeMods=void 0,this.activeMods=t.active_mods,this.spriteHash=t.sprites.hash;for(var n=0,r=Object.values(t["assembling-machine"]);n<r.length;n++){var a=r[n],i=new ne(a);this.entityMap.set(i.name,i)}for(var o=0,s=Object.values(t.furnace);o<s.length;o++){var u=s[o],l=new ne(u);this.entityMap.set(l.name,l)}for(var d=0,p=Object.values(t["rocket-silo"]);d<p.length;d++){var h=p[d],m=new ne(h);this.entityMap.set(m.name,m)}for(var f=0,b=Object.values(t["mining-drill"]);f<b.length;f++){var j=b[f],v=Object(V.a)(Object(V.a)({},j),{},{crafting_categories:j.resource_categories.map((function(e){return"resource-"+e})),crafting_speed:j.mining_speed,ingredient_count:1}),O=new ne(v);this.entityMap.set(v.name,O)}for(var g=0,y=Object.values(t.items);g<y.length;g++){var x=y[g];if("type"in x&&"fluid"===x.type){var w=new Q(x);this.itemMap.set(w.name,w),this.fluids.push(w),this.fluidMap.set(w.name,w)}else if("type"in x&&"module"===x.type){var k=new Z(x);this.itemMap.set(k.name,k),this.modules.push(k),this.moduleMap.set(k.name,k)}else{var M=new K(x);this.itemMap.set(M.name,M)}}for(var S=[],R=0,I=Object.values(t.recipes);R<I.length;R++){var _=I[R];S.push(new te(_,this))}for(var P=0,T=Object.values(t.resource);P<T.length;P++){var D=T[P],E="resource-".concat(D.category),q=[],A=D.minable,F=A.fluid_amount,B=A.required_fluid;F&&B&&q.push({name:B,type:"fluid",amount:F/10}),S.push(new te({name:"resource-".concat(D.name),localised_name:D.localised_name,category:E,energy_required:D.minable.mining_time,group:E,subgroup:E,icon_col:D.icon_col,icon_row:D.icon_row,ingredients:q,results:D.minable.results,type:"recipe",order:"A"},this))}for(var U=0,W=S;U<W.length;U++){var G,L=W[U],H=Object(N.a)(this.entityMap.values());try{for(H.s();!(G=H.n()).done;){var J=G.value;"canBuildRecipe"in J&&J.canBuildRecipe(L)&&L.madeIn.push(J)}}catch(ie){H.e(ie)}finally{H.f()}if(L.madeIn.length){if(L.products.some((function(e){return e.amount.isPositive()}))){var X,Y=Object(N.a)(L.ingredients);try{for(Y.s();!(X=Y.n()).done;){X.value.item.usedBy.push(L)}}catch(ie){Y.e(ie)}finally{Y.f()}var $,ee=Object(N.a)(L.products);try{for(ee.s();!($=ee.n()).done;){$.value.item.madeBy.push(L)}}catch(ie){ee.e(ie)}finally{ee.f()}this.recipes.push(L),this.recipeMap.set(L.name,L)}}else console.warn("Ignoring uncraftable recipe: ".concat(L.name))}this.categoryMap=function(e){var t,n={},r=Object(N.a)(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=Object(N.a)(i.craftingCategories);try{for(o.s();!(a=o.n()).done;){var c=a.value,s=n[c];s?s.push(i):n[c]=[i]}}catch(ie){o.e(ie)}finally{o.f()}}}catch(ie){r.e(ie)}finally{r.f()}return n}(this.entityMap.values()),this.groups=t.groups;var re=t.sprites.extra.clock;C(re,"missing clock sprite");var ae=t.sprites.extra.slot_icon_module;C(ae,'missing "no icon" sprite'),this.clockSprite=new z(Object(V.a)(Object(V.a)({},re),{},{name:"clock",localised_name:{en:"Clock"}})),this.noModuleModule=new Z(Object(V.a)(Object(V.a)({},ae),{},{type:"module",name:"no_module",localised_name:{en:"No Module"},category:"speed",effect:{},limitation:[],rocket_launch_products:[],group:"",subgroup:"",order:""}))}return Object(s.a)(e,[{key:"getEntity",value:function(e){var t=this.entityMap.get(e);return C(t,"no entity with name: ".concat(e)),t}},{key:"getFluid",value:function(e){var t=this.fluidMap.get(e);return C(t,"no fluid with name: ".concat(e)),t}},{key:"getItem",value:function(e){var t=this.itemMap.get(e);return C(t,"no item with name: ".concat(e)),t}},{key:"getModule",value:function(e){var t=this.moduleMap.get(e);return C(t,"no module with name: ".concat(e)),t}},{key:"getRecipe",value:function(e){var t=this.recipeMap.get(e);return C(t,"no recipe with name: ".concat(e)),t}},{key:"getItemOrder",value:function(e){var t="",n="",r=this.groups[e.group];return r&&(t=r.order,n=r.subgroups[e.subgroup]||""),[t,n,e.order,e.name]}},{key:"sortByItem",value:function(e,t){var n=this;e.sort((function(e,r){var a=n.getItemOrder(t(e)),i=n.getItemOrder(t(r));for(var o in a){var c=a[o],s=i[o];if(c>s)return 1;if(c<s)return-1}return 0}))}}]),e}();function ae(e,t,n){var r,a=e instanceof te?e.category:e;return C(r=a in t.assemblerOverrides?t.assemblerOverrides[a]:n.categoryMap[a][0]),e instanceof te&&C(-1!==e.madeIn.indexOf(r)),r}var ie=n(29),oe=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],ce=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function se(e){var t=ce[e];if(255===t||void 0===t)throw new Error("Unable to parse base64 string.");return t}function ue(e){var t,n="",r=e.length;for(t=2;t<r;t+=3)n+=oe[e[t-2]>>2],n+=oe[(3&e[t-2])<<4|e[t-1]>>4],n+=oe[(15&e[t-1])<<2|e[t]>>6],n+=oe[63&e[t]];return t===r+1&&(n+=oe[e[t-2]>>2],n+=oe[(3&e[t-2])<<4],n+="=="),t===r&&(n+=oe[e[t-2]>>2],n+=oe[(3&e[t-2])<<4|e[t-1]>>4],n+=oe[(15&e[t-1])<<2],n+="="),n}function le(e){if(e.length%4!==0)throw new Error("Unable to parse base64 string.");var t=e.indexOf("=");if(-1!==t&&t<e.length-2)throw new Error("Unable to parse base64 string.");for(var n,r=e.endsWith("==")?2:e.endsWith("=")?1:0,a=e.length,i=new Uint8Array(a/4*3),o=0,c=0;o<a;o+=4,c+=3)n=se(e.charCodeAt(o))<<18|se(e.charCodeAt(o+1))<<12|se(e.charCodeAt(o+2))<<6|se(e.charCodeAt(o+3)),i[c]=n>>16,i[c+1]=n>>8&255,i[c+2]=255&n;return i.subarray(0,i.length-r)}new TextEncoder;new TextDecoder;function de(e){return{name:e.name,rows:e.rows.map((function(e){return[e[0],e[1],e[2].toString(),e[3],e[4],e[5]]}))}}var pe="tscalc-".concat(document.location.pathname);function he(e,t){return{version:5,data:{groups:e.groups.map((function(n){return{name:n.name,rows:n.rows.map((function(n){var r=n.machine.name;return ae(n.recipe,e.settings,t).name===r&&(r=null),[n.recipe.name,r,n.numMachines.toFraction(),n.modules.map((function(e){return e?e.name:null})),n.beaconModule?n.beaconModule.name:void 0,n.numBeacons]}))}})),settings:{assemblerOverrides:M(e.settings.assemblerOverrides,(function(e){return e.name}))}}}}var me=/^#(\d+)?(?:-)?(.+)$/;function fe(e){switch(e.version){case 1:e=function(e){return{version:2,data:{rows:e.data,settings:{assemblerOverrides:{}}}}}(e);case 2:e=function(e){return{version:3,data:e.data}}(e);case 3:e=function(e){return{version:4,data:{settings:e.data.settings,groups:[{name:"Factory 1",rows:e.data.rows}]}}}(e);case 4:e=function(e){return{version:5,data:{settings:e.data.settings,groups:e.data.groups.map(de)}}}(e);case 5:break;default:throw new Error("unknown state: ".concat(e))}return e}function be(e,t){var n=fe(t).data,r={settings:je(e,n.settings),groups:[]};return r.groups=n.groups.map((function(t){return{name:t.name,rows:t.rows.map((function(t){var n=Object(k.a)(t,6),a=n[0],i=n[1],o=n[2],c=n[3],s=n[4],u=n[5],l=e.getRecipe(a);return{recipe:l,machine:i?e.getEntity(i):ae(l,r.settings,e),numMachines:A.fromString(o),modules:c.map((function(t){return t?e.getModule(t):null})),beaconModule:s?e.getModule(s):null,numBeacons:u||0}}))}})),r}function je(e,t){return{assemblerOverrides:M(t.assemblerOverrides,(function(t){return e.getEntity(t)}))}}var ve=function(){function e(){var t=this;Object(c.a)(this,e),this.handlers=[],this.dispatch=function(e){var n,r=Object(N.a)(t.handlers);try{for(r.s();!(n=r.n()).done;){(0,n.value)(e)}}catch(a){r.e(a)}finally{r.f()}}}return Object(s.a)(e,[{key:"addHandler",value:function(e){-1===this.handlers.indexOf(e)&&this.handlers.push(e)}},{key:"removeHandler",value:function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)}}]),e}(),Oe=new ve,ge=new ve,ye=new ve,xe=new ve;var we=n(17),ke=n.n(we),Ne=n(10),Ce=n(21),Me=0,Se=function(){var e=Object(o.f)(y);return Object(r.useCallback)((function(t){var n=Object(o.b)({key:"group-".concat(++Me),default:t});return e((function(e){return[].concat(Object(Ne.a)(e),[n])})),n}),[e])},Re=function(){function e(t){if(Object(c.a)(this,e),this.ingredients=[],this.products=[],t&&t.length){var n,r=Object(N.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.addRow(a)}}catch(i){r.e(i)}finally{r.f()}}}return Object(s.a)(e,[{key:"addIngredient",value:function(e){var t,n=Object(N.a)(this.ingredients);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.name===e.name&&(!(e instanceof Y&&r instanceof Y)||e.maximumTemperature===r.maximumTemperature&&e.minimumTemperature===r.minimumTemperature))return void(r.amount=r.amount.add(e.amount))}}catch(c){n.e(c)}finally{n.f()}var a,i=Object(N.a)(this.products);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(o.satisfies(e)){if(!o.amount.less(e.amount)){o.amount=o.amount.sub(e.amount),e.amount=A.zero;break}if(e.amount=e.amount.sub(o.amount),o.amount=A.zero,e.amount.isZero())break}}}catch(c){i.e(c)}finally{i.f()}this.ingredients.push(e),this.ingredients=this.ingredients.filter((function(e){return!e.amount.isZero()})),this.products=this.products.filter((function(e){return!e.amount.isZero()}))}},{key:"addProduct",value:function(e){var t,n=Object(N.a)(this.products);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e.name===r.name&&!(e instanceof ee&&r instanceof ee&&e.temperature!==r.temperature))return void(r.amount=r.amount.add(e.amount))}}catch(c){n.e(c)}finally{n.f()}var a,i=Object(N.a)(this.ingredients);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(e.satisfies(o)){if(e.amount.less(o.amount)){o.amount=o.amount.sub(e.amount),e.amount=A.zero;break}if(e.amount=e.amount.sub(o.amount),o.amount=A.zero,e.amount.isZero())break}}}catch(c){i.e(c)}finally{i.f()}this.products.push(e),this.ingredients=this.ingredients.filter((function(e){return!e.amount.isZero()})),this.products=this.products.filter((function(e){return!e.amount.isZero()}))}},{key:"addRow",value:function(e){var t,n={consumption:A.one,pollution:A.one,productivity:A.one,speed:A.one},r=Object(N.a)(e.modules);try{for(r.s();!(t=r.n()).done;){var a=t.value;a&&(n.consumption=n.consumption.add(a.effects.consumption),n.pollution=n.pollution.add(a.effects.pollution),n.productivity=n.productivity.add(a.effects.productivity),n.speed=n.speed.add(a.effects.speed))}}catch(f){r.e(f)}finally{r.f()}if(e.beaconModule&&e.numBeacons>0){var i=e.beaconModule.effects,o=A.fromInts(e.numBeacons,2);n.consumption=n.consumption.add(i.consumption.mul(o)),n.pollution=n.pollution.add(i.pollution.mul(o)),n.productivity=n.productivity.add(i.productivity.mul(o)),n.speed=n.speed.add(i.speed.mul(o))}n.consumption=n.consumption.clamp(.2,32767),n.pollution=n.pollution.clamp(.2,32767),n.speed=n.speed.clamp(.2,32767),n.productivity=n.productivity.clamp(1,32767);var c,s=A.one.mul(e.recipe.craftingTime.invert()).mul(e.numMachines).mul(e.machine.craftingSpeed).mul(n.speed),u=s.mul(n.productivity),l=Object(N.a)(e.recipe.ingredients.map((function(e){return(e=S(e)).amount=e.amount.mul(s),e})));try{for(l.s();!(c=l.n()).done;){var d=c.value;this.addIngredient(d)}}catch(f){l.e(f)}finally{l.f()}var p,h=Object(N.a)(e.recipe.products.map((function(e){return(e=S(e)).amount=e.amount.mul(u),e})));try{for(h.s();!(p=h.n()).done;){var m=p.value;this.addProduct(m)}}catch(f){h.e(f)}finally{h.f()}}}]),e}(),Ie=n(26),_e=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).buttonRef=r.createRef(),e.state={isOpen:!1},e.handleClick=function(t){e.getCanToggle()&&(t.stopPropagation(),e.setState((function(e){return Object(V.a)(Object(V.a)({},e),{},{isOpen:!e.isOpen})})))},e.handleSelect=function(t){e.props.onSelect(t),e.setState({isOpen:!1})},e.handleWantClose=function(){e.setState({isOpen:!1})},e}return Object(s.a)(n,[{key:"getCanToggle",value:function(){var e,t=Object(N.a)(this.props.options);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("option"in n&&!n.disabled)return!0}}catch(r){t.e(r)}finally{t.f()}return!1}},{key:"render",value:function(){var e,t=["btn","btn-secondary"];return this.getCanToggle()?t.push("dropdown-toggle"):t.push("disabled"),this.state.isOpen&&(e=Object(h.jsx)(Pe,{parentRef:this.buttonRef,options:this.props.options,renderOption:this.props.renderOption,onSelect:this.handleSelect,onWantClose:this.handleWantClose})),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("button",{ref:this.buttonRef,className:t.join(" "),type:"button",onClick:this.handleClick,children:this.props.renderSelected(this.props.selected)}),e]})}}]),n}(r.PureComponent),Pe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).popperInstance=null,e.menuRef=r.createRef(),e.state={style:{}},e.popperUpdate=function(t){return e.setState({style:t.styles}),t},e.handleBodyClick=function(t){t.target instanceof Node?(C(e.menuRef.current),e.menuRef.current.contains(t.target)||e.props.onWantClose()):console.warn("handleBodyClick called for non-node",t.target)},e.handleKeyEvent=function(t){27===t.keyCode&&e.props.onWantClose()},e.renderOptions=function(){return e.props.options.map((function(t,n){if("header"in t)return Object(h.jsx)("h6",{className:"dropdown-header",children:t.header},"ddkey"+n);if("divider"in t)return Object(h.jsx)("div",{className:"dropdown-divider"},"ddkey"+n);var r=["dropdown-item"];return t.active&&r.push("active"),t.disabled&&r.push("disabled"),Object(h.jsx)("button",{className:r.join(" "),onClick:function(){return e.props.onSelect(t.option)},type:"button",children:e.props.renderOption(t.option)},t.key)}))},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){if(this.popperInstance)throw new Error("Component mounted twice?");var e=this.props.parentRef.current;if(!e)throw new Error("Cannot mount DropdownMenu without parentRef");var t=this.menuRef.current;if(!t)throw new Error("Cannot mount DropdownMenu without menuRef");this.popperInstance=new Ie.a(e,t,{modifiers:{applyStyle:{enabled:!1},updateStateWithStyle:{enabled:!0,fn:this.popperUpdate}}}),document.body.addEventListener("click",this.handleBodyClick),document.body.addEventListener("keyup",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null),document.body.removeEventListener("click",this.handleBodyClick),document.body.removeEventListener("keyup",this.handleKeyEvent)}},{key:"render",value:function(){return Object(h.jsx)("div",{className:"dropdown-menu show",style:this.state.style,ref:this.menuRef,children:this.renderOptions()})}}]),n}(r.PureComponent),Te={zIndex:1001},De=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).selfRef=void 0,a.popperInstance=void 0,a.handleMouseEnter=function(){a.setState({showSelf:!0})},a.handleMouseLeave=function(){a.setState({showSelf:!1})},a.selfRef=r.createRef(),a.popperInstance=null,a.state={showSelf:!1},a}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.relativeTo!==e.relativeTo||this.state.showSelf!==t.showSelf||this.state.showSelf&&this.props.content!==e.content}},{key:"initPopper",value:function(){if(!this.popperInstance){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");var t=this.selfRef.current;if(!t)throw new Error("No self reference yet?");this.popperInstance=new Ie.a(e,t,{placement:"right",modifiers:{offset:{enabled:!0,offset:"0, 20"},preventOverflow:{enabled:!0,boundariesElement:"window"}}})}}},{key:"cleanupPopper",value:function(){this.popperInstance&&(this.popperInstance.disableEventListeners(),this.popperInstance=null)}},{key:"componentDidUpdate",value:function(e,t){t.showSelf!==this.state.showSelf&&(this.state.showSelf?this.initPopper():this.cleanupPopper())}},{key:"componentDidMount",value:function(){var e=this.props.relativeTo.current;if(!e)throw new Error("Invalid relativeTo");e.addEventListener("mouseenter",this.handleMouseEnter),e.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"componentWillUnmount",value:function(){var e=this.props.relativeTo.current;e&&(e.removeEventListener("mouseenter",this.handleMouseEnter),e.removeEventListener("mouseleave",this.handleMouseLeave))}},{key:"render",value:function(){return this.state.showSelf?i.createPortal(Object(h.jsx)("div",{style:Te,ref:this.selfRef,children:this.props.content()}),document.body):null}}]),n}(r.Component),Ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).handleChange=function(e){var t,n=e.target.value,a=n.trim()?Number(n):NaN;Number.isNaN(a)?t="Improperly formatted number":Number.isInteger(a)?"number"===typeof r.props.min&&a<r.props.min&&(t=0===r.props.min?"Must be positive":"Must be greater than ".concat(r.props.min)):t="Must be an integer",r.setState({txtValue:n,errMsg:t},(function(){"number"!==typeof a||t||r.props.onChange(a)}))},r.state={txtValue:e.value.toString(),errMsg:void 0},r}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.value!==e.value||this.props.min!==e.min||this.state.txtValue!==t.txtValue||this.state.errMsg!==t.errMsg}},{key:"componentDidUpdate",value:function(e){var t=this;e.value!==this.props.value&&this.setState((function(e){return{txtValue:Number(e.txtValue)===t.props.value?e.txtValue:t.props.value.toString()}}))}},{key:"render",value:function(){var e="form-control";return this.state.errMsg&&(e+=" is-invalid"),Object(h.jsx)("input",{className:e,value:this.state.txtValue,onChange:this.handleChange,type:"number",min:this.props.min,step:"1"})}}]),n}(r.Component),qe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).handleChange=function(e){var t,n,a=e.target.value;try{n=Ae(a)}catch(i){t=i.message}n&&r.props.positiveOnly&&n.isNegative()&&(n=void 0,t="Number must be positive"),r.setState({txtValue:a,error:t},(function(){n&&r.props.onChange(n)}))},r.state={error:void 0,txtValue:Fe(e.value)},r}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e){if(!this.props.value.equal(e.value)){var t;try{t=Ae(this.state.txtValue)}catch(n){return}t.equal(this.props.value)||this.setState({txtValue:Fe(this.props.value)})}}},{key:"render",value:function(){return Object(h.jsx)("input",{className:ke()("form-control",{"is-invalid":!!this.state.error}),value:this.state.txtValue,onChange:this.handleChange,type:"text"})}}]),n}(r.PureComponent);function Ae(e){if(!e.trim())throw new Error("Empty!");if(e.indexOf("/")!==e.lastIndexOf("/"))throw new Error("Too many slashes");return A.fromString(e)}function Fe(e){var t=e.toFloat().toString();return t.length<10?t:e.toMixed()}var Be=n(27),Ue=n.n(Be),We=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).iconRef=a.a.createRef(),e}return Object(s.a)(n,[{key:"render",value:function(){var e=32*-this.props.obj.iconCol,t=32*-this.props.obj.iconRow,n={backgroundPosition:"".concat(e,"px ").concat(t,"px")},r=Object(h.jsx)("div",{ref:this.iconRef,onClick:this.props.onClick,title:this.props.title,className:ke()(Ue.a.Icon,"game-icon",this.props.className),style:n,children:"\xa0"});return this.props.tooltip&&(r=Object(h.jsxs)(h.Fragment,{children:[r,Object(h.jsx)(De,{content:this.props.tooltip,relativeTo:this.iconRef})]})),this.props.text&&(r=Object(h.jsxs)("div",{className:Ue.a.IconTextWrapper,children:[r,Object(h.jsx)("span",{className:Ue.a.IconText,children:this.props.text})]})),r}}]),n}(a.a.PureComponent),Ge=function(e){var t,n,r=e.obj;if(r.item.fuelValue){var a=_(r.amount.mul(r.item.fuelValue).toFloat());t=Object(h.jsxs)("div",{className:"list-group-item",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"Fuel value"}),": ",_(r.item.fuelValue)]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"Total fuel value"}),": ",a]})]})}return n=1===r.item.madeBy.length?Object(h.jsx)("div",{className:"list-group-item",children:"Made by 1 recipe"}):Object(h.jsxs)("div",{className:"list-group-item",children:["Made by ",r.item.madeBy.length," recipes"]}),Object(h.jsxs)("div",{className:"card",children:[Object(h.jsxs)("div",{className:"card-header",children:[r.niceName," (",r.item.name,")"]}),Object(h.jsxs)("div",{className:"list-group list-group-flush",children:[t,n]})]})},Le=n(35),Ve=n.n(Le),He=function(e){var t=e.obj,n=e.showName,a=Object(o.d)(g),i=Object(k.a)(a,2),c=i[0],s=i[1],u=Object(r.useCallback)((function(e){if(e.shiftKey)return e.preventDefault(),e.stopPropagation(),void s({item:t.item,amount:t.amount});t instanceof X?1===t.item.madeBy.length?ye.dispatch(t.item.madeBy[0]):Oe.dispatch(t):1===t.item.usedBy.length?ye.dispatch(t.item.usedBy[0]):ge.dispatch(t)}),[t,s]),l=function(e){var t,n=e.toDecimal().toString();t=n.includes(".")&&n.length>4?Object(h.jsx)("abbr",{title:e.toFraction(),children:e.toDecimal()}):n;return Object(h.jsxs)(h.Fragment,{children:[t," / sec"]})}(t.amount);n&&(l=Object(h.jsxs)(h.Fragment,{children:[t.item.niceName," \u2014 ",l]}));var d=c&&c.item===t.item&&c.amount.equal(t.amount)?"copy-source":"";return Object(h.jsx)(We,{className:"".concat(Ve.a.RecipePart," ").concat(d),onClick:u,tooltip:function(){return Object(h.jsx)(Ge,{obj:t})},obj:t.item,text:l})};var Je=function(e){return Object(h.jsx)("div",{className:"machine-card card",children:Object(h.jsxs)("div",{className:"card-body",children:[Object(h.jsx)("b",{children:e.machine.niceName}),Object(h.jsx)("br",{}),Object(h.jsx)("b",{children:"Crafting Speed:"})," ",e.machine.craftingSpeed,Object(h.jsx)("br",{}),Object(h.jsx)("b",{children:"Module Slots:"})," ",e.machine.moduleSlots]})})},ze=function(e){var t=e.recipe,n=e.onClick,r=O(),a=t.ingredients.map((function(e){return Object(h.jsx)(We,{obj:e.item,text:e.niceName},e.name)})),i=t.products.map((function(e){return Object(h.jsx)(We,{obj:e.item,text:e.niceName},e.name)})),o=t.madeIn.map((function(e){return Object(h.jsx)(We,{obj:e,tooltip:function(){return Object(h.jsx)(Je,{machine:e})}},e.name)}));return Object(h.jsxs)("div",{className:"recipe-tooltip card",onClick:function(){n&&n(t)},children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)(We,{obj:t,text:"".concat(t.niceName," (Recipe)")})}),Object(h.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(h.jsxs)("li",{className:"list-group-item",children:[Object(h.jsx)("b",{children:"Ingredients:"}),a,Object(h.jsx)(We,{obj:r.clockSprite,text:Object(h.jsxs)("span",{children:[Object(h.jsxs)("b",{children:[t.craftingTime.toDecimal()," s"]})," Crafting time"]})})]}),Object(h.jsxs)("li",{className:"list-group-item",children:[Object(h.jsx)("b",{children:"Products:"}),i]}),Object(h.jsxs)("li",{className:"list-group-item",children:[Object(h.jsx)("b",{children:"Made In:"}),Object(h.jsx)("br",{}),o]})]})]})},Ke=function(e){return Object(h.jsx)(We,{obj:e,tooltip:function(){return Object(h.jsx)(Je,{machine:e})}})},Ze=function(e){return Object(h.jsx)(We,{obj:e,tooltip:function(){return Object(h.jsx)(Je,{machine:e})},text:e.niceName})},Qe=function(e){var t=e.machines.map((function(t){return{key:t.name,option:t,active:t===e.selected}}));return Object(h.jsx)(_e,{options:t,selected:e.selected,onSelect:e.onChange,renderOption:Ze,renderSelected:Ke})};function Xe(e,t){return t.isZero()?null:Object(h.jsx)("div",{children:Object(h.jsxs)("b",{children:[e," ",R(100*t.toFloat(),2),"%"]})})}var Ye=function(e){var t=e.module;return Object(h.jsxs)("div",{className:"module-card card",children:[Object(h.jsx)("div",{className:"card-header",children:Object(h.jsx)("b",{children:t.niceName})}),Object(h.jsxs)("div",{className:"card-body",children:[Xe("Speed",t.effects.speed),Xe("Productivity",t.effects.productivity),Xe("Energy Consumption",t.effects.consumption),Xe("Pollution",t.effects.pollution)]})]})},$e=function(e){var t=O(),n=t.modules.filter((function(t){return(!e.isBeacon||!t.effects.productivity.isPositive())&&t.canUseWith(e.recipe)})).map((function(t){return{key:t.name,option:t,active:t===e.selected}}));return n.unshift({key:"no_module",option:null,active:!e.selected}),Object(h.jsx)(_e,{options:n,selected:e.selected,onSelect:e.onChange,renderOption:function(e){return e?Object(h.jsx)(We,{obj:e,tooltip:function(){return Object(h.jsx)(Ye,{module:e})},text:e.niceName}):Object(h.jsx)(We,{obj:t.noModuleModule,text:t.noModuleModule.niceName})},renderSelected:function(e){return e?Object(h.jsx)(We,{obj:e,tooltip:function(){return Object(h.jsx)(Ye,{module:e})}}):Object(h.jsx)(We,{obj:t.noModuleModule})}})},et=n(36),tt=n.n(et),nt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleRemoveRow=function(){e.props.onRemoveRow(e.props.data.recipe)},e.handleMachineChange=function(t){e.applyChange({machine:t,modules:e.props.data.modules.filter((function(e){return null!==e})).slice(0,t.moduleSlots)})},e.handleNumMachinesChange=function(t){e.applyChange({numMachines:t})},e.handleNumBeaconsChange=function(t){e.applyChange({numBeacons:t})},e.handleSetAllModules=function(){e.applyChange({modules:new Array(e.props.data.machine.moduleSlots).fill(e.props.data.modules[0])})},e.handleSetModule=function(t,n){var r=e.props.data.modules.slice();r[t]=n,e.applyChange({modules:r})},e.handleSetBeaconModule=function(t){e.applyChange({beaconModule:t})},e.handleInputGroupClick=function(t){var n=e.props.recipeTarget;if(t.shiftKey&&n){t.preventDefault(),t.stopPropagation();var r,a=new Re;if(a.addRow(Object(V.a)(Object(V.a)({},e.props.data),{},{numMachines:A.one})),r=(r=a.ingredients.find((function(e){return e.item.name===n.item.name})))||a.products.find((function(e){return e.item.name===n.item.name}))){var i=n.amount.div(r.amount);e.applyChange({numMachines:i})}else console.error("Could not find ".concat(n.item.name," in totals"),a)}},e}return Object(s.a)(n,[{key:"applyChange",value:function(e){this.props.onUpdateRow(Object(V.a)(Object(V.a)({},this.props.data),e))}},{key:"getOutput",value:function(){var e=new Re;return e.addRow(this.props.data),e}},{key:"renderModules",value:function(){for(var e=this,t=this.props.data.machine.moduleSlots,n=[],r=function(t){var r=e.props.data.modules[t]||null;n.push(Object(h.jsx)($e,{recipe:e.props.data.recipe,selected:r,onChange:function(n){return e.handleSetModule(t,n)}},t))},a=0;a<t;a++)r(a);return t>1&&n.splice(1,0,Object(h.jsx)("button",{onClick:this.handleSetAllModules,className:"btn",children:"\u2192"},"applicator")),n.length>0?Object(h.jsx)("div",{className:"mb-3 btn-group btn-icon-wrapper",role:"group",children:n}):void 0}},{key:"renderBeacons",value:function(){return Object(h.jsx)("div",{className:"btn-toolbar",children:Object(h.jsxs)("div",{className:"input-group",children:[Object(h.jsx)("div",{className:"input-group-prepend",children:Object(h.jsx)("span",{className:"input-group-text",children:"Beacon Modules"})}),Object(h.jsx)(Ee,{value:this.props.data.numBeacons,onChange:this.handleNumBeaconsChange,min:0}),Object(h.jsx)("div",{className:"input-group-append btn-icon-wrapper",children:Object(h.jsx)($e,{isBeacon:!0,recipe:this.props.data.recipe,selected:this.props.data.beaconModule,onChange:this.handleSetBeaconModule})})]})})}},{key:"renderMachines",value:function(){return Object(h.jsx)("div",{className:"btn-toolbar mb-3",children:Object(h.jsxs)("div",{className:"input-group",onClick:this.handleInputGroupClick,children:[Object(h.jsx)(qe,{value:this.props.data.numMachines,onChange:this.handleNumMachinesChange,positiveOnly:!0}),Object(h.jsx)("div",{className:"input-group-append btn-icon-wrapper",children:Object(h.jsx)(Qe,{machines:this.props.data.recipe.madeIn,selected:this.props.data.machine,onChange:this.handleMachineChange})})]})})}},{key:"render",value:function(){var e=this,t=this.props.data.recipe,n=this.getOutput(),r=n.ingredients.map((function(e){return Object(h.jsx)("div",{className:"mb-1",children:Object(h.jsx)(He,{obj:e})},e.name)})),a=n.products.map((function(e){return Object(h.jsx)("div",{className:"mb-1",children:Object(h.jsx)(He,{obj:e})},e.name)}));return Object(h.jsx)(Ce.b,{draggableId:t.name,index:this.props.index,children:function(n){return Object(h.jsxs)("div",Object(V.a)(Object(V.a)({className:"".concat(tt.a.RecipeRow," recipe-row card mb-3"),ref:n.innerRef},n.draggableProps),{},{children:[Object(h.jsxs)("div",Object(V.a)(Object(V.a)({className:"card-header clearfix"},n.dragHandleProps),{},{children:[Object(h.jsx)("div",{className:"float-left",children:Object(h.jsx)(We,{obj:t,text:t.niceName,tooltip:function(){return Object(h.jsx)(ze,{recipe:t})}})}),Object(h.jsx)("div",{className:"float-right",children:Object(h.jsx)("button",{className:"btn btn-danger btn-sm",onClick:e.handleRemoveRow,children:"Remove"})})]})),Object(h.jsxs)("div",{className:"card-body clearfix",children:[Object(h.jsxs)("div",{className:"float-left",children:[e.renderMachines(),e.renderModules(),e.renderBeacons()]}),Object(h.jsxs)("div",{className:"float-right",children:[Object(h.jsxs)("div",{className:"mr-3",style:{display:"inline-block",float:"left",minWidth:"150px"},children:[Object(h.jsx)("b",{children:"Ingredients:"}),r]}),Object(h.jsxs)("div",{className:"mr-2",style:{display:"inline-block",minWidth:"150px"},children:[Object(h.jsx)("b",{children:"Products:"}),a]})]})]})]}))}})}}]),n}(a.a.PureComponent),rt=function(e){var t=e.index,n=e.data,r=e.onRemoveRow,a=e.onUpdateRow,i=Object(o.e)(g);return Object(h.jsx)(nt,{index:t,data:n,recipeTarget:i,onUpdateRow:a,onRemoveRow:r})},at=n(13),it=n(39),ot=n(32),ct=n.n(ot),st=function(e,t){if("string"===typeof t)throw new Error("path unexpectedly string: ".concat(t));if(1!==t.length)throw new Error("path unexpectedly long/short: ".concat(t));switch(t[0]){case"niceName":return e.niceName;case"name":return e.name;default:throw new Error("Unsupported path: ".concat(t))}},ut=/((?:produces)|(?:consumes)):([a-z0-9-]+)/g,lt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).inputRef=r.createRef(),e.state={query:"",matches:[]},e.handleIngredientClick=function(t){var n,r="produces:".concat(t.name);e.state.query.includes(r)||(e.setQuery("".concat(e.state.query," ").concat(r),(function(){e.calculateMatches()})),null===(n=e.inputRef.current)||void 0===n||n.scrollIntoView())},e.handleProductClick=function(t){var n,r="consumes:".concat(t.name);e.state.query.includes(r)||(e.setQuery("".concat(e.state.query," ").concat(r),(function(){e.calculateMatches()})),null===(n=e.inputRef.current)||void 0===n||n.scrollIntoView())},e.handleQueryInput=function(t){var n=t.target;e.setQuery(n.value)},e.handleRecipeClick=function(t){e.props.onPickRecipe(t),e.setQuery("")},e.setQuery=function(t,n){t.trim()?(e.setState({query:t},n),e.debCalculateMatches()):(e.debCalculateMatches.cancel(),e.setState({query:"",matches:[]},n))},e.debCalculateMatches=P(e.calculateMatches.bind(Object(at.a)(e)),200),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){Oe.addHandler(this.handleIngredientClick),ge.addHandler(this.handleProductClick)}},{key:"componentWillUnmount",value:function(){this.debCalculateMatches.cancel(),Oe.removeHandler(this.handleIngredientClick),ge.removeHandler(this.handleProductClick)}},{key:"calculateMatches",value:function(){var e=this.state.query.trim().toLowerCase();if(e){var t={consumes:[],produces:[]};e=e.replace(ut,(function(e,n,r){return t[n].push(r),""})).trim();var n=this.props.recipes;if((t.consumes.length||t.produces.length)&&(n=n.filter((function(e){var n,r=Object(N.a)(t.consumes);try{var a=function(){var t=n.value;if(!e.ingredients.some((function(e){return e.name===t})))return{v:!1}};for(r.s();!(n=r.n()).done;){var i=a();if("object"===typeof i)return i.v}}catch(l){r.e(l)}finally{r.f()}var o,c=Object(N.a)(t.produces);try{var s=function(){var t=o.value;if(!e.products.some((function(e){return e.name===t})))return{v:!1}};for(c.s();!(o=c.n()).done;){var u=s();if("object"===typeof u)return u.v}}catch(l){c.e(l)}finally{c.f()}return!0}))),e)n=new it.a(n,{shouldSort:!0,getFn:st,keys:[{name:"niceName",weight:.7},{name:"name",weight:.2}]}).search(e).map((function(e){return e.item}));this.setState({matches:n})}else this.setState({matches:[]})}},{key:"renderMatches",value:function(){var e=this;if(!this.state.matches.length)return"";var t=this.state.matches;return t.length>100&&(t=t.slice(0,100)),Object(h.jsxs)("table",{className:"table table-hover",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Recipe"}),Object(h.jsx)("th",{children:"Time"}),Object(h.jsx)("th",{children:"Ingredients"}),Object(h.jsx)("th",{children:"Products"})]})}),Object(h.jsx)("tbody",{children:t.map((function(t){return Object(h.jsx)(dt,{recipe:t,onClick:e.handleRecipeClick},t.name)}))})]})}},{key:"render",value:function(){return Object(h.jsxs)("div",{className:ke()(ct.a.RecipePicker,this.props.className),children:[Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"search",ref:this.inputRef,className:"editable-display form-control",placeholder:"What do you want to build?",value:this.state.query,onChange:this.handleQueryInput})}),this.renderMatches()]})}}]),n}(r.PureComponent),dt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleClickAdd=function(){e.props.onClick(e.props.recipe)},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props.recipe,t=e.ingredients.map((function(e){return Object(h.jsx)(We,{obj:e.item,tooltip:function(){return Object(h.jsx)(Ge,{obj:e})}},e.name)})),n=e.products.map((function(e){return Object(h.jsx)(We,{obj:e.item,tooltip:function(){return Object(h.jsx)(Ge,{obj:e})}},e.name)}));return Object(h.jsxs)("tr",{onClick:this.handleClickAdd,children:[Object(h.jsx)("td",{className:ct.a.ResultName,children:Object(h.jsx)(We,{obj:e,text:e.niceName,tooltip:function(){return Object(h.jsx)(ze,{recipe:e})}})}),Object(h.jsx)("td",{children:e.craftingTime.toDecimal()}),Object(h.jsx)("td",{children:t}),Object(h.jsx)("td",{children:n})]})}}]),n}(r.PureComponent),pt=n(40),ht=n.n(pt),mt=function(e){var t=e.rows,n=O(),a=Object(r.useMemo)((function(){var e=new Re(t);return n.sortByItem(e.ingredients,(function(e){return e.item})),n.sortByItem(e.products,(function(e){return e.item})),e}),[n,t]);return a.ingredients.length||a.products.length?Object(h.jsxs)("div",{className:"card ".concat(ht.a.TotalCard),children:[Object(h.jsx)("div",{className:"card-header",children:"Combined Totals"}),Object(h.jsx)("div",{className:"card-body",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col",children:["Ingredients:",a.ingredients.map((function(e){return Object(h.jsx)(He,{obj:e,showName:!0},e.name)}))]}),Object(h.jsxs)("div",{className:"col",children:["Products:",a.products.map((function(e){return Object(h.jsx)(He,{obj:e,showName:!0},e.name)}))]})]})})]}):Object(h.jsx)("div",{})},ft=n(41),bt=n.n(ft),jt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleDragEnd=function(t){t.destination&&t.source.index!==t.destination.index&&e.props.onMoveRow(t.source.index,t.destination.index)},e.renderRow=function(t,n){return Object(h.jsx)(rt,{index:n,data:t,onUpdateRow:e.props.onUpdateRow,onRemoveRow:e.props.onRemoveRow},t.recipe.name)},e.handleClickRename=function(){var t=prompt("Whatcha wanna call it now?",e.props.group.name);t&&e.props.onRenameGroup(t)},e.handleClickClone=function(){var t=prompt("Whatcha wanna call it now?","".concat(e.props.group.name," (Clone)"));t&&e.props.onCloneGroup(t)},e.handleClickDelete=function(){e.props.group.rows.length&&!window.confirm("Are you sure you want to delete ".concat(e.props.group.name))||e.props.onRemoveGroup()},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){ye.addHandler(this.props.onAddRow)}},{key:"componentDidUpdate",value:function(e,t){this.props.onAddRow!==e.onAddRow&&(ye.removeHandler(e.onAddRow),ye.addHandler(this.props.onAddRow))}},{key:"componentWillUnmount",value:function(){ye.removeHandler(this.props.onAddRow)}},{key:"renderHeader",value:function(){return Object(h.jsxs)("div",{className:"row align-items-end",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("h3",{className:"mb-0",children:["\ud83c\udfed ",this.props.group.name]})}),Object(h.jsx)("div",{className:"col text-right",children:Object(h.jsxs)("div",{className:"btn-group btn-group-sm",children:[Object(h.jsx)("button",{className:"btn btn-primary",onClick:this.handleClickRename,children:"Rename"}),Object(h.jsx)("button",{className:"btn btn-primary",onClick:this.handleClickClone,children:"Clone"}),Object(h.jsx)("button",{className:"btn btn-danger",onClick:this.handleClickDelete,children:"Delete"})]})})]})}},{key:"render",value:function(){var e=this,t=this.props.gameData.recipes.filter((function(t){return!e.props.group.rows.some((function(e){return e.recipe===t}))}));return Object(h.jsxs)("div",{className:bt.a.RecipeGroup,children:[this.renderHeader(),Object(h.jsx)("hr",{}),Object(h.jsx)(lt,{className:"mb-3",recipes:t,onPickRecipe:this.props.onAddRow}),Object(h.jsx)(Ce.a,{onDragEnd:this.handleDragEnd,children:Object(h.jsx)(Ce.c,{droppableId:"eyy",children:function(t){return Object(h.jsxs)("div",Object(V.a)(Object(V.a)({ref:t.innerRef},t.droppableProps),{},{children:[e.props.group.rows.map(e.renderRow),t.placeholder]}))}})}),Object(h.jsx)("hr",{}),Object(h.jsx)(mt,{rows:this.props.group.rows})]})}}]),n}(a.a.PureComponent),vt=function(e){var t=e.groupAtom,n=e.onRemoveGroup,a=Object(o.d)(t),i=Object(k.a)(a,2),c=i[0],s=i[1],u=Object(o.e)(w),l=O(),d=Se(),p=Object(r.useCallback)((function(e){s((function(t){return Object(V.a)(Object(V.a)({},t),{},{name:e})}))}),[s]),m=Object(r.useCallback)((function(e){d(Object(V.a)(Object(V.a)({},c),{},{name:e}))}),[d,c]),f=Object(r.useCallback)((function(){n(t)}),[n,t]),b=Object(r.useCallback)((function(e,t){var n=Array.from(c.rows),r=n.splice(e,1),a=Object(k.a)(r,1)[0];C(a,"Nothing at old index: ".concat(e)),n.splice(t,0,a),s((function(e){return Object(V.a)(Object(V.a)({},e),{},{rows:n})}))}),[c,s]),j=Object(r.useCallback)((function(e){s((function(t){return t.rows.find((function(t){return t.recipe.name===e.name}))?t:Object(V.a)(Object(V.a)({},t),{},{rows:[].concat(Object(Ne.a)(t.rows),[{recipe:e,machine:ae(e,u,l),numMachines:A.one,modules:[],beaconModule:null,numBeacons:0}])})}))}),[u,l,s]),v=Object(r.useCallback)((function(e){s((function(t){return Object(V.a)(Object(V.a)({},t),{},{rows:t.rows.map((function(t){return t.recipe===e.recipe?e:t}))})}))}),[s]),g=Object(r.useCallback)((function(e){s((function(t){return Object(V.a)(Object(V.a)({},t),{},{rows:t.rows.filter((function(t){return t.recipe!==e}))})}))}),[s]);return Object(h.jsx)(jt,{group:c,gameData:l,onRenameGroup:p,onCloneGroup:m,onRemoveGroup:f,onAddRow:j,onMoveRow:b,onUpdateRow:v,onRemoveRow:g})},Ot=n(14),gt=function(){var e=O(),t=Object(o.d)(w),n=Object(k.a)(t,2),a=n[0],i=n[1],c=Object(r.useCallback)((function(e,t){i((function(n){return Object(V.a)(Object(V.a)({},n),{},{assemblerOverrides:Object(V.a)(Object(V.a)({},n.assemblerOverrides),{},Object(Ot.a)({},e,t))})}))}),[i]),s=Object(r.useMemo)((function(){var t=Object.entries(e.categoryMap).filter((function(e){return e[1].length>1})).map((function(e){return e[0]}));return t.sort((function(e,t){return e.localeCompare(t)})),t}),[e]);return Object(h.jsx)("div",{className:"container",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col",children:[Object(h.jsx)("h3",{children:"Default Assemblers"}),s.map((function(t){return Object(h.jsx)(yt,{gameData:e,settings:a,category:t,onSetDefaultMachine:c},t)}))]}),Object(h.jsxs)("div",{className:"col",children:[Object(h.jsx)("h3",{children:"Active mods"}),Object(h.jsx)(wt,{gameData:e})]})]})})},yt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).handleChange=function(t){e.props.onSetDefaultMachine(e.props.category,t)},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props.gameData.categoryMap[this.props.category]||[],t=ae(this.props.category,this.props.settings,this.props.gameData);return Object(h.jsx)("div",{className:"btn-toolbar mb-3",children:Object(h.jsxs)("div",{className:"input-group",children:[Object(h.jsx)("div",{className:"input-group-prepend",children:Object(h.jsx)("span",{className:"input-group-text",children:this.props.category})}),Object(h.jsx)("div",{className:"input-group-append btn-icon-wrapper",children:Object(h.jsx)(Qe,{machines:e,selected:t,onChange:this.handleChange})})]})})}}]),n}(a.a.PureComponent),xt={base:'Data for the base "factorio" game',"factorio-data-dumper":"A fake mod that exports data about other installed mods."},wt=function(e){for(var t=e.gameData,n=[],r=0,a=Object.entries(t.activeMods);r<a.length;r++){var i=Object(k.a)(a[r],2),o=i[0],c=i[1],s="https://mods.factorio.com/mod/"+o,u=void 0;u=void 0!==xt[o]?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("b",{children:o}),Object(h.jsx)("span",{title:xt[o],children:" \ud83d\udec8"})]}):Object(h.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:Object(h.jsx)("b",{children:o})}),n.push(Object(h.jsxs)("li",{children:[u," \u2013 version ",c]},o))}return Object(h.jsx)("ul",{children:n})},kt=n(42),Nt=n.n(kt),Ct=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).handleKeyDown=function(e){"Shift"===e.key&&document.body.classList.add("shift-down")},r.handleKeyUp=function(e){"Shift"===e.key&&document.body.classList.remove("shift-down")},r.handleClickGroup=function(e){r.setState({activePage:e})},r.handleClickAddGroup=function(e){e.preventDefault();var t="Factory ".concat(r.props.groups.length+1),n=prompt("What do you want to name this group?",t);if(n&&n.trim()){var a=r.props.onAddGroup({name:n,rows:[]});r.setState({activePage:a})}},r.handleRemoveGroupAtom=function(e){if(r.state.activePage===e){var t,n=!1,a=Object(N.a)(r.props.groups);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i[1]!==e){r.setState({activePage:i[1]}),n=!0;break}}}catch(o){a.e(o)}finally{a.f()}n||r.setState({activePage:"settings"})}r.props.onRemoveGroupAtom(e)},r.handleClickSettings=function(){r.setState({activePage:"settings"})};var a,i="settings",o=Object(N.a)(r.props.groups);try{for(o.s();!(a=o.n()).done;){i=a.value[1];break}}catch(s){o.e(s)}finally{o.f()}return r.state={activePage:i},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}},{key:"renderNavbar",value:function(){var e=this,t="settings"===this.state.activePage,n=this.props.groups.map((function(t,n){var r=Object(k.a)(t,2),a=r[0],i=r[1],o=e.state.activePage===i;return Object(h.jsx)("button",{type:"button",className:"list-group-item list-group-item-action ".concat(o?"active":""),onClick:function(){return e.handleClickGroup(i)},children:a.name},n)}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("ul",{className:"list-group mt-3",children:[Object(h.jsxs)("li",{className:"list-group-item",children:[Object(h.jsx)("span",{role:"img","aria-label":"Factory icon",children:"\ud83c\udfed"})," ","Factories"]}),n,Object(h.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action",onClick:this.handleClickAddGroup,children:[Object(h.jsx)("span",{role:"img","aria-label":"Factory icon",children:"\uff0b"})," ","Add a Factory"]})]}),Object(h.jsx)("ul",{className:"list-group mt-3",children:Object(h.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action ".concat(t?"active":""),onClick:this.handleClickSettings,children:[Object(h.jsx)("span",{role:"img","aria-label":"Gear icon",children:"\u2699\ufe0f"})," ","Settings"]})})]})}},{key:"renderBody",value:function(){return"settings"===this.state.activePage?Object(h.jsx)(gt,{}):this.state.activePage?Object(h.jsx)(vt,{groupAtom:this.state.activePage,onRemoveGroup:this.handleRemoveGroupAtom}):function(e){throw new Error("Unexpected object: "+e)}(this.state.activePage)}},{key:"render",value:function(){return C(this.props.gameData,"falsy gameData, should never happen"),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"container-fluid",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:ke()("col col-2 bg-primary",Nt.a.Sidebar),children:this.renderNavbar()}),Object(h.jsx)("div",{className:"col pt-3",children:this.renderBody()})]})})})}}]),n}(a.a.PureComponent),Mt=function(e){var t=e.gameData,n=Object(o.e)(x),a=Object(o.f)(y),i=Se(),c=Object(r.useCallback)((function(e){a((function(t){return t.filter((function(t){return t!==e}))}))}),[a]);return Object(h.jsx)(Ct,{gameData:t,groups:n,onAddGroup:i,onRemoveGroupAtom:c})},St=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={loaded:!1},e._mounted=!1,e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._mounted=!0,this.load().then((function(){e._mounted&&e.setState({loaded:!0})}),(function(t){e._mounted&&e.setState((function(){throw t}))}))}},{key:"componentWillUnmount",value:function(){this._mounted=!1}},{key:"getPreviousState",value:function(){var e=null;try{e=function(e){var t=me.exec(document.location.hash);if(!t)return null;var n=Number(t[1]||1),r=decodeURIComponent(t[2]);return n>2&&(r=Object(ie.b)(le(r),{to:"string"})),be(e,{version:n,data:JSON.parse(r)})}(this.props.gameData)}catch(n){!function(e){var t=e;e instanceof Error&&e.stack&&(t=e.stack),xe.dispatch({title:"Error!",when:new Date,body:t})}(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("b",{children:"Error loading from URL"}),Object(h.jsx)("br",{}),Object(h.jsx)("pre",{children:String(n)})]})),console.error("error loading from url",n)}if(e)return e;try{var t=function(e){var t=localStorage.getItem(pe);if(!t){if(!(t=localStorage.getItem("appstate")))return null;localStorage.setItem(pe,t),localStorage.removeItem("appstate")}var n=JSON.parse(t);return 1===n.version&&(n.version=3),be(e,n)}(this.props.gameData);if(t)return t}catch(n){console.error("Failed to load local storage state",n)}}},{key:"load",value:function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.getPreviousState())&&this.props.onSetPreviousState(t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.state.loaded)return Object(h.jsx)("h1",{children:"Loading..."});var e="".concat("/tscalc","/assets/sprite-sheet-").concat(this.props.gameData.spriteHash,".png"),t="\n        .game-icon {\n            background-image: url(".concat(e,");\n        }\n        ");return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Rt,{gameData:this.props.gameData}),Object(h.jsx)(It,{href:e}),Object(h.jsx)("style",{children:t}),Object(h.jsx)(Mt,{gameData:this.props.gameData})]})}}]),n}(a.a.PureComponent),Rt=function(e){var t=e.gameData,n=Object(o.e)(x),a=Object(o.e)(w),i=Object(r.useRef)(!0);return Object(r.useEffect)((function(){if(i.current)i.current=!1;else{var e={groups:n.map((function(e){return e[0]})),settings:a};!function(e,t){var n=he(e,t),r=n.version,a=JSON.stringify(n.data);a=ue(Object(ie.a)(a)),window.history.replaceState("","","#".concat(r,"-").concat(a))}(e,t),function(e,t){localStorage.setItem(pe,JSON.stringify(he(e,t)))}(e,t)}}),[t,n,a]),null},It=function(e){return i.createPortal(Object(h.jsx)("link",{rel:"prefetch",href:e.href}),document.head)},_t=function(e){var t=e.gameData,n=Object(o.f)(y),a=Object(o.f)(w),i=Object(r.useCallback)((function(e){var t=0;n(e.groups.map((function(e){return Object(o.b)({key:"group-".concat(Date.now(),"-").concat(t++),default:e})}))),a(e.settings)}),[n,a]);return Object(h.jsx)(St,{gameData:t,onSetPreviousState:i})},Pt=[void 0,void 0,"pending"];function Tt(e){return Dt.apply(this,arguments)}function Dt(){return(Dt=Object(j.a)(b.a.mark((function e(t){var n,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("/tscalc","/assets/").concat(t,".json"));case 2:if(200===(n=e.sent).status){e.next=5;break}throw new Error("Could not load game data, got HTTP status ".concat(n.status));case 5:return e.prev=5,e.next=8,n.json();case 8:r=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),new Error("Could not parse game data: ".concat(e.t0));case 14:return a=new re(r),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}var Et=function(e){var t=e.child,n=Object(o.d)(v)[1],a=function(e,t){var n=Object(r.useState)(Pt),a=Object(k.a)(n,2),i=a[0],o=a[1];return Object(r.useEffect)((function(){var t=!1,n=e();return o(Pt),n.then((function(e){t||o([e,void 0,"resolved"])}),(function(e){t||o([void 0,e,"rejected"])})),function(){t=!0}}),t),i}(Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt("space-ex");case 2:return t=e.sent,n(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),[]),i=Object(k.a)(a,3),c=i[0],s=i[1],u=i[2];if("pending"===u)return Object(h.jsx)("h3",{children:"Loading game data..."});if("rejected"===u)return Object(h.jsxs)("div",{children:[Object(h.jsx)("h3",{children:"Error loading game data!"}),Object(h.jsx)("pre",{children:String(s)})]});if(c)return t(c);throw new Error("Somehow missing gamedata")},qt=function(e){var t=e.title,n=e.when,a=e.onClose,i=e.children;Object(r.useEffect)((function(){var e=setTimeout((function(){a()}),5e3);return function(){clearTimeout(e)}}),[t,n,a,i]);var o=T(n);return Object(h.jsxs)("div",{className:"toast fade show",role:"alert","aria-live":"assertive","aria-atomic":"true",children:[Object(h.jsxs)("div",{className:"toast-header",children:[Object(h.jsx)("strong",{className:"mr-auto",children:t}),Object(h.jsx)("small",{children:o}),Object(h.jsx)("button",{type:"button",className:"ml-2 mb-1 close","data-dismiss":"toast","aria-label":"Close",onClick:a,children:Object(h.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(h.jsx)("div",{className:"toast-body",children:i})]})},At=n(43),Ft=n.n(At),Bt=0,Ut=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={toasts:[]},e.handleNotification=function(t){var n=Object(at.a)(e),r=Object(V.a)(Object(V.a)({},t),{},{key:Bt++,handleClose:function(){n.setState((function(e){return Object(V.a)(Object(V.a)({},e),{},{toasts:e.toasts.filter((function(e){return e.key!==r.key}))})}))}});e.setState((function(e){return Object(V.a)(Object(V.a)({},e),{},{toasts:[].concat(Object(Ne.a)(e.toasts),[r])})}))},e.renderToast=function(e){return Object(h.jsx)(qt,{title:e.title,when:e.when,onClose:e.handleClose,children:e.body},e.key)},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){xe.addHandler(this.handleNotification)}},{key:"componentWillUnmount",value:function(){xe.removeHandler(this.handleNotification)}},{key:"render",value:function(){return Object(h.jsx)("div",{"aria-live":"polite","aria-atomic":"true",className:Ft.a.ToastPortal,children:this.state.toasts.map(this.renderToast)})}}]),n}(a.a.Component);n(58);i.render(Object(h.jsx)(m,{children:Object(h.jsxs)(o.a,{children:[Object(h.jsx)(Et,{child:function(e){return Object(h.jsx)(_t,{gameData:e})}}),Object(h.jsx)(Ut,{})]})}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.7efdcdd8.chunk.js.map